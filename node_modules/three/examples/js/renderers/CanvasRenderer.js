'use strict';

/**
 * @author mrdoob / http://mrdoob.com/
 */

THREE.SpriteCanvasMaterial = function (parameters) {

		THREE.Material.call(this);

		this.type = 'SpriteCanvasMaterial';

		this.color = new THREE.Color(0xffffff);
		this.program = function (context, color) {};

		this.setValues(parameters);
};

THREE.SpriteCanvasMaterial.prototype = Object.create(THREE.Material.prototype);
THREE.SpriteCanvasMaterial.prototype.constructor = THREE.SpriteCanvasMaterial;

THREE.SpriteCanvasMaterial.prototype.clone = function () {

		var material = new THREE.SpriteCanvasMaterial();

		material.copy(this);
		material.color.copy(this.color);
		material.program = this.program;

		return material;
};

//

THREE.CanvasRenderer = function (parameters) {

		console.log('THREE.CanvasRenderer', THREE.REVISION);

		parameters = parameters || {};

		var _this = this,
		    _renderData,
		    _elements,
		    _lights,
		    _projector = new THREE.Projector(),
		    _canvas = parameters.canvas !== undefined ? parameters.canvas : document.createElement('canvas'),
		    _canvasWidth = _canvas.width,
		    _canvasHeight = _canvas.height,
		    _canvasWidthHalf = Math.floor(_canvasWidth / 2),
		    _canvasHeightHalf = Math.floor(_canvasHeight / 2),
		    _viewportX = 0,
		    _viewportY = 0,
		    _viewportWidth = _canvasWidth,
		    _viewportHeight = _canvasHeight,
		    _pixelRatio = 1,
		    _context = _canvas.getContext('2d', {
				alpha: parameters.alpha === true
		}),
		    _clearColor = new THREE.Color(0x000000),
		    _clearAlpha = parameters.alpha === true ? 0 : 1,
		    _contextGlobalAlpha = 1,
		    _contextGlobalCompositeOperation = 0,
		    _contextStrokeStyle = null,
		    _contextFillStyle = null,
		    _contextLineWidth = null,
		    _contextLineCap = null,
		    _contextLineJoin = null,
		    _contextLineDash = [],
		    _camera,
		    _v1,
		    _v2,
		    _v3,
		    _v4,
		    _v5 = new THREE.RenderableVertex(),
		    _v6 = new THREE.RenderableVertex(),
		    _v1x,
		    _v1y,
		    _v2x,
		    _v2y,
		    _v3x,
		    _v3y,
		    _v4x,
		    _v4y,
		    _v5x,
		    _v5y,
		    _v6x,
		    _v6y,
		    _color = new THREE.Color(),
		    _color1 = new THREE.Color(),
		    _color2 = new THREE.Color(),
		    _color3 = new THREE.Color(),
		    _color4 = new THREE.Color(),
		    _diffuseColor = new THREE.Color(),
		    _emissiveColor = new THREE.Color(),
		    _lightColor = new THREE.Color(),
		    _patterns = {},
		    _image,
		    _uvs,
		    _uv1x,
		    _uv1y,
		    _uv2x,
		    _uv2y,
		    _uv3x,
		    _uv3y,
		    _clipBox = new THREE.Box2(),
		    _clearBox = new THREE.Box2(),
		    _elemBox = new THREE.Box2(),
		    _ambientLight = new THREE.Color(),
		    _directionalLights = new THREE.Color(),
		    _pointLights = new THREE.Color(),
		    _vector3 = new THREE.Vector3(),
		    // Needed for PointLight
		_centroid = new THREE.Vector3(),
		    _normal = new THREE.Vector3(),
		    _normalViewMatrix = new THREE.Matrix3();

		/* TODO
  _canvas.mozImageSmoothingEnabled = false;
  _canvas.webkitImageSmoothingEnabled = false;
  _canvas.msImageSmoothingEnabled = false;
  _canvas.imageSmoothingEnabled = false;
  */

		// dash+gap fallbacks for Firefox and everything else

		if (_context.setLineDash === undefined) {

				_context.setLineDash = function () {};
		}

		this.domElement = _canvas;

		this.autoClear = true;
		this.sortObjects = true;
		this.sortElements = true;

		this.info = {

				render: {

						vertices: 0,
						faces: 0

				}

		};

		// WebGLRenderer compatibility

		this.supportsVertexTextures = function () {};
		this.setFaceCulling = function () {};

		// API

		this.getContext = function () {

				return _context;
		};

		this.getContextAttributes = function () {

				return _context.getContextAttributes();
		};

		this.getPixelRatio = function () {

				return _pixelRatio;
		};

		this.setPixelRatio = function (value) {

				if (value !== undefined) _pixelRatio = value;
		};

		this.setSize = function (width, height, updateStyle) {

				_canvasWidth = width * _pixelRatio;
				_canvasHeight = height * _pixelRatio;

				_canvas.width = _canvasWidth;
				_canvas.height = _canvasHeight;

				_canvasWidthHalf = Math.floor(_canvasWidth / 2);
				_canvasHeightHalf = Math.floor(_canvasHeight / 2);

				if (updateStyle !== false) {

						_canvas.style.width = width + 'px';
						_canvas.style.height = height + 'px';
				}

				_clipBox.min.set(-_canvasWidthHalf, -_canvasHeightHalf);
				_clipBox.max.set(_canvasWidthHalf, _canvasHeightHalf);

				_clearBox.min.set(-_canvasWidthHalf, -_canvasHeightHalf);
				_clearBox.max.set(_canvasWidthHalf, _canvasHeightHalf);

				_contextGlobalAlpha = 1;
				_contextGlobalCompositeOperation = 0;
				_contextStrokeStyle = null;
				_contextFillStyle = null;
				_contextLineWidth = null;
				_contextLineCap = null;
				_contextLineJoin = null;

				this.setViewport(0, 0, width, height);
		};

		this.setViewport = function (x, y, width, height) {

				_viewportX = x * _pixelRatio;
				_viewportY = y * _pixelRatio;

				_viewportWidth = width * _pixelRatio;
				_viewportHeight = height * _pixelRatio;
		};

		this.setScissor = function () {};
		this.setScissorTest = function () {};

		this.setClearColor = function (color, alpha) {

				_clearColor.set(color);
				_clearAlpha = alpha !== undefined ? alpha : 1;

				_clearBox.min.set(-_canvasWidthHalf, -_canvasHeightHalf);
				_clearBox.max.set(_canvasWidthHalf, _canvasHeightHalf);
		};

		this.setClearColorHex = function (hex, alpha) {

				console.warn('THREE.CanvasRenderer: .setClearColorHex() is being removed. Use .setClearColor() instead.');
				this.setClearColor(hex, alpha);
		};

		this.getClearColor = function () {

				return _clearColor;
		};

		this.getClearAlpha = function () {

				return _clearAlpha;
		};

		this.getMaxAnisotropy = function () {

				return 0;
		};

		this.clear = function () {

				if (_clearBox.isEmpty() === false) {

						_clearBox.intersect(_clipBox);
						_clearBox.expandByScalar(2);

						_clearBox.min.x = _clearBox.min.x + _canvasWidthHalf;
						_clearBox.min.y = -_clearBox.min.y + _canvasHeightHalf; // higher y value !
						_clearBox.max.x = _clearBox.max.x + _canvasWidthHalf;
						_clearBox.max.y = -_clearBox.max.y + _canvasHeightHalf; // lower y value !

						if (_clearAlpha < 1) {

								_context.clearRect(_clearBox.min.x | 0, _clearBox.max.y | 0, _clearBox.max.x - _clearBox.min.x | 0, _clearBox.min.y - _clearBox.max.y | 0);
						}

						if (_clearAlpha > 0) {

								setBlending(THREE.NormalBlending);
								setOpacity(1);

								setFillStyle('rgba(' + Math.floor(_clearColor.r * 255) + ',' + Math.floor(_clearColor.g * 255) + ',' + Math.floor(_clearColor.b * 255) + ',' + _clearAlpha + ')');

								_context.fillRect(_clearBox.min.x | 0, _clearBox.max.y | 0, _clearBox.max.x - _clearBox.min.x | 0, _clearBox.min.y - _clearBox.max.y | 0);
						}

						_clearBox.makeEmpty();
				}
		};

		// compatibility

		this.clearColor = function () {};
		this.clearDepth = function () {};
		this.clearStencil = function () {};

		this.render = function (scene, camera) {

				if (camera instanceof THREE.Camera === false) {

						console.error('THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.');
						return;
				}

				if (this.autoClear === true) this.clear();

				_this.info.render.vertices = 0;
				_this.info.render.faces = 0;

				_context.setTransform(_viewportWidth / _canvasWidth, 0, 0, -_viewportHeight / _canvasHeight, _viewportX, _canvasHeight - _viewportY);
				_context.translate(_canvasWidthHalf, _canvasHeightHalf);

				_renderData = _projector.projectScene(scene, camera, this.sortObjects, this.sortElements);
				_elements = _renderData.elements;
				_lights = _renderData.lights;
				_camera = camera;

				_normalViewMatrix.getNormalMatrix(camera.matrixWorldInverse);

				/* DEBUG
    setFillStyle( 'rgba( 0, 255, 255, 0.5 )' );
    _context.fillRect( _clipBox.min.x, _clipBox.min.y, _clipBox.max.x - _clipBox.min.x, _clipBox.max.y - _clipBox.min.y );
    */

				calculateLights();

				for (var e = 0, el = _elements.length; e < el; e++) {

						var element = _elements[e];

						var material = element.material;

						if (material === undefined || material.opacity === 0) continue;

						_elemBox.makeEmpty();

						if (element instanceof THREE.RenderableSprite) {

								_v1 = element;
								_v1.x *= _canvasWidthHalf;_v1.y *= _canvasHeightHalf;

								renderSprite(_v1, element, material);
						} else if (element instanceof THREE.RenderableLine) {

								_v1 = element.v1;_v2 = element.v2;

								_v1.positionScreen.x *= _canvasWidthHalf;_v1.positionScreen.y *= _canvasHeightHalf;
								_v2.positionScreen.x *= _canvasWidthHalf;_v2.positionScreen.y *= _canvasHeightHalf;

								_elemBox.setFromPoints([_v1.positionScreen, _v2.positionScreen]);

								if (_clipBox.intersectsBox(_elemBox) === true) {

										renderLine(_v1, _v2, element, material);
								}
						} else if (element instanceof THREE.RenderableFace) {

								_v1 = element.v1;_v2 = element.v2;_v3 = element.v3;

								if (_v1.positionScreen.z < -1 || _v1.positionScreen.z > 1) continue;
								if (_v2.positionScreen.z < -1 || _v2.positionScreen.z > 1) continue;
								if (_v3.positionScreen.z < -1 || _v3.positionScreen.z > 1) continue;

								_v1.positionScreen.x *= _canvasWidthHalf;_v1.positionScreen.y *= _canvasHeightHalf;
								_v2.positionScreen.x *= _canvasWidthHalf;_v2.positionScreen.y *= _canvasHeightHalf;
								_v3.positionScreen.x *= _canvasWidthHalf;_v3.positionScreen.y *= _canvasHeightHalf;

								if (material.overdraw > 0) {

										expand(_v1.positionScreen, _v2.positionScreen, material.overdraw);
										expand(_v2.positionScreen, _v3.positionScreen, material.overdraw);
										expand(_v3.positionScreen, _v1.positionScreen, material.overdraw);
								}

								_elemBox.setFromPoints([_v1.positionScreen, _v2.positionScreen, _v3.positionScreen]);

								if (_clipBox.intersectsBox(_elemBox) === true) {

										renderFace3(_v1, _v2, _v3, 0, 1, 2, element, material);
								}
						}

						/* DEBUG
      setLineWidth( 1 );
      setStrokeStyle( 'rgba( 0, 255, 0, 0.5 )' );
      _context.strokeRect( _elemBox.min.x, _elemBox.min.y, _elemBox.max.x - _elemBox.min.x, _elemBox.max.y - _elemBox.min.y );
      */

						_clearBox.union(_elemBox);
				}

				/* DEBUG
    setLineWidth( 1 );
    setStrokeStyle( 'rgba( 255, 0, 0, 0.5 )' );
    _context.strokeRect( _clearBox.min.x, _clearBox.min.y, _clearBox.max.x - _clearBox.min.x, _clearBox.max.y - _clearBox.min.y );
    */

				_context.setTransform(1, 0, 0, 1, 0, 0);
		};

		//

		function calculateLights() {

				_ambientLight.setRGB(0, 0, 0);
				_directionalLights.setRGB(0, 0, 0);
				_pointLights.setRGB(0, 0, 0);

				for (var l = 0, ll = _lights.length; l < ll; l++) {

						var light = _lights[l];
						var lightColor = light.color;

						if (light instanceof THREE.AmbientLight) {

								_ambientLight.add(lightColor);
						} else if (light instanceof THREE.DirectionalLight) {

								// for sprites

								_directionalLights.add(lightColor);
						} else if (light instanceof THREE.PointLight) {

								// for sprites

								_pointLights.add(lightColor);
						}
				}
		}

		function calculateLight(position, normal, color) {

				for (var l = 0, ll = _lights.length; l < ll; l++) {

						var light = _lights[l];

						_lightColor.copy(light.color);

						if (light instanceof THREE.DirectionalLight) {

								var lightPosition = _vector3.setFromMatrixPosition(light.matrixWorld).normalize();

								var amount = normal.dot(lightPosition);

								if (amount <= 0) continue;

								amount *= light.intensity;

								color.add(_lightColor.multiplyScalar(amount));
						} else if (light instanceof THREE.PointLight) {

								var lightPosition = _vector3.setFromMatrixPosition(light.matrixWorld);

								var amount = normal.dot(_vector3.subVectors(lightPosition, position).normalize());

								if (amount <= 0) continue;

								amount *= light.distance == 0 ? 1 : 1 - Math.min(position.distanceTo(lightPosition) / light.distance, 1);

								if (amount == 0) continue;

								amount *= light.intensity;

								color.add(_lightColor.multiplyScalar(amount));
						}
				}
		}

		function renderSprite(v1, element, material) {

				setOpacity(material.opacity);
				setBlending(material.blending);

				var scaleX = element.scale.x * _canvasWidthHalf;
				var scaleY = element.scale.y * _canvasHeightHalf;

				var dist = 0.5 * Math.sqrt(scaleX * scaleX + scaleY * scaleY); // allow for rotated sprite
				_elemBox.min.set(v1.x - dist, v1.y - dist);
				_elemBox.max.set(v1.x + dist, v1.y + dist);

				if (material instanceof THREE.SpriteMaterial) {

						var texture = material.map;

						if (texture !== null) {

								var pattern = _patterns[texture.id];

								if (pattern === undefined || pattern.version !== texture.version) {

										pattern = textureToPattern(texture);
										_patterns[texture.id] = pattern;
								}

								if (pattern.canvas !== undefined) {

										setFillStyle(pattern.canvas);

										var bitmap = texture.image;

										var ox = bitmap.width * texture.offset.x;
										var oy = bitmap.height * texture.offset.y;

										var sx = bitmap.width * texture.repeat.x;
										var sy = bitmap.height * texture.repeat.y;

										var cx = scaleX / sx;
										var cy = scaleY / sy;

										_context.save();
										_context.translate(v1.x, v1.y);
										if (material.rotation !== 0) _context.rotate(material.rotation);
										_context.translate(-scaleX / 2, -scaleY / 2);
										_context.scale(cx, cy);
										_context.translate(-ox, -oy);
										_context.fillRect(ox, oy, sx, sy);
										_context.restore();
								}
						} else {

								// no texture

								setFillStyle(material.color.getStyle());

								_context.save();
								_context.translate(v1.x, v1.y);
								if (material.rotation !== 0) _context.rotate(material.rotation);
								_context.scale(scaleX, -scaleY);
								_context.fillRect(-0.5, -0.5, 1, 1);
								_context.restore();
						}
				} else if (material instanceof THREE.SpriteCanvasMaterial) {

						setStrokeStyle(material.color.getStyle());
						setFillStyle(material.color.getStyle());

						_context.save();
						_context.translate(v1.x, v1.y);
						if (material.rotation !== 0) _context.rotate(material.rotation);
						_context.scale(scaleX, scaleY);

						material.program(_context);

						_context.restore();
				}

				/* DEBUG
    setStrokeStyle( 'rgb(255,255,0)' );
    _context.beginPath();
    _context.moveTo( v1.x - 10, v1.y );
    _context.lineTo( v1.x + 10, v1.y );
    _context.moveTo( v1.x, v1.y - 10 );
    _context.lineTo( v1.x, v1.y + 10 );
    _context.stroke();
    */
		}

		function renderLine(v1, v2, element, material) {

				setOpacity(material.opacity);
				setBlending(material.blending);

				_context.beginPath();
				_context.moveTo(v1.positionScreen.x, v1.positionScreen.y);
				_context.lineTo(v2.positionScreen.x, v2.positionScreen.y);

				if (material instanceof THREE.LineBasicMaterial) {

						setLineWidth(material.linewidth);
						setLineCap(material.linecap);
						setLineJoin(material.linejoin);

						if (material.vertexColors !== THREE.VertexColors) {

								setStrokeStyle(material.color.getStyle());
						} else {

								var colorStyle1 = element.vertexColors[0].getStyle();
								var colorStyle2 = element.vertexColors[1].getStyle();

								if (colorStyle1 === colorStyle2) {

										setStrokeStyle(colorStyle1);
								} else {

										try {

												var grad = _context.createLinearGradient(v1.positionScreen.x, v1.positionScreen.y, v2.positionScreen.x, v2.positionScreen.y);
												grad.addColorStop(0, colorStyle1);
												grad.addColorStop(1, colorStyle2);
										} catch (exception) {

												grad = colorStyle1;
										}

										setStrokeStyle(grad);
								}
						}

						_context.stroke();
						_elemBox.expandByScalar(material.linewidth * 2);
				} else if (material instanceof THREE.LineDashedMaterial) {

						setLineWidth(material.linewidth);
						setLineCap(material.linecap);
						setLineJoin(material.linejoin);
						setStrokeStyle(material.color.getStyle());
						setLineDash([material.dashSize, material.gapSize]);

						_context.stroke();

						_elemBox.expandByScalar(material.linewidth * 2);

						setLineDash([]);
				}
		}

		function renderFace3(v1, v2, v3, uv1, uv2, uv3, element, material) {

				_this.info.render.vertices += 3;
				_this.info.render.faces++;

				setOpacity(material.opacity);
				setBlending(material.blending);

				_v1x = v1.positionScreen.x;_v1y = v1.positionScreen.y;
				_v2x = v2.positionScreen.x;_v2y = v2.positionScreen.y;
				_v3x = v3.positionScreen.x;_v3y = v3.positionScreen.y;

				drawTriangle(_v1x, _v1y, _v2x, _v2y, _v3x, _v3y);

				if ((material instanceof THREE.MeshLambertMaterial || material instanceof THREE.MeshPhongMaterial) && material.map === null) {

						_diffuseColor.copy(material.color);
						_emissiveColor.copy(material.emissive);

						if (material.vertexColors === THREE.FaceColors) {

								_diffuseColor.multiply(element.color);
						}

						_color.copy(_ambientLight);

						_centroid.copy(v1.positionWorld).add(v2.positionWorld).add(v3.positionWorld).divideScalar(3);

						calculateLight(_centroid, element.normalModel, _color);

						_color.multiply(_diffuseColor).add(_emissiveColor);

						material.wireframe === true ? strokePath(_color, material.wireframeLinewidth, material.wireframeLinecap, material.wireframeLinejoin) : fillPath(_color);
				} else if (material instanceof THREE.MeshBasicMaterial || material instanceof THREE.MeshLambertMaterial || material instanceof THREE.MeshPhongMaterial) {

						if (material.map !== null) {

								var mapping = material.map.mapping;

								if (mapping === THREE.UVMapping) {

										_uvs = element.uvs;
										patternPath(_v1x, _v1y, _v2x, _v2y, _v3x, _v3y, _uvs[uv1].x, _uvs[uv1].y, _uvs[uv2].x, _uvs[uv2].y, _uvs[uv3].x, _uvs[uv3].y, material.map);
								}
						} else if (material.envMap !== null) {

								if (material.envMap.mapping === THREE.SphericalReflectionMapping) {

										_normal.copy(element.vertexNormalsModel[uv1]).applyMatrix3(_normalViewMatrix);
										_uv1x = 0.5 * _normal.x + 0.5;
										_uv1y = 0.5 * _normal.y + 0.5;

										_normal.copy(element.vertexNormalsModel[uv2]).applyMatrix3(_normalViewMatrix);
										_uv2x = 0.5 * _normal.x + 0.5;
										_uv2y = 0.5 * _normal.y + 0.5;

										_normal.copy(element.vertexNormalsModel[uv3]).applyMatrix3(_normalViewMatrix);
										_uv3x = 0.5 * _normal.x + 0.5;
										_uv3y = 0.5 * _normal.y + 0.5;

										patternPath(_v1x, _v1y, _v2x, _v2y, _v3x, _v3y, _uv1x, _uv1y, _uv2x, _uv2y, _uv3x, _uv3y, material.envMap);
								}
						} else {

								_color.copy(material.color);

								if (material.vertexColors === THREE.FaceColors) {

										_color.multiply(element.color);
								}

								material.wireframe === true ? strokePath(_color, material.wireframeLinewidth, material.wireframeLinecap, material.wireframeLinejoin) : fillPath(_color);
						}
				} else if (material instanceof THREE.MeshNormalMaterial) {

						_normal.copy(element.normalModel).applyMatrix3(_normalViewMatrix);

						_color.setRGB(_normal.x, _normal.y, _normal.z).multiplyScalar(0.5).addScalar(0.5);

						material.wireframe === true ? strokePath(_color, material.wireframeLinewidth, material.wireframeLinecap, material.wireframeLinejoin) : fillPath(_color);
				} else {

						_color.setRGB(1, 1, 1);

						material.wireframe === true ? strokePath(_color, material.wireframeLinewidth, material.wireframeLinecap, material.wireframeLinejoin) : fillPath(_color);
				}
		}

		//

		function drawTriangle(x0, y0, x1, y1, x2, y2) {

				_context.beginPath();
				_context.moveTo(x0, y0);
				_context.lineTo(x1, y1);
				_context.lineTo(x2, y2);
				_context.closePath();
		}

		function strokePath(color, linewidth, linecap, linejoin) {

				setLineWidth(linewidth);
				setLineCap(linecap);
				setLineJoin(linejoin);
				setStrokeStyle(color.getStyle());

				_context.stroke();

				_elemBox.expandByScalar(linewidth * 2);
		}

		function fillPath(color) {

				setFillStyle(color.getStyle());
				_context.fill();
		}

		function textureToPattern(texture) {

				if (texture.version === 0 || texture instanceof THREE.CompressedTexture || texture instanceof THREE.DataTexture) {

						return {
								canvas: undefined,
								version: texture.version
						};
				}

				var image = texture.image;

				if (image.complete === false) {

						return {
								canvas: undefined,
								version: 0
						};
				}

				var canvas = document.createElement('canvas');
				canvas.width = image.width;
				canvas.height = image.height;

				var context = canvas.getContext('2d');
				context.setTransform(1, 0, 0, -1, 0, image.height);
				context.drawImage(image, 0, 0);

				var repeatX = texture.wrapS === THREE.RepeatWrapping;
				var repeatY = texture.wrapT === THREE.RepeatWrapping;

				var repeat = 'no-repeat';

				if (repeatX === true && repeatY === true) {

						repeat = 'repeat';
				} else if (repeatX === true) {

						repeat = 'repeat-x';
				} else if (repeatY === true) {

						repeat = 'repeat-y';
				}

				var pattern = _context.createPattern(canvas, repeat);

				if (texture.onUpdate) texture.onUpdate(texture);

				return {
						canvas: pattern,
						version: texture.version
				};
		}

		function patternPath(x0, y0, x1, y1, x2, y2, u0, v0, u1, v1, u2, v2, texture) {

				var pattern = _patterns[texture.id];

				if (pattern === undefined || pattern.version !== texture.version) {

						pattern = textureToPattern(texture);
						_patterns[texture.id] = pattern;
				}

				if (pattern.canvas !== undefined) {

						setFillStyle(pattern.canvas);
				} else {

						setFillStyle('rgba( 0, 0, 0, 1)');
						_context.fill();
						return;
				}

				// http://extremelysatisfactorytotalitarianism.com/blog/?p=2120

				var a,
				    b,
				    c,
				    d,
				    e,
				    f,
				    det,
				    idet,
				    offsetX = texture.offset.x / texture.repeat.x,
				    offsetY = texture.offset.y / texture.repeat.y,
				    width = texture.image.width * texture.repeat.x,
				    height = texture.image.height * texture.repeat.y;

				u0 = (u0 + offsetX) * width;
				v0 = (v0 + offsetY) * height;

				u1 = (u1 + offsetX) * width;
				v1 = (v1 + offsetY) * height;

				u2 = (u2 + offsetX) * width;
				v2 = (v2 + offsetY) * height;

				x1 -= x0;y1 -= y0;
				x2 -= x0;y2 -= y0;

				u1 -= u0;v1 -= v0;
				u2 -= u0;v2 -= v0;

				det = u1 * v2 - u2 * v1;

				if (det === 0) return;

				idet = 1 / det;

				a = (v2 * x1 - v1 * x2) * idet;
				b = (v2 * y1 - v1 * y2) * idet;
				c = (u1 * x2 - u2 * x1) * idet;
				d = (u1 * y2 - u2 * y1) * idet;

				e = x0 - a * u0 - c * v0;
				f = y0 - b * u0 - d * v0;

				_context.save();
				_context.transform(a, b, c, d, e, f);
				_context.fill();
				_context.restore();
		}

		function clipImage(x0, y0, x1, y1, x2, y2, u0, v0, u1, v1, u2, v2, image) {

				// http://extremelysatisfactorytotalitarianism.com/blog/?p=2120

				var a,
				    b,
				    c,
				    d,
				    e,
				    f,
				    det,
				    idet,
				    width = image.width - 1,
				    height = image.height - 1;

				u0 *= width;v0 *= height;
				u1 *= width;v1 *= height;
				u2 *= width;v2 *= height;

				x1 -= x0;y1 -= y0;
				x2 -= x0;y2 -= y0;

				u1 -= u0;v1 -= v0;
				u2 -= u0;v2 -= v0;

				det = u1 * v2 - u2 * v1;

				idet = 1 / det;

				a = (v2 * x1 - v1 * x2) * idet;
				b = (v2 * y1 - v1 * y2) * idet;
				c = (u1 * x2 - u2 * x1) * idet;
				d = (u1 * y2 - u2 * y1) * idet;

				e = x0 - a * u0 - c * v0;
				f = y0 - b * u0 - d * v0;

				_context.save();
				_context.transform(a, b, c, d, e, f);
				_context.clip();
				_context.drawImage(image, 0, 0);
				_context.restore();
		}

		// Hide anti-alias gaps

		function expand(v1, v2, pixels) {

				var x = v2.x - v1.x,
				    y = v2.y - v1.y,
				    det = x * x + y * y,
				    idet;

				if (det === 0) return;

				idet = pixels / Math.sqrt(det);

				x *= idet;y *= idet;

				v2.x += x;v2.y += y;
				v1.x -= x;v1.y -= y;
		}

		// Context cached methods.

		function setOpacity(value) {

				if (_contextGlobalAlpha !== value) {

						_context.globalAlpha = value;
						_contextGlobalAlpha = value;
				}
		}

		function setBlending(value) {

				if (_contextGlobalCompositeOperation !== value) {

						if (value === THREE.NormalBlending) {

								_context.globalCompositeOperation = 'source-over';
						} else if (value === THREE.AdditiveBlending) {

								_context.globalCompositeOperation = 'lighter';
						} else if (value === THREE.SubtractiveBlending) {

								_context.globalCompositeOperation = 'darker';
						}

						_contextGlobalCompositeOperation = value;
				}
		}

		function setLineWidth(value) {

				if (_contextLineWidth !== value) {

						_context.lineWidth = value;
						_contextLineWidth = value;
				}
		}

		function setLineCap(value) {

				// "butt", "round", "square"

				if (_contextLineCap !== value) {

						_context.lineCap = value;
						_contextLineCap = value;
				}
		}

		function setLineJoin(value) {

				// "round", "bevel", "miter"

				if (_contextLineJoin !== value) {

						_context.lineJoin = value;
						_contextLineJoin = value;
				}
		}

		function setStrokeStyle(value) {

				if (_contextStrokeStyle !== value) {

						_context.strokeStyle = value;
						_contextStrokeStyle = value;
				}
		}

		function setFillStyle(value) {

				if (_contextFillStyle !== value) {

						_context.fillStyle = value;
						_contextFillStyle = value;
				}
		}

		function setLineDash(value) {

				if (_contextLineDash.length !== value.length) {

						_context.setLineDash(value);
						_contextLineDash = value;
				}
		}
};
//# sourceMappingURL=data:application/json;base64,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QUFvQixLQUFwQixDQUhrQztLQUFuQztHQUZEOztBQVdBLFdBQVMsV0FBVCxDQUFzQixLQUF0QixFQUE4Qjs7QUFFN0IsUUFBSyxpQkFBaUIsTUFBakIsS0FBNEIsTUFBTSxNQUFOLEVBQWU7O0FBRS9DLGVBQVMsV0FBVCxDQUFzQixLQUF0QixFQUYrQztBQUcvQyx5QkFBbUIsS0FBbkIsQ0FIK0M7S0FBaEQ7R0FGRDtDQTVpQ3NCIiwiZmlsZSI6IkNhbnZhc1JlbmRlcmVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEBhdXRob3IgbXJkb29iIC8gaHR0cDovL21yZG9vYi5jb20vXHJcbiAqL1xyXG5cclxuVEhSRUUuU3ByaXRlQ2FudmFzTWF0ZXJpYWwgPSBmdW5jdGlvbiAoIHBhcmFtZXRlcnMgKSB7XHJcblxyXG5cdFRIUkVFLk1hdGVyaWFsLmNhbGwoIHRoaXMgKTtcclxuXHJcblx0dGhpcy50eXBlID0gJ1Nwcml0ZUNhbnZhc01hdGVyaWFsJztcclxuXHJcblx0dGhpcy5jb2xvciA9IG5ldyBUSFJFRS5Db2xvciggMHhmZmZmZmYgKTtcclxuXHR0aGlzLnByb2dyYW0gPSBmdW5jdGlvbiAoIGNvbnRleHQsIGNvbG9yICkge307XHJcblxyXG5cdHRoaXMuc2V0VmFsdWVzKCBwYXJhbWV0ZXJzICk7XHJcblxyXG59O1xyXG5cclxuVEhSRUUuU3ByaXRlQ2FudmFzTWF0ZXJpYWwucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSggVEhSRUUuTWF0ZXJpYWwucHJvdG90eXBlICk7XHJcblRIUkVFLlNwcml0ZUNhbnZhc01hdGVyaWFsLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IFRIUkVFLlNwcml0ZUNhbnZhc01hdGVyaWFsO1xyXG5cclxuVEhSRUUuU3ByaXRlQ2FudmFzTWF0ZXJpYWwucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24gKCkge1xyXG5cclxuXHR2YXIgbWF0ZXJpYWwgPSBuZXcgVEhSRUUuU3ByaXRlQ2FudmFzTWF0ZXJpYWwoKTtcclxuXHJcblx0bWF0ZXJpYWwuY29weSggdGhpcyApO1xyXG5cdG1hdGVyaWFsLmNvbG9yLmNvcHkoIHRoaXMuY29sb3IgKTtcclxuXHRtYXRlcmlhbC5wcm9ncmFtID0gdGhpcy5wcm9ncmFtO1xyXG5cclxuXHRyZXR1cm4gbWF0ZXJpYWw7XHJcblxyXG59O1xyXG5cclxuLy9cclxuXHJcblRIUkVFLkNhbnZhc1JlbmRlcmVyID0gZnVuY3Rpb24gKCBwYXJhbWV0ZXJzICkge1xyXG5cclxuXHRjb25zb2xlLmxvZyggJ1RIUkVFLkNhbnZhc1JlbmRlcmVyJywgVEhSRUUuUkVWSVNJT04gKTtcclxuXHJcblx0cGFyYW1ldGVycyA9IHBhcmFtZXRlcnMgfHwge307XHJcblxyXG5cdHZhciBfdGhpcyA9IHRoaXMsXHJcblx0X3JlbmRlckRhdGEsIF9lbGVtZW50cywgX2xpZ2h0cyxcclxuXHRfcHJvamVjdG9yID0gbmV3IFRIUkVFLlByb2plY3RvcigpLFxyXG5cclxuXHRfY2FudmFzID0gcGFyYW1ldGVycy5jYW52YXMgIT09IHVuZGVmaW5lZFxyXG5cdFx0XHQgPyBwYXJhbWV0ZXJzLmNhbnZhc1xyXG5cdFx0XHQgOiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnY2FudmFzJyApLFxyXG5cclxuXHRfY2FudmFzV2lkdGggPSBfY2FudmFzLndpZHRoLFxyXG5cdF9jYW52YXNIZWlnaHQgPSBfY2FudmFzLmhlaWdodCxcclxuXHRfY2FudmFzV2lkdGhIYWxmID0gTWF0aC5mbG9vciggX2NhbnZhc1dpZHRoIC8gMiApLFxyXG5cdF9jYW52YXNIZWlnaHRIYWxmID0gTWF0aC5mbG9vciggX2NhbnZhc0hlaWdodCAvIDIgKSxcclxuXHJcblx0X3ZpZXdwb3J0WCA9IDAsXHJcblx0X3ZpZXdwb3J0WSA9IDAsXHJcblx0X3ZpZXdwb3J0V2lkdGggPSBfY2FudmFzV2lkdGgsXHJcblx0X3ZpZXdwb3J0SGVpZ2h0ID0gX2NhbnZhc0hlaWdodCxcclxuXHJcblx0X3BpeGVsUmF0aW8gPSAxLFxyXG5cclxuXHRfY29udGV4dCA9IF9jYW52YXMuZ2V0Q29udGV4dCggJzJkJywge1xyXG5cdFx0YWxwaGE6IHBhcmFtZXRlcnMuYWxwaGEgPT09IHRydWVcclxuXHR9ICksXHJcblxyXG5cdF9jbGVhckNvbG9yID0gbmV3IFRIUkVFLkNvbG9yKCAweDAwMDAwMCApLFxyXG5cdF9jbGVhckFscGhhID0gcGFyYW1ldGVycy5hbHBoYSA9PT0gdHJ1ZSA/IDAgOiAxLFxyXG5cclxuXHRfY29udGV4dEdsb2JhbEFscGhhID0gMSxcclxuXHRfY29udGV4dEdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9IDAsXHJcblx0X2NvbnRleHRTdHJva2VTdHlsZSA9IG51bGwsXHJcblx0X2NvbnRleHRGaWxsU3R5bGUgPSBudWxsLFxyXG5cdF9jb250ZXh0TGluZVdpZHRoID0gbnVsbCxcclxuXHRfY29udGV4dExpbmVDYXAgPSBudWxsLFxyXG5cdF9jb250ZXh0TGluZUpvaW4gPSBudWxsLFxyXG5cdF9jb250ZXh0TGluZURhc2ggPSBbXSxcclxuXHJcblx0X2NhbWVyYSxcclxuXHJcblx0X3YxLCBfdjIsIF92MywgX3Y0LFxyXG5cdF92NSA9IG5ldyBUSFJFRS5SZW5kZXJhYmxlVmVydGV4KCksXHJcblx0X3Y2ID0gbmV3IFRIUkVFLlJlbmRlcmFibGVWZXJ0ZXgoKSxcclxuXHJcblx0X3YxeCwgX3YxeSwgX3YyeCwgX3YyeSwgX3YzeCwgX3YzeSxcclxuXHRfdjR4LCBfdjR5LCBfdjV4LCBfdjV5LCBfdjZ4LCBfdjZ5LFxyXG5cclxuXHRfY29sb3IgPSBuZXcgVEhSRUUuQ29sb3IoKSxcclxuXHRfY29sb3IxID0gbmV3IFRIUkVFLkNvbG9yKCksXHJcblx0X2NvbG9yMiA9IG5ldyBUSFJFRS5Db2xvcigpLFxyXG5cdF9jb2xvcjMgPSBuZXcgVEhSRUUuQ29sb3IoKSxcclxuXHRfY29sb3I0ID0gbmV3IFRIUkVFLkNvbG9yKCksXHJcblxyXG5cdF9kaWZmdXNlQ29sb3IgPSBuZXcgVEhSRUUuQ29sb3IoKSxcclxuXHRfZW1pc3NpdmVDb2xvciA9IG5ldyBUSFJFRS5Db2xvcigpLFxyXG5cclxuXHRfbGlnaHRDb2xvciA9IG5ldyBUSFJFRS5Db2xvcigpLFxyXG5cclxuXHRfcGF0dGVybnMgPSB7fSxcclxuXHJcblx0X2ltYWdlLCBfdXZzLFxyXG5cdF91djF4LCBfdXYxeSwgX3V2MngsIF91djJ5LCBfdXYzeCwgX3V2M3ksXHJcblxyXG5cdF9jbGlwQm94ID0gbmV3IFRIUkVFLkJveDIoKSxcclxuXHRfY2xlYXJCb3ggPSBuZXcgVEhSRUUuQm94MigpLFxyXG5cdF9lbGVtQm94ID0gbmV3IFRIUkVFLkJveDIoKSxcclxuXHJcblx0X2FtYmllbnRMaWdodCA9IG5ldyBUSFJFRS5Db2xvcigpLFxyXG5cdF9kaXJlY3Rpb25hbExpZ2h0cyA9IG5ldyBUSFJFRS5Db2xvcigpLFxyXG5cdF9wb2ludExpZ2h0cyA9IG5ldyBUSFJFRS5Db2xvcigpLFxyXG5cclxuXHRfdmVjdG9yMyA9IG5ldyBUSFJFRS5WZWN0b3IzKCksIC8vIE5lZWRlZCBmb3IgUG9pbnRMaWdodFxyXG5cdF9jZW50cm9pZCA9IG5ldyBUSFJFRS5WZWN0b3IzKCksXHJcblx0X25vcm1hbCA9IG5ldyBUSFJFRS5WZWN0b3IzKCksXHJcblx0X25vcm1hbFZpZXdNYXRyaXggPSBuZXcgVEhSRUUuTWF0cml4MygpO1xyXG5cclxuXHQvKiBUT0RPXHJcblx0X2NhbnZhcy5tb3pJbWFnZVNtb290aGluZ0VuYWJsZWQgPSBmYWxzZTtcclxuXHRfY2FudmFzLndlYmtpdEltYWdlU21vb3RoaW5nRW5hYmxlZCA9IGZhbHNlO1xyXG5cdF9jYW52YXMubXNJbWFnZVNtb290aGluZ0VuYWJsZWQgPSBmYWxzZTtcclxuXHRfY2FudmFzLmltYWdlU21vb3RoaW5nRW5hYmxlZCA9IGZhbHNlO1xyXG5cdCovXHJcblxyXG5cdC8vIGRhc2grZ2FwIGZhbGxiYWNrcyBmb3IgRmlyZWZveCBhbmQgZXZlcnl0aGluZyBlbHNlXHJcblxyXG5cdGlmICggX2NvbnRleHQuc2V0TGluZURhc2ggPT09IHVuZGVmaW5lZCApIHtcclxuXHJcblx0XHRfY29udGV4dC5zZXRMaW5lRGFzaCA9IGZ1bmN0aW9uICgpIHt9O1xyXG5cclxuXHR9XHJcblxyXG5cdHRoaXMuZG9tRWxlbWVudCA9IF9jYW52YXM7XHJcblxyXG5cdHRoaXMuYXV0b0NsZWFyID0gdHJ1ZTtcclxuXHR0aGlzLnNvcnRPYmplY3RzID0gdHJ1ZTtcclxuXHR0aGlzLnNvcnRFbGVtZW50cyA9IHRydWU7XHJcblxyXG5cdHRoaXMuaW5mbyA9IHtcclxuXHJcblx0XHRyZW5kZXI6IHtcclxuXHJcblx0XHRcdHZlcnRpY2VzOiAwLFxyXG5cdFx0XHRmYWNlczogMFxyXG5cclxuXHRcdH1cclxuXHJcblx0fTtcclxuXHJcblx0Ly8gV2ViR0xSZW5kZXJlciBjb21wYXRpYmlsaXR5XHJcblxyXG5cdHRoaXMuc3VwcG9ydHNWZXJ0ZXhUZXh0dXJlcyA9IGZ1bmN0aW9uICgpIHt9O1xyXG5cdHRoaXMuc2V0RmFjZUN1bGxpbmcgPSBmdW5jdGlvbiAoKSB7fTtcclxuXHJcblx0Ly8gQVBJXHJcblxyXG5cdHRoaXMuZ2V0Q29udGV4dCA9IGZ1bmN0aW9uICgpIHtcclxuXHJcblx0XHRyZXR1cm4gX2NvbnRleHQ7XHJcblxyXG5cdH07XHJcblxyXG5cdHRoaXMuZ2V0Q29udGV4dEF0dHJpYnV0ZXMgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG5cdFx0cmV0dXJuIF9jb250ZXh0LmdldENvbnRleHRBdHRyaWJ1dGVzKCk7XHJcblxyXG5cdH07XHJcblxyXG5cdHRoaXMuZ2V0UGl4ZWxSYXRpbyA9IGZ1bmN0aW9uICgpIHtcclxuXHJcblx0XHRyZXR1cm4gX3BpeGVsUmF0aW87XHJcblxyXG5cdH07XHJcblxyXG5cdHRoaXMuc2V0UGl4ZWxSYXRpbyA9IGZ1bmN0aW9uICggdmFsdWUgKSB7XHJcblxyXG5cdFx0aWYgKCB2YWx1ZSAhPT0gdW5kZWZpbmVkICkgX3BpeGVsUmF0aW8gPSB2YWx1ZTtcclxuXHJcblx0fTtcclxuXHJcblx0dGhpcy5zZXRTaXplID0gZnVuY3Rpb24gKCB3aWR0aCwgaGVpZ2h0LCB1cGRhdGVTdHlsZSApIHtcclxuXHJcblx0XHRfY2FudmFzV2lkdGggPSB3aWR0aCAqIF9waXhlbFJhdGlvO1xyXG5cdFx0X2NhbnZhc0hlaWdodCA9IGhlaWdodCAqIF9waXhlbFJhdGlvO1xyXG5cclxuXHRcdF9jYW52YXMud2lkdGggPSBfY2FudmFzV2lkdGg7XHJcblx0XHRfY2FudmFzLmhlaWdodCA9IF9jYW52YXNIZWlnaHQ7XHJcblxyXG5cdFx0X2NhbnZhc1dpZHRoSGFsZiA9IE1hdGguZmxvb3IoIF9jYW52YXNXaWR0aCAvIDIgKTtcclxuXHRcdF9jYW52YXNIZWlnaHRIYWxmID0gTWF0aC5mbG9vciggX2NhbnZhc0hlaWdodCAvIDIgKTtcclxuXHJcblx0XHRpZiAoIHVwZGF0ZVN0eWxlICE9PSBmYWxzZSApIHtcclxuXHJcblx0XHRcdF9jYW52YXMuc3R5bGUud2lkdGggPSB3aWR0aCArICdweCc7XHJcblx0XHRcdF9jYW52YXMuc3R5bGUuaGVpZ2h0ID0gaGVpZ2h0ICsgJ3B4JztcclxuXHJcblx0XHR9XHJcblxyXG5cdFx0X2NsaXBCb3gubWluLnNldCggLSBfY2FudmFzV2lkdGhIYWxmLCAtIF9jYW52YXNIZWlnaHRIYWxmICk7XHJcblx0XHRfY2xpcEJveC5tYXguc2V0KCAgIF9jYW52YXNXaWR0aEhhbGYsICAgX2NhbnZhc0hlaWdodEhhbGYgKTtcclxuXHJcblx0XHRfY2xlYXJCb3gubWluLnNldCggLSBfY2FudmFzV2lkdGhIYWxmLCAtIF9jYW52YXNIZWlnaHRIYWxmICk7XHJcblx0XHRfY2xlYXJCb3gubWF4LnNldCggICBfY2FudmFzV2lkdGhIYWxmLCAgIF9jYW52YXNIZWlnaHRIYWxmICk7XHJcblxyXG5cdFx0X2NvbnRleHRHbG9iYWxBbHBoYSA9IDE7XHJcblx0XHRfY29udGV4dEdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9IDA7XHJcblx0XHRfY29udGV4dFN0cm9rZVN0eWxlID0gbnVsbDtcclxuXHRcdF9jb250ZXh0RmlsbFN0eWxlID0gbnVsbDtcclxuXHRcdF9jb250ZXh0TGluZVdpZHRoID0gbnVsbDtcclxuXHRcdF9jb250ZXh0TGluZUNhcCA9IG51bGw7XHJcblx0XHRfY29udGV4dExpbmVKb2luID0gbnVsbDtcclxuXHJcblx0XHR0aGlzLnNldFZpZXdwb3J0KCAwLCAwLCB3aWR0aCwgaGVpZ2h0ICk7XHJcblxyXG5cdH07XHJcblxyXG5cdHRoaXMuc2V0Vmlld3BvcnQgPSBmdW5jdGlvbiAoIHgsIHksIHdpZHRoLCBoZWlnaHQgKSB7XHJcblxyXG5cdFx0X3ZpZXdwb3J0WCA9IHggKiBfcGl4ZWxSYXRpbztcclxuXHRcdF92aWV3cG9ydFkgPSB5ICogX3BpeGVsUmF0aW87XHJcblxyXG5cdFx0X3ZpZXdwb3J0V2lkdGggPSB3aWR0aCAqIF9waXhlbFJhdGlvO1xyXG5cdFx0X3ZpZXdwb3J0SGVpZ2h0ID0gaGVpZ2h0ICogX3BpeGVsUmF0aW87XHJcblxyXG5cdH07XHJcblxyXG5cdHRoaXMuc2V0U2Npc3NvciA9IGZ1bmN0aW9uICgpIHt9O1xyXG5cdHRoaXMuc2V0U2Npc3NvclRlc3QgPSBmdW5jdGlvbiAoKSB7fTtcclxuXHJcblx0dGhpcy5zZXRDbGVhckNvbG9yID0gZnVuY3Rpb24gKCBjb2xvciwgYWxwaGEgKSB7XHJcblxyXG5cdFx0X2NsZWFyQ29sb3Iuc2V0KCBjb2xvciApO1xyXG5cdFx0X2NsZWFyQWxwaGEgPSBhbHBoYSAhPT0gdW5kZWZpbmVkID8gYWxwaGEgOiAxO1xyXG5cclxuXHRcdF9jbGVhckJveC5taW4uc2V0KCAtIF9jYW52YXNXaWR0aEhhbGYsIC0gX2NhbnZhc0hlaWdodEhhbGYgKTtcclxuXHRcdF9jbGVhckJveC5tYXguc2V0KCAgIF9jYW52YXNXaWR0aEhhbGYsICAgX2NhbnZhc0hlaWdodEhhbGYgKTtcclxuXHJcblx0fTtcclxuXHJcblx0dGhpcy5zZXRDbGVhckNvbG9ySGV4ID0gZnVuY3Rpb24gKCBoZXgsIGFscGhhICkge1xyXG5cclxuXHRcdGNvbnNvbGUud2FybiggJ1RIUkVFLkNhbnZhc1JlbmRlcmVyOiAuc2V0Q2xlYXJDb2xvckhleCgpIGlzIGJlaW5nIHJlbW92ZWQuIFVzZSAuc2V0Q2xlYXJDb2xvcigpIGluc3RlYWQuJyApO1xyXG5cdFx0dGhpcy5zZXRDbGVhckNvbG9yKCBoZXgsIGFscGhhICk7XHJcblxyXG5cdH07XHJcblxyXG5cdHRoaXMuZ2V0Q2xlYXJDb2xvciA9IGZ1bmN0aW9uICgpIHtcclxuXHJcblx0XHRyZXR1cm4gX2NsZWFyQ29sb3I7XHJcblxyXG5cdH07XHJcblxyXG5cdHRoaXMuZ2V0Q2xlYXJBbHBoYSA9IGZ1bmN0aW9uICgpIHtcclxuXHJcblx0XHRyZXR1cm4gX2NsZWFyQWxwaGE7XHJcblxyXG5cdH07XHJcblxyXG5cdHRoaXMuZ2V0TWF4QW5pc290cm9weSA9IGZ1bmN0aW9uICgpIHtcclxuXHJcblx0XHRyZXR1cm4gMDtcclxuXHJcblx0fTtcclxuXHJcblx0dGhpcy5jbGVhciA9IGZ1bmN0aW9uICgpIHtcclxuXHJcblx0XHRpZiAoIF9jbGVhckJveC5pc0VtcHR5KCkgPT09IGZhbHNlICkge1xyXG5cclxuXHRcdFx0X2NsZWFyQm94LmludGVyc2VjdCggX2NsaXBCb3ggKTtcclxuXHRcdFx0X2NsZWFyQm94LmV4cGFuZEJ5U2NhbGFyKCAyICk7XHJcblxyXG5cdFx0XHRfY2xlYXJCb3gubWluLnggPSBfY2xlYXJCb3gubWluLnggKyBfY2FudmFzV2lkdGhIYWxmO1xyXG5cdFx0XHRfY2xlYXJCb3gubWluLnkgPSAgLSBfY2xlYXJCb3gubWluLnkgKyBfY2FudmFzSGVpZ2h0SGFsZjtcdFx0Ly8gaGlnaGVyIHkgdmFsdWUgIVxyXG5cdFx0XHRfY2xlYXJCb3gubWF4LnggPSBfY2xlYXJCb3gubWF4LnggKyBfY2FudmFzV2lkdGhIYWxmO1xyXG5cdFx0XHRfY2xlYXJCb3gubWF4LnkgPSAgLSBfY2xlYXJCb3gubWF4LnkgKyBfY2FudmFzSGVpZ2h0SGFsZjtcdFx0Ly8gbG93ZXIgeSB2YWx1ZSAhXHJcblxyXG5cdFx0XHRpZiAoIF9jbGVhckFscGhhIDwgMSApIHtcclxuXHJcblx0XHRcdFx0X2NvbnRleHQuY2xlYXJSZWN0KFxyXG5cdFx0XHRcdFx0X2NsZWFyQm94Lm1pbi54IHwgMCxcclxuXHRcdFx0XHRcdF9jbGVhckJveC5tYXgueSB8IDAsXHJcblx0XHRcdFx0XHQoIF9jbGVhckJveC5tYXgueCAtIF9jbGVhckJveC5taW4ueCApIHwgMCxcclxuXHRcdFx0XHRcdCggX2NsZWFyQm94Lm1pbi55IC0gX2NsZWFyQm94Lm1heC55ICkgfCAwXHJcblx0XHRcdFx0KTtcclxuXHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmICggX2NsZWFyQWxwaGEgPiAwICkge1xyXG5cclxuXHRcdFx0XHRzZXRCbGVuZGluZyggVEhSRUUuTm9ybWFsQmxlbmRpbmcgKTtcclxuXHRcdFx0XHRzZXRPcGFjaXR5KCAxICk7XHJcblxyXG5cdFx0XHRcdHNldEZpbGxTdHlsZSggJ3JnYmEoJyArIE1hdGguZmxvb3IoIF9jbGVhckNvbG9yLnIgKiAyNTUgKSArICcsJyArIE1hdGguZmxvb3IoIF9jbGVhckNvbG9yLmcgKiAyNTUgKSArICcsJyArIE1hdGguZmxvb3IoIF9jbGVhckNvbG9yLmIgKiAyNTUgKSArICcsJyArIF9jbGVhckFscGhhICsgJyknICk7XHJcblxyXG5cdFx0XHRcdF9jb250ZXh0LmZpbGxSZWN0KFxyXG5cdFx0XHRcdFx0X2NsZWFyQm94Lm1pbi54IHwgMCxcclxuXHRcdFx0XHRcdF9jbGVhckJveC5tYXgueSB8IDAsXHJcblx0XHRcdFx0XHQoIF9jbGVhckJveC5tYXgueCAtIF9jbGVhckJveC5taW4ueCApIHwgMCxcclxuXHRcdFx0XHRcdCggX2NsZWFyQm94Lm1pbi55IC0gX2NsZWFyQm94Lm1heC55ICkgfCAwXHJcblx0XHRcdFx0KTtcclxuXHJcblx0XHRcdH1cclxuXHJcblx0XHRcdF9jbGVhckJveC5tYWtlRW1wdHkoKTtcclxuXHJcblx0XHR9XHJcblxyXG5cdH07XHJcblxyXG5cdC8vIGNvbXBhdGliaWxpdHlcclxuXHJcblx0dGhpcy5jbGVhckNvbG9yID0gZnVuY3Rpb24gKCkge307XHJcblx0dGhpcy5jbGVhckRlcHRoID0gZnVuY3Rpb24gKCkge307XHJcblx0dGhpcy5jbGVhclN0ZW5jaWwgPSBmdW5jdGlvbiAoKSB7fTtcclxuXHJcblx0dGhpcy5yZW5kZXIgPSBmdW5jdGlvbiAoIHNjZW5lLCBjYW1lcmEgKSB7XHJcblxyXG5cdFx0aWYgKCBjYW1lcmEgaW5zdGFuY2VvZiBUSFJFRS5DYW1lcmEgPT09IGZhbHNlICkge1xyXG5cclxuXHRcdFx0Y29uc29sZS5lcnJvciggJ1RIUkVFLkNhbnZhc1JlbmRlcmVyLnJlbmRlcjogY2FtZXJhIGlzIG5vdCBhbiBpbnN0YW5jZSBvZiBUSFJFRS5DYW1lcmEuJyApO1xyXG5cdFx0XHRyZXR1cm47XHJcblxyXG5cdFx0fVxyXG5cclxuXHRcdGlmICggdGhpcy5hdXRvQ2xlYXIgPT09IHRydWUgKSB0aGlzLmNsZWFyKCk7XHJcblxyXG5cdFx0X3RoaXMuaW5mby5yZW5kZXIudmVydGljZXMgPSAwO1xyXG5cdFx0X3RoaXMuaW5mby5yZW5kZXIuZmFjZXMgPSAwO1xyXG5cclxuXHRcdF9jb250ZXh0LnNldFRyYW5zZm9ybSggX3ZpZXdwb3J0V2lkdGggLyBfY2FudmFzV2lkdGgsIDAsIDAsIC0gX3ZpZXdwb3J0SGVpZ2h0IC8gX2NhbnZhc0hlaWdodCwgX3ZpZXdwb3J0WCwgX2NhbnZhc0hlaWdodCAtIF92aWV3cG9ydFkgKTtcclxuXHRcdF9jb250ZXh0LnRyYW5zbGF0ZSggX2NhbnZhc1dpZHRoSGFsZiwgX2NhbnZhc0hlaWdodEhhbGYgKTtcclxuXHJcblx0XHRfcmVuZGVyRGF0YSA9IF9wcm9qZWN0b3IucHJvamVjdFNjZW5lKCBzY2VuZSwgY2FtZXJhLCB0aGlzLnNvcnRPYmplY3RzLCB0aGlzLnNvcnRFbGVtZW50cyApO1xyXG5cdFx0X2VsZW1lbnRzID0gX3JlbmRlckRhdGEuZWxlbWVudHM7XHJcblx0XHRfbGlnaHRzID0gX3JlbmRlckRhdGEubGlnaHRzO1xyXG5cdFx0X2NhbWVyYSA9IGNhbWVyYTtcclxuXHJcblx0XHRfbm9ybWFsVmlld01hdHJpeC5nZXROb3JtYWxNYXRyaXgoIGNhbWVyYS5tYXRyaXhXb3JsZEludmVyc2UgKTtcclxuXHJcblx0XHQvKiBERUJVR1xyXG5cdFx0c2V0RmlsbFN0eWxlKCAncmdiYSggMCwgMjU1LCAyNTUsIDAuNSApJyApO1xyXG5cdFx0X2NvbnRleHQuZmlsbFJlY3QoIF9jbGlwQm94Lm1pbi54LCBfY2xpcEJveC5taW4ueSwgX2NsaXBCb3gubWF4LnggLSBfY2xpcEJveC5taW4ueCwgX2NsaXBCb3gubWF4LnkgLSBfY2xpcEJveC5taW4ueSApO1xyXG5cdFx0Ki9cclxuXHJcblx0XHRjYWxjdWxhdGVMaWdodHMoKTtcclxuXHJcblx0XHRmb3IgKCB2YXIgZSA9IDAsIGVsID0gX2VsZW1lbnRzLmxlbmd0aDsgZSA8IGVsOyBlICsrICkge1xyXG5cclxuXHRcdFx0dmFyIGVsZW1lbnQgPSBfZWxlbWVudHNbIGUgXTtcclxuXHJcblx0XHRcdHZhciBtYXRlcmlhbCA9IGVsZW1lbnQubWF0ZXJpYWw7XHJcblxyXG5cdFx0XHRpZiAoIG1hdGVyaWFsID09PSB1bmRlZmluZWQgfHwgbWF0ZXJpYWwub3BhY2l0eSA9PT0gMCApIGNvbnRpbnVlO1xyXG5cclxuXHRcdFx0X2VsZW1Cb3gubWFrZUVtcHR5KCk7XHJcblxyXG5cdFx0XHRpZiAoIGVsZW1lbnQgaW5zdGFuY2VvZiBUSFJFRS5SZW5kZXJhYmxlU3ByaXRlICkge1xyXG5cclxuXHRcdFx0XHRfdjEgPSBlbGVtZW50O1xyXG5cdFx0XHRcdF92MS54ICo9IF9jYW52YXNXaWR0aEhhbGY7IF92MS55ICo9IF9jYW52YXNIZWlnaHRIYWxmO1xyXG5cclxuXHRcdFx0XHRyZW5kZXJTcHJpdGUoIF92MSwgZWxlbWVudCwgbWF0ZXJpYWwgKTtcclxuXHJcblx0XHRcdH0gZWxzZSBpZiAoIGVsZW1lbnQgaW5zdGFuY2VvZiBUSFJFRS5SZW5kZXJhYmxlTGluZSApIHtcclxuXHJcblx0XHRcdFx0X3YxID0gZWxlbWVudC52MTsgX3YyID0gZWxlbWVudC52MjtcclxuXHJcblx0XHRcdFx0X3YxLnBvc2l0aW9uU2NyZWVuLnggKj0gX2NhbnZhc1dpZHRoSGFsZjsgX3YxLnBvc2l0aW9uU2NyZWVuLnkgKj0gX2NhbnZhc0hlaWdodEhhbGY7XHJcblx0XHRcdFx0X3YyLnBvc2l0aW9uU2NyZWVuLnggKj0gX2NhbnZhc1dpZHRoSGFsZjsgX3YyLnBvc2l0aW9uU2NyZWVuLnkgKj0gX2NhbnZhc0hlaWdodEhhbGY7XHJcblxyXG5cdFx0XHRcdF9lbGVtQm94LnNldEZyb21Qb2ludHMoIFtcclxuXHRcdFx0XHRcdF92MS5wb3NpdGlvblNjcmVlbixcclxuXHRcdFx0XHRcdF92Mi5wb3NpdGlvblNjcmVlblxyXG5cdFx0XHRcdF0gKTtcclxuXHJcblx0XHRcdFx0aWYgKCBfY2xpcEJveC5pbnRlcnNlY3RzQm94KCBfZWxlbUJveCApID09PSB0cnVlICkge1xyXG5cclxuXHRcdFx0XHRcdHJlbmRlckxpbmUoIF92MSwgX3YyLCBlbGVtZW50LCBtYXRlcmlhbCApO1xyXG5cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHR9IGVsc2UgaWYgKCBlbGVtZW50IGluc3RhbmNlb2YgVEhSRUUuUmVuZGVyYWJsZUZhY2UgKSB7XHJcblxyXG5cdFx0XHRcdF92MSA9IGVsZW1lbnQudjE7IF92MiA9IGVsZW1lbnQudjI7IF92MyA9IGVsZW1lbnQudjM7XHJcblxyXG5cdFx0XHRcdGlmICggX3YxLnBvc2l0aW9uU2NyZWVuLnogPCAtIDEgfHwgX3YxLnBvc2l0aW9uU2NyZWVuLnogPiAxICkgY29udGludWU7XHJcblx0XHRcdFx0aWYgKCBfdjIucG9zaXRpb25TY3JlZW4ueiA8IC0gMSB8fCBfdjIucG9zaXRpb25TY3JlZW4ueiA+IDEgKSBjb250aW51ZTtcclxuXHRcdFx0XHRpZiAoIF92My5wb3NpdGlvblNjcmVlbi56IDwgLSAxIHx8IF92My5wb3NpdGlvblNjcmVlbi56ID4gMSApIGNvbnRpbnVlO1xyXG5cclxuXHRcdFx0XHRfdjEucG9zaXRpb25TY3JlZW4ueCAqPSBfY2FudmFzV2lkdGhIYWxmOyBfdjEucG9zaXRpb25TY3JlZW4ueSAqPSBfY2FudmFzSGVpZ2h0SGFsZjtcclxuXHRcdFx0XHRfdjIucG9zaXRpb25TY3JlZW4ueCAqPSBfY2FudmFzV2lkdGhIYWxmOyBfdjIucG9zaXRpb25TY3JlZW4ueSAqPSBfY2FudmFzSGVpZ2h0SGFsZjtcclxuXHRcdFx0XHRfdjMucG9zaXRpb25TY3JlZW4ueCAqPSBfY2FudmFzV2lkdGhIYWxmOyBfdjMucG9zaXRpb25TY3JlZW4ueSAqPSBfY2FudmFzSGVpZ2h0SGFsZjtcclxuXHJcblx0XHRcdFx0aWYgKCBtYXRlcmlhbC5vdmVyZHJhdyA+IDAgKSB7XHJcblxyXG5cdFx0XHRcdFx0ZXhwYW5kKCBfdjEucG9zaXRpb25TY3JlZW4sIF92Mi5wb3NpdGlvblNjcmVlbiwgbWF0ZXJpYWwub3ZlcmRyYXcgKTtcclxuXHRcdFx0XHRcdGV4cGFuZCggX3YyLnBvc2l0aW9uU2NyZWVuLCBfdjMucG9zaXRpb25TY3JlZW4sIG1hdGVyaWFsLm92ZXJkcmF3ICk7XHJcblx0XHRcdFx0XHRleHBhbmQoIF92My5wb3NpdGlvblNjcmVlbiwgX3YxLnBvc2l0aW9uU2NyZWVuLCBtYXRlcmlhbC5vdmVyZHJhdyApO1xyXG5cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdF9lbGVtQm94LnNldEZyb21Qb2ludHMoIFtcclxuXHRcdFx0XHRcdF92MS5wb3NpdGlvblNjcmVlbixcclxuXHRcdFx0XHRcdF92Mi5wb3NpdGlvblNjcmVlbixcclxuXHRcdFx0XHRcdF92My5wb3NpdGlvblNjcmVlblxyXG5cdFx0XHRcdF0gKTtcclxuXHJcblx0XHRcdFx0aWYgKCBfY2xpcEJveC5pbnRlcnNlY3RzQm94KCBfZWxlbUJveCApID09PSB0cnVlICkge1xyXG5cclxuXHRcdFx0XHRcdHJlbmRlckZhY2UzKCBfdjEsIF92MiwgX3YzLCAwLCAxLCAyLCBlbGVtZW50LCBtYXRlcmlhbCApO1xyXG5cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvKiBERUJVR1xyXG5cdFx0XHRzZXRMaW5lV2lkdGgoIDEgKTtcclxuXHRcdFx0c2V0U3Ryb2tlU3R5bGUoICdyZ2JhKCAwLCAyNTUsIDAsIDAuNSApJyApO1xyXG5cdFx0XHRfY29udGV4dC5zdHJva2VSZWN0KCBfZWxlbUJveC5taW4ueCwgX2VsZW1Cb3gubWluLnksIF9lbGVtQm94Lm1heC54IC0gX2VsZW1Cb3gubWluLngsIF9lbGVtQm94Lm1heC55IC0gX2VsZW1Cb3gubWluLnkgKTtcclxuXHRcdFx0Ki9cclxuXHJcblx0XHRcdF9jbGVhckJveC51bmlvbiggX2VsZW1Cb3ggKTtcclxuXHJcblx0XHR9XHJcblxyXG5cdFx0LyogREVCVUdcclxuXHRcdHNldExpbmVXaWR0aCggMSApO1xyXG5cdFx0c2V0U3Ryb2tlU3R5bGUoICdyZ2JhKCAyNTUsIDAsIDAsIDAuNSApJyApO1xyXG5cdFx0X2NvbnRleHQuc3Ryb2tlUmVjdCggX2NsZWFyQm94Lm1pbi54LCBfY2xlYXJCb3gubWluLnksIF9jbGVhckJveC5tYXgueCAtIF9jbGVhckJveC5taW4ueCwgX2NsZWFyQm94Lm1heC55IC0gX2NsZWFyQm94Lm1pbi55ICk7XHJcblx0XHQqL1xyXG5cclxuXHRcdF9jb250ZXh0LnNldFRyYW5zZm9ybSggMSwgMCwgMCwgMSwgMCwgMCApO1xyXG5cclxuXHR9O1xyXG5cclxuXHQvL1xyXG5cclxuXHRmdW5jdGlvbiBjYWxjdWxhdGVMaWdodHMoKSB7XHJcblxyXG5cdFx0X2FtYmllbnRMaWdodC5zZXRSR0IoIDAsIDAsIDAgKTtcclxuXHRcdF9kaXJlY3Rpb25hbExpZ2h0cy5zZXRSR0IoIDAsIDAsIDAgKTtcclxuXHRcdF9wb2ludExpZ2h0cy5zZXRSR0IoIDAsIDAsIDAgKTtcclxuXHJcblx0XHRmb3IgKCB2YXIgbCA9IDAsIGxsID0gX2xpZ2h0cy5sZW5ndGg7IGwgPCBsbDsgbCArKyApIHtcclxuXHJcblx0XHRcdHZhciBsaWdodCA9IF9saWdodHNbIGwgXTtcclxuXHRcdFx0dmFyIGxpZ2h0Q29sb3IgPSBsaWdodC5jb2xvcjtcclxuXHJcblx0XHRcdGlmICggbGlnaHQgaW5zdGFuY2VvZiBUSFJFRS5BbWJpZW50TGlnaHQgKSB7XHJcblxyXG5cdFx0XHRcdF9hbWJpZW50TGlnaHQuYWRkKCBsaWdodENvbG9yICk7XHJcblxyXG5cdFx0XHR9IGVsc2UgaWYgKCBsaWdodCBpbnN0YW5jZW9mIFRIUkVFLkRpcmVjdGlvbmFsTGlnaHQgKSB7XHJcblxyXG5cdFx0XHRcdC8vIGZvciBzcHJpdGVzXHJcblxyXG5cdFx0XHRcdF9kaXJlY3Rpb25hbExpZ2h0cy5hZGQoIGxpZ2h0Q29sb3IgKTtcclxuXHJcblx0XHRcdH0gZWxzZSBpZiAoIGxpZ2h0IGluc3RhbmNlb2YgVEhSRUUuUG9pbnRMaWdodCApIHtcclxuXHJcblx0XHRcdFx0Ly8gZm9yIHNwcml0ZXNcclxuXHJcblx0XHRcdFx0X3BvaW50TGlnaHRzLmFkZCggbGlnaHRDb2xvciApO1xyXG5cclxuXHRcdFx0fVxyXG5cclxuXHRcdH1cclxuXHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBjYWxjdWxhdGVMaWdodCggcG9zaXRpb24sIG5vcm1hbCwgY29sb3IgKSB7XHJcblxyXG5cdFx0Zm9yICggdmFyIGwgPSAwLCBsbCA9IF9saWdodHMubGVuZ3RoOyBsIDwgbGw7IGwgKysgKSB7XHJcblxyXG5cdFx0XHR2YXIgbGlnaHQgPSBfbGlnaHRzWyBsIF07XHJcblxyXG5cdFx0XHRfbGlnaHRDb2xvci5jb3B5KCBsaWdodC5jb2xvciApO1xyXG5cclxuXHRcdFx0aWYgKCBsaWdodCBpbnN0YW5jZW9mIFRIUkVFLkRpcmVjdGlvbmFsTGlnaHQgKSB7XHJcblxyXG5cdFx0XHRcdHZhciBsaWdodFBvc2l0aW9uID0gX3ZlY3RvcjMuc2V0RnJvbU1hdHJpeFBvc2l0aW9uKCBsaWdodC5tYXRyaXhXb3JsZCApLm5vcm1hbGl6ZSgpO1xyXG5cclxuXHRcdFx0XHR2YXIgYW1vdW50ID0gbm9ybWFsLmRvdCggbGlnaHRQb3NpdGlvbiApO1xyXG5cclxuXHRcdFx0XHRpZiAoIGFtb3VudCA8PSAwICkgY29udGludWU7XHJcblxyXG5cdFx0XHRcdGFtb3VudCAqPSBsaWdodC5pbnRlbnNpdHk7XHJcblxyXG5cdFx0XHRcdGNvbG9yLmFkZCggX2xpZ2h0Q29sb3IubXVsdGlwbHlTY2FsYXIoIGFtb3VudCApICk7XHJcblxyXG5cdFx0XHR9IGVsc2UgaWYgKCBsaWdodCBpbnN0YW5jZW9mIFRIUkVFLlBvaW50TGlnaHQgKSB7XHJcblxyXG5cdFx0XHRcdHZhciBsaWdodFBvc2l0aW9uID0gX3ZlY3RvcjMuc2V0RnJvbU1hdHJpeFBvc2l0aW9uKCBsaWdodC5tYXRyaXhXb3JsZCApO1xyXG5cclxuXHRcdFx0XHR2YXIgYW1vdW50ID0gbm9ybWFsLmRvdCggX3ZlY3RvcjMuc3ViVmVjdG9ycyggbGlnaHRQb3NpdGlvbiwgcG9zaXRpb24gKS5ub3JtYWxpemUoKSApO1xyXG5cclxuXHRcdFx0XHRpZiAoIGFtb3VudCA8PSAwICkgY29udGludWU7XHJcblxyXG5cdFx0XHRcdGFtb3VudCAqPSBsaWdodC5kaXN0YW5jZSA9PSAwID8gMSA6IDEgLSBNYXRoLm1pbiggcG9zaXRpb24uZGlzdGFuY2VUbyggbGlnaHRQb3NpdGlvbiApIC8gbGlnaHQuZGlzdGFuY2UsIDEgKTtcclxuXHJcblx0XHRcdFx0aWYgKCBhbW91bnQgPT0gMCApIGNvbnRpbnVlO1xyXG5cclxuXHRcdFx0XHRhbW91bnQgKj0gbGlnaHQuaW50ZW5zaXR5O1xyXG5cclxuXHRcdFx0XHRjb2xvci5hZGQoIF9saWdodENvbG9yLm11bHRpcGx5U2NhbGFyKCBhbW91bnQgKSApO1xyXG5cclxuXHRcdFx0fVxyXG5cclxuXHRcdH1cclxuXHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiByZW5kZXJTcHJpdGUoIHYxLCBlbGVtZW50LCBtYXRlcmlhbCApIHtcclxuXHJcblx0XHRzZXRPcGFjaXR5KCBtYXRlcmlhbC5vcGFjaXR5ICk7XHJcblx0XHRzZXRCbGVuZGluZyggbWF0ZXJpYWwuYmxlbmRpbmcgKTtcclxuXHJcblx0XHR2YXIgc2NhbGVYID0gZWxlbWVudC5zY2FsZS54ICogX2NhbnZhc1dpZHRoSGFsZjtcclxuXHRcdHZhciBzY2FsZVkgPSBlbGVtZW50LnNjYWxlLnkgKiBfY2FudmFzSGVpZ2h0SGFsZjtcclxuXHJcblx0XHR2YXIgZGlzdCA9IDAuNSAqIE1hdGguc3FydCggc2NhbGVYICogc2NhbGVYICsgc2NhbGVZICogc2NhbGVZICk7IC8vIGFsbG93IGZvciByb3RhdGVkIHNwcml0ZVxyXG5cdFx0X2VsZW1Cb3gubWluLnNldCggdjEueCAtIGRpc3QsIHYxLnkgLSBkaXN0ICk7XHJcblx0XHRfZWxlbUJveC5tYXguc2V0KCB2MS54ICsgZGlzdCwgdjEueSArIGRpc3QgKTtcclxuXHJcblx0XHRpZiAoIG1hdGVyaWFsIGluc3RhbmNlb2YgVEhSRUUuU3ByaXRlTWF0ZXJpYWwgKSB7XHJcblxyXG5cdFx0XHR2YXIgdGV4dHVyZSA9IG1hdGVyaWFsLm1hcDtcclxuXHJcblx0XHRcdGlmICggdGV4dHVyZSAhPT0gbnVsbCApIHtcclxuXHJcblx0XHRcdFx0dmFyIHBhdHRlcm4gPSBfcGF0dGVybnNbIHRleHR1cmUuaWQgXTtcclxuXHJcblx0XHRcdFx0aWYgKCBwYXR0ZXJuID09PSB1bmRlZmluZWQgfHwgcGF0dGVybi52ZXJzaW9uICE9PSB0ZXh0dXJlLnZlcnNpb24gKSB7XHJcblxyXG5cdFx0XHRcdFx0cGF0dGVybiA9IHRleHR1cmVUb1BhdHRlcm4oIHRleHR1cmUgKTtcclxuXHRcdFx0XHRcdF9wYXR0ZXJuc1sgdGV4dHVyZS5pZCBdID0gcGF0dGVybjtcclxuXHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRpZiAoIHBhdHRlcm4uY2FudmFzICE9PSB1bmRlZmluZWQgKSB7XHJcblxyXG5cdFx0XHRcdFx0c2V0RmlsbFN0eWxlKCBwYXR0ZXJuLmNhbnZhcyApO1xyXG5cclxuXHRcdFx0XHRcdHZhciBiaXRtYXAgPSB0ZXh0dXJlLmltYWdlO1xyXG5cclxuXHRcdFx0XHRcdHZhciBveCA9IGJpdG1hcC53aWR0aCAqIHRleHR1cmUub2Zmc2V0Lng7XHJcblx0XHRcdFx0XHR2YXIgb3kgPSBiaXRtYXAuaGVpZ2h0ICogdGV4dHVyZS5vZmZzZXQueTtcclxuXHJcblx0XHRcdFx0XHR2YXIgc3ggPSBiaXRtYXAud2lkdGggKiB0ZXh0dXJlLnJlcGVhdC54O1xyXG5cdFx0XHRcdFx0dmFyIHN5ID0gYml0bWFwLmhlaWdodCAqIHRleHR1cmUucmVwZWF0Lnk7XHJcblxyXG5cdFx0XHRcdFx0dmFyIGN4ID0gc2NhbGVYIC8gc3g7XHJcblx0XHRcdFx0XHR2YXIgY3kgPSBzY2FsZVkgLyBzeTtcclxuXHJcblx0XHRcdFx0XHRfY29udGV4dC5zYXZlKCk7XHJcblx0XHRcdFx0XHRfY29udGV4dC50cmFuc2xhdGUoIHYxLngsIHYxLnkgKTtcclxuXHRcdFx0XHRcdGlmICggbWF0ZXJpYWwucm90YXRpb24gIT09IDAgKSBfY29udGV4dC5yb3RhdGUoIG1hdGVyaWFsLnJvdGF0aW9uICk7XHJcblx0XHRcdFx0XHRfY29udGV4dC50cmFuc2xhdGUoIC0gc2NhbGVYIC8gMiwgLSBzY2FsZVkgLyAyICk7XHJcblx0XHRcdFx0XHRfY29udGV4dC5zY2FsZSggY3gsIGN5ICk7XHJcblx0XHRcdFx0XHRfY29udGV4dC50cmFuc2xhdGUoIC0gb3gsIC0gb3kgKTtcclxuXHRcdFx0XHRcdF9jb250ZXh0LmZpbGxSZWN0KCBveCwgb3ksIHN4LCBzeSApO1xyXG5cdFx0XHRcdFx0X2NvbnRleHQucmVzdG9yZSgpO1xyXG5cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cclxuXHRcdFx0XHQvLyBubyB0ZXh0dXJlXHJcblxyXG5cdFx0XHRcdHNldEZpbGxTdHlsZSggbWF0ZXJpYWwuY29sb3IuZ2V0U3R5bGUoKSApO1xyXG5cclxuXHRcdFx0XHRfY29udGV4dC5zYXZlKCk7XHJcblx0XHRcdFx0X2NvbnRleHQudHJhbnNsYXRlKCB2MS54LCB2MS55ICk7XHJcblx0XHRcdFx0aWYgKCBtYXRlcmlhbC5yb3RhdGlvbiAhPT0gMCApIF9jb250ZXh0LnJvdGF0ZSggbWF0ZXJpYWwucm90YXRpb24gKTtcclxuXHRcdFx0XHRfY29udGV4dC5zY2FsZSggc2NhbGVYLCAtIHNjYWxlWSApO1xyXG5cdFx0XHRcdF9jb250ZXh0LmZpbGxSZWN0KCAtIDAuNSwgLSAwLjUsIDEsIDEgKTtcclxuXHRcdFx0XHRfY29udGV4dC5yZXN0b3JlKCk7XHJcblxyXG5cdFx0XHR9XHJcblxyXG5cdFx0fSBlbHNlIGlmICggbWF0ZXJpYWwgaW5zdGFuY2VvZiBUSFJFRS5TcHJpdGVDYW52YXNNYXRlcmlhbCApIHtcclxuXHJcblx0XHRcdHNldFN0cm9rZVN0eWxlKCBtYXRlcmlhbC5jb2xvci5nZXRTdHlsZSgpICk7XHJcblx0XHRcdHNldEZpbGxTdHlsZSggbWF0ZXJpYWwuY29sb3IuZ2V0U3R5bGUoKSApO1xyXG5cclxuXHRcdFx0X2NvbnRleHQuc2F2ZSgpO1xyXG5cdFx0XHRfY29udGV4dC50cmFuc2xhdGUoIHYxLngsIHYxLnkgKTtcclxuXHRcdFx0aWYgKCBtYXRlcmlhbC5yb3RhdGlvbiAhPT0gMCApIF9jb250ZXh0LnJvdGF0ZSggbWF0ZXJpYWwucm90YXRpb24gKTtcclxuXHRcdFx0X2NvbnRleHQuc2NhbGUoIHNjYWxlWCwgc2NhbGVZICk7XHJcblxyXG5cdFx0XHRtYXRlcmlhbC5wcm9ncmFtKCBfY29udGV4dCApO1xyXG5cclxuXHRcdFx0X2NvbnRleHQucmVzdG9yZSgpO1xyXG5cclxuXHRcdH1cclxuXHJcblx0XHQvKiBERUJVR1xyXG5cdFx0c2V0U3Ryb2tlU3R5bGUoICdyZ2IoMjU1LDI1NSwwKScgKTtcclxuXHRcdF9jb250ZXh0LmJlZ2luUGF0aCgpO1xyXG5cdFx0X2NvbnRleHQubW92ZVRvKCB2MS54IC0gMTAsIHYxLnkgKTtcclxuXHRcdF9jb250ZXh0LmxpbmVUbyggdjEueCArIDEwLCB2MS55ICk7XHJcblx0XHRfY29udGV4dC5tb3ZlVG8oIHYxLngsIHYxLnkgLSAxMCApO1xyXG5cdFx0X2NvbnRleHQubGluZVRvKCB2MS54LCB2MS55ICsgMTAgKTtcclxuXHRcdF9jb250ZXh0LnN0cm9rZSgpO1xyXG5cdFx0Ki9cclxuXHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiByZW5kZXJMaW5lKCB2MSwgdjIsIGVsZW1lbnQsIG1hdGVyaWFsICkge1xyXG5cclxuXHRcdHNldE9wYWNpdHkoIG1hdGVyaWFsLm9wYWNpdHkgKTtcclxuXHRcdHNldEJsZW5kaW5nKCBtYXRlcmlhbC5ibGVuZGluZyApO1xyXG5cclxuXHRcdF9jb250ZXh0LmJlZ2luUGF0aCgpO1xyXG5cdFx0X2NvbnRleHQubW92ZVRvKCB2MS5wb3NpdGlvblNjcmVlbi54LCB2MS5wb3NpdGlvblNjcmVlbi55ICk7XHJcblx0XHRfY29udGV4dC5saW5lVG8oIHYyLnBvc2l0aW9uU2NyZWVuLngsIHYyLnBvc2l0aW9uU2NyZWVuLnkgKTtcclxuXHJcblx0XHRpZiAoIG1hdGVyaWFsIGluc3RhbmNlb2YgVEhSRUUuTGluZUJhc2ljTWF0ZXJpYWwgKSB7XHJcblxyXG5cdFx0XHRzZXRMaW5lV2lkdGgoIG1hdGVyaWFsLmxpbmV3aWR0aCApO1xyXG5cdFx0XHRzZXRMaW5lQ2FwKCBtYXRlcmlhbC5saW5lY2FwICk7XHJcblx0XHRcdHNldExpbmVKb2luKCBtYXRlcmlhbC5saW5lam9pbiApO1xyXG5cclxuXHRcdFx0aWYgKCBtYXRlcmlhbC52ZXJ0ZXhDb2xvcnMgIT09IFRIUkVFLlZlcnRleENvbG9ycyApIHtcclxuXHJcblx0XHRcdFx0c2V0U3Ryb2tlU3R5bGUoIG1hdGVyaWFsLmNvbG9yLmdldFN0eWxlKCkgKTtcclxuXHJcblx0XHRcdH0gZWxzZSB7XHJcblxyXG5cdFx0XHRcdHZhciBjb2xvclN0eWxlMSA9IGVsZW1lbnQudmVydGV4Q29sb3JzWyAwIF0uZ2V0U3R5bGUoKTtcclxuXHRcdFx0XHR2YXIgY29sb3JTdHlsZTIgPSBlbGVtZW50LnZlcnRleENvbG9yc1sgMSBdLmdldFN0eWxlKCk7XHJcblxyXG5cdFx0XHRcdGlmICggY29sb3JTdHlsZTEgPT09IGNvbG9yU3R5bGUyICkge1xyXG5cclxuXHRcdFx0XHRcdHNldFN0cm9rZVN0eWxlKCBjb2xvclN0eWxlMSApO1xyXG5cclxuXHRcdFx0XHR9IGVsc2Uge1xyXG5cclxuXHRcdFx0XHRcdHRyeSB7XHJcblxyXG5cdFx0XHRcdFx0XHR2YXIgZ3JhZCA9IF9jb250ZXh0LmNyZWF0ZUxpbmVhckdyYWRpZW50KFxyXG5cdFx0XHRcdFx0XHRcdHYxLnBvc2l0aW9uU2NyZWVuLngsXHJcblx0XHRcdFx0XHRcdFx0djEucG9zaXRpb25TY3JlZW4ueSxcclxuXHRcdFx0XHRcdFx0XHR2Mi5wb3NpdGlvblNjcmVlbi54LFxyXG5cdFx0XHRcdFx0XHRcdHYyLnBvc2l0aW9uU2NyZWVuLnlcclxuXHRcdFx0XHRcdFx0KTtcclxuXHRcdFx0XHRcdFx0Z3JhZC5hZGRDb2xvclN0b3AoIDAsIGNvbG9yU3R5bGUxICk7XHJcblx0XHRcdFx0XHRcdGdyYWQuYWRkQ29sb3JTdG9wKCAxLCBjb2xvclN0eWxlMiApO1xyXG5cclxuXHRcdFx0XHRcdH0gY2F0Y2ggKCBleGNlcHRpb24gKSB7XHJcblxyXG5cdFx0XHRcdFx0XHRncmFkID0gY29sb3JTdHlsZTE7XHJcblxyXG5cdFx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRcdHNldFN0cm9rZVN0eWxlKCBncmFkICk7XHJcblxyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdH1cclxuXHJcblx0XHRcdF9jb250ZXh0LnN0cm9rZSgpO1xyXG5cdFx0XHRfZWxlbUJveC5leHBhbmRCeVNjYWxhciggbWF0ZXJpYWwubGluZXdpZHRoICogMiApO1xyXG5cclxuXHRcdH0gZWxzZSBpZiAoIG1hdGVyaWFsIGluc3RhbmNlb2YgVEhSRUUuTGluZURhc2hlZE1hdGVyaWFsICkge1xyXG5cclxuXHRcdFx0c2V0TGluZVdpZHRoKCBtYXRlcmlhbC5saW5ld2lkdGggKTtcclxuXHRcdFx0c2V0TGluZUNhcCggbWF0ZXJpYWwubGluZWNhcCApO1xyXG5cdFx0XHRzZXRMaW5lSm9pbiggbWF0ZXJpYWwubGluZWpvaW4gKTtcclxuXHRcdFx0c2V0U3Ryb2tlU3R5bGUoIG1hdGVyaWFsLmNvbG9yLmdldFN0eWxlKCkgKTtcclxuXHRcdFx0c2V0TGluZURhc2goIFsgbWF0ZXJpYWwuZGFzaFNpemUsIG1hdGVyaWFsLmdhcFNpemUgXSApO1xyXG5cclxuXHRcdFx0X2NvbnRleHQuc3Ryb2tlKCk7XHJcblxyXG5cdFx0XHRfZWxlbUJveC5leHBhbmRCeVNjYWxhciggbWF0ZXJpYWwubGluZXdpZHRoICogMiApO1xyXG5cclxuXHRcdFx0c2V0TGluZURhc2goIFtdICk7XHJcblxyXG5cdFx0fVxyXG5cclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHJlbmRlckZhY2UzKCB2MSwgdjIsIHYzLCB1djEsIHV2MiwgdXYzLCBlbGVtZW50LCBtYXRlcmlhbCApIHtcclxuXHJcblx0XHRfdGhpcy5pbmZvLnJlbmRlci52ZXJ0aWNlcyArPSAzO1xyXG5cdFx0X3RoaXMuaW5mby5yZW5kZXIuZmFjZXMgKys7XHJcblxyXG5cdFx0c2V0T3BhY2l0eSggbWF0ZXJpYWwub3BhY2l0eSApO1xyXG5cdFx0c2V0QmxlbmRpbmcoIG1hdGVyaWFsLmJsZW5kaW5nICk7XHJcblxyXG5cdFx0X3YxeCA9IHYxLnBvc2l0aW9uU2NyZWVuLng7IF92MXkgPSB2MS5wb3NpdGlvblNjcmVlbi55O1xyXG5cdFx0X3YyeCA9IHYyLnBvc2l0aW9uU2NyZWVuLng7IF92MnkgPSB2Mi5wb3NpdGlvblNjcmVlbi55O1xyXG5cdFx0X3YzeCA9IHYzLnBvc2l0aW9uU2NyZWVuLng7IF92M3kgPSB2My5wb3NpdGlvblNjcmVlbi55O1xyXG5cclxuXHRcdGRyYXdUcmlhbmdsZSggX3YxeCwgX3YxeSwgX3YyeCwgX3YyeSwgX3YzeCwgX3YzeSApO1xyXG5cclxuXHRcdGlmICggKCBtYXRlcmlhbCBpbnN0YW5jZW9mIFRIUkVFLk1lc2hMYW1iZXJ0TWF0ZXJpYWwgfHwgbWF0ZXJpYWwgaW5zdGFuY2VvZiBUSFJFRS5NZXNoUGhvbmdNYXRlcmlhbCApICYmIG1hdGVyaWFsLm1hcCA9PT0gbnVsbCApIHtcclxuXHJcblx0XHRcdF9kaWZmdXNlQ29sb3IuY29weSggbWF0ZXJpYWwuY29sb3IgKTtcclxuXHRcdFx0X2VtaXNzaXZlQ29sb3IuY29weSggbWF0ZXJpYWwuZW1pc3NpdmUgKTtcclxuXHJcblx0XHRcdGlmICggbWF0ZXJpYWwudmVydGV4Q29sb3JzID09PSBUSFJFRS5GYWNlQ29sb3JzICkge1xyXG5cclxuXHRcdFx0XHRfZGlmZnVzZUNvbG9yLm11bHRpcGx5KCBlbGVtZW50LmNvbG9yICk7XHJcblxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRfY29sb3IuY29weSggX2FtYmllbnRMaWdodCApO1xyXG5cclxuXHRcdFx0X2NlbnRyb2lkLmNvcHkoIHYxLnBvc2l0aW9uV29ybGQgKS5hZGQoIHYyLnBvc2l0aW9uV29ybGQgKS5hZGQoIHYzLnBvc2l0aW9uV29ybGQgKS5kaXZpZGVTY2FsYXIoIDMgKTtcclxuXHJcblx0XHRcdGNhbGN1bGF0ZUxpZ2h0KCBfY2VudHJvaWQsIGVsZW1lbnQubm9ybWFsTW9kZWwsIF9jb2xvciApO1xyXG5cclxuXHRcdFx0X2NvbG9yLm11bHRpcGx5KCBfZGlmZnVzZUNvbG9yICkuYWRkKCBfZW1pc3NpdmVDb2xvciApO1xyXG5cclxuXHRcdFx0bWF0ZXJpYWwud2lyZWZyYW1lID09PSB0cnVlXHJcblx0XHRcdFx0ID8gc3Ryb2tlUGF0aCggX2NvbG9yLCBtYXRlcmlhbC53aXJlZnJhbWVMaW5ld2lkdGgsIG1hdGVyaWFsLndpcmVmcmFtZUxpbmVjYXAsIG1hdGVyaWFsLndpcmVmcmFtZUxpbmVqb2luIClcclxuXHRcdFx0XHQgOiBmaWxsUGF0aCggX2NvbG9yICk7XHJcblxyXG5cdFx0fSBlbHNlIGlmICggbWF0ZXJpYWwgaW5zdGFuY2VvZiBUSFJFRS5NZXNoQmFzaWNNYXRlcmlhbCB8fFxyXG5cdFx0XHRcdCAgICBtYXRlcmlhbCBpbnN0YW5jZW9mIFRIUkVFLk1lc2hMYW1iZXJ0TWF0ZXJpYWwgfHxcclxuXHRcdFx0XHQgICAgbWF0ZXJpYWwgaW5zdGFuY2VvZiBUSFJFRS5NZXNoUGhvbmdNYXRlcmlhbCApIHtcclxuXHJcblx0XHRcdGlmICggbWF0ZXJpYWwubWFwICE9PSBudWxsICkge1xyXG5cclxuXHRcdFx0XHR2YXIgbWFwcGluZyA9IG1hdGVyaWFsLm1hcC5tYXBwaW5nO1xyXG5cclxuXHRcdFx0XHRpZiAoIG1hcHBpbmcgPT09IFRIUkVFLlVWTWFwcGluZyApIHtcclxuXHJcblx0XHRcdFx0XHRfdXZzID0gZWxlbWVudC51dnM7XHJcblx0XHRcdFx0XHRwYXR0ZXJuUGF0aCggX3YxeCwgX3YxeSwgX3YyeCwgX3YyeSwgX3YzeCwgX3YzeSwgX3V2c1sgdXYxIF0ueCwgX3V2c1sgdXYxIF0ueSwgX3V2c1sgdXYyIF0ueCwgX3V2c1sgdXYyIF0ueSwgX3V2c1sgdXYzIF0ueCwgX3V2c1sgdXYzIF0ueSwgbWF0ZXJpYWwubWFwICk7XHJcblxyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdH0gZWxzZSBpZiAoIG1hdGVyaWFsLmVudk1hcCAhPT0gbnVsbCApIHtcclxuXHJcblx0XHRcdFx0aWYgKCBtYXRlcmlhbC5lbnZNYXAubWFwcGluZyA9PT0gVEhSRUUuU3BoZXJpY2FsUmVmbGVjdGlvbk1hcHBpbmcgKSB7XHJcblxyXG5cdFx0XHRcdFx0X25vcm1hbC5jb3B5KCBlbGVtZW50LnZlcnRleE5vcm1hbHNNb2RlbFsgdXYxIF0gKS5hcHBseU1hdHJpeDMoIF9ub3JtYWxWaWV3TWF0cml4ICk7XHJcblx0XHRcdFx0XHRfdXYxeCA9IDAuNSAqIF9ub3JtYWwueCArIDAuNTtcclxuXHRcdFx0XHRcdF91djF5ID0gMC41ICogX25vcm1hbC55ICsgMC41O1xyXG5cclxuXHRcdFx0XHRcdF9ub3JtYWwuY29weSggZWxlbWVudC52ZXJ0ZXhOb3JtYWxzTW9kZWxbIHV2MiBdICkuYXBwbHlNYXRyaXgzKCBfbm9ybWFsVmlld01hdHJpeCApO1xyXG5cdFx0XHRcdFx0X3V2MnggPSAwLjUgKiBfbm9ybWFsLnggKyAwLjU7XHJcblx0XHRcdFx0XHRfdXYyeSA9IDAuNSAqIF9ub3JtYWwueSArIDAuNTtcclxuXHJcblx0XHRcdFx0XHRfbm9ybWFsLmNvcHkoIGVsZW1lbnQudmVydGV4Tm9ybWFsc01vZGVsWyB1djMgXSApLmFwcGx5TWF0cml4MyggX25vcm1hbFZpZXdNYXRyaXggKTtcclxuXHRcdFx0XHRcdF91djN4ID0gMC41ICogX25vcm1hbC54ICsgMC41O1xyXG5cdFx0XHRcdFx0X3V2M3kgPSAwLjUgKiBfbm9ybWFsLnkgKyAwLjU7XHJcblxyXG5cdFx0XHRcdFx0cGF0dGVyblBhdGgoIF92MXgsIF92MXksIF92MngsIF92MnksIF92M3gsIF92M3ksIF91djF4LCBfdXYxeSwgX3V2MngsIF91djJ5LCBfdXYzeCwgX3V2M3ksIG1hdGVyaWFsLmVudk1hcCApO1xyXG5cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cclxuXHRcdFx0XHRfY29sb3IuY29weSggbWF0ZXJpYWwuY29sb3IgKTtcclxuXHJcblx0XHRcdFx0aWYgKCBtYXRlcmlhbC52ZXJ0ZXhDb2xvcnMgPT09IFRIUkVFLkZhY2VDb2xvcnMgKSB7XHJcblxyXG5cdFx0XHRcdFx0X2NvbG9yLm11bHRpcGx5KCBlbGVtZW50LmNvbG9yICk7XHJcblxyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0bWF0ZXJpYWwud2lyZWZyYW1lID09PSB0cnVlXHJcblx0XHRcdFx0XHQgPyBzdHJva2VQYXRoKCBfY29sb3IsIG1hdGVyaWFsLndpcmVmcmFtZUxpbmV3aWR0aCwgbWF0ZXJpYWwud2lyZWZyYW1lTGluZWNhcCwgbWF0ZXJpYWwud2lyZWZyYW1lTGluZWpvaW4gKVxyXG5cdFx0XHRcdFx0IDogZmlsbFBhdGgoIF9jb2xvciApO1xyXG5cclxuXHRcdFx0fVxyXG5cclxuXHRcdH0gZWxzZSBpZiAoIG1hdGVyaWFsIGluc3RhbmNlb2YgVEhSRUUuTWVzaE5vcm1hbE1hdGVyaWFsICkge1xyXG5cclxuXHRcdFx0X25vcm1hbC5jb3B5KCBlbGVtZW50Lm5vcm1hbE1vZGVsICkuYXBwbHlNYXRyaXgzKCBfbm9ybWFsVmlld01hdHJpeCApO1xyXG5cclxuXHRcdFx0X2NvbG9yLnNldFJHQiggX25vcm1hbC54LCBfbm9ybWFsLnksIF9ub3JtYWwueiApLm11bHRpcGx5U2NhbGFyKCAwLjUgKS5hZGRTY2FsYXIoIDAuNSApO1xyXG5cclxuXHRcdFx0bWF0ZXJpYWwud2lyZWZyYW1lID09PSB0cnVlXHJcblx0XHRcdFx0ID8gc3Ryb2tlUGF0aCggX2NvbG9yLCBtYXRlcmlhbC53aXJlZnJhbWVMaW5ld2lkdGgsIG1hdGVyaWFsLndpcmVmcmFtZUxpbmVjYXAsIG1hdGVyaWFsLndpcmVmcmFtZUxpbmVqb2luIClcclxuXHRcdFx0XHQgOiBmaWxsUGF0aCggX2NvbG9yICk7XHJcblxyXG5cdFx0fSBlbHNlIHtcclxuXHJcblx0XHRcdF9jb2xvci5zZXRSR0IoIDEsIDEsIDEgKTtcclxuXHJcblx0XHRcdG1hdGVyaWFsLndpcmVmcmFtZSA9PT0gdHJ1ZVxyXG5cdFx0XHRcdCA/IHN0cm9rZVBhdGgoIF9jb2xvciwgbWF0ZXJpYWwud2lyZWZyYW1lTGluZXdpZHRoLCBtYXRlcmlhbC53aXJlZnJhbWVMaW5lY2FwLCBtYXRlcmlhbC53aXJlZnJhbWVMaW5lam9pbiApXHJcblx0XHRcdFx0IDogZmlsbFBhdGgoIF9jb2xvciApO1xyXG5cclxuXHRcdH1cclxuXHJcblx0fVxyXG5cclxuXHQvL1xyXG5cclxuXHRmdW5jdGlvbiBkcmF3VHJpYW5nbGUoIHgwLCB5MCwgeDEsIHkxLCB4MiwgeTIgKSB7XHJcblxyXG5cdFx0X2NvbnRleHQuYmVnaW5QYXRoKCk7XHJcblx0XHRfY29udGV4dC5tb3ZlVG8oIHgwLCB5MCApO1xyXG5cdFx0X2NvbnRleHQubGluZVRvKCB4MSwgeTEgKTtcclxuXHRcdF9jb250ZXh0LmxpbmVUbyggeDIsIHkyICk7XHJcblx0XHRfY29udGV4dC5jbG9zZVBhdGgoKTtcclxuXHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBzdHJva2VQYXRoKCBjb2xvciwgbGluZXdpZHRoLCBsaW5lY2FwLCBsaW5lam9pbiApIHtcclxuXHJcblx0XHRzZXRMaW5lV2lkdGgoIGxpbmV3aWR0aCApO1xyXG5cdFx0c2V0TGluZUNhcCggbGluZWNhcCApO1xyXG5cdFx0c2V0TGluZUpvaW4oIGxpbmVqb2luICk7XHJcblx0XHRzZXRTdHJva2VTdHlsZSggY29sb3IuZ2V0U3R5bGUoKSApO1xyXG5cclxuXHRcdF9jb250ZXh0LnN0cm9rZSgpO1xyXG5cclxuXHRcdF9lbGVtQm94LmV4cGFuZEJ5U2NhbGFyKCBsaW5ld2lkdGggKiAyICk7XHJcblxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gZmlsbFBhdGgoIGNvbG9yICkge1xyXG5cclxuXHRcdHNldEZpbGxTdHlsZSggY29sb3IuZ2V0U3R5bGUoKSApO1xyXG5cdFx0X2NvbnRleHQuZmlsbCgpO1xyXG5cclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHRleHR1cmVUb1BhdHRlcm4oIHRleHR1cmUgKSB7XHJcblxyXG5cdFx0aWYgKCB0ZXh0dXJlLnZlcnNpb24gPT09IDAgfHxcclxuXHRcdFx0dGV4dHVyZSBpbnN0YW5jZW9mIFRIUkVFLkNvbXByZXNzZWRUZXh0dXJlIHx8XHJcblx0XHRcdHRleHR1cmUgaW5zdGFuY2VvZiBUSFJFRS5EYXRhVGV4dHVyZSApIHtcclxuXHJcblx0XHRcdHJldHVybiB7XHJcblx0XHRcdFx0Y2FudmFzOiB1bmRlZmluZWQsXHJcblx0XHRcdFx0dmVyc2lvbjogdGV4dHVyZS52ZXJzaW9uXHJcblx0XHRcdH07XHJcblxyXG5cdFx0fVxyXG5cclxuXHRcdHZhciBpbWFnZSA9IHRleHR1cmUuaW1hZ2U7XHJcblxyXG5cdFx0aWYgKCBpbWFnZS5jb21wbGV0ZSA9PT0gZmFsc2UgKSB7XHJcblxyXG5cdFx0XHRyZXR1cm4ge1xyXG5cdFx0XHRcdGNhbnZhczogdW5kZWZpbmVkLFxyXG5cdFx0XHRcdHZlcnNpb246IDBcclxuXHRcdFx0fTtcclxuXHJcblx0XHR9XHJcblxyXG5cdFx0dmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdjYW52YXMnICk7XHJcblx0XHRjYW52YXMud2lkdGggPSBpbWFnZS53aWR0aDtcclxuXHRcdGNhbnZhcy5oZWlnaHQgPSBpbWFnZS5oZWlnaHQ7XHJcblxyXG5cdFx0dmFyIGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCggJzJkJyApO1xyXG5cdFx0Y29udGV4dC5zZXRUcmFuc2Zvcm0oIDEsIDAsIDAsIC0gMSwgMCwgaW1hZ2UuaGVpZ2h0ICk7XHJcblx0XHRjb250ZXh0LmRyYXdJbWFnZSggaW1hZ2UsIDAsIDAgKTtcclxuXHJcblx0XHR2YXIgcmVwZWF0WCA9IHRleHR1cmUud3JhcFMgPT09IFRIUkVFLlJlcGVhdFdyYXBwaW5nO1xyXG5cdFx0dmFyIHJlcGVhdFkgPSB0ZXh0dXJlLndyYXBUID09PSBUSFJFRS5SZXBlYXRXcmFwcGluZztcclxuXHJcblx0XHR2YXIgcmVwZWF0ID0gJ25vLXJlcGVhdCc7XHJcblxyXG5cdFx0aWYgKCByZXBlYXRYID09PSB0cnVlICYmIHJlcGVhdFkgPT09IHRydWUgKSB7XHJcblxyXG5cdFx0XHRyZXBlYXQgPSAncmVwZWF0JztcclxuXHJcblx0XHR9IGVsc2UgaWYgKCByZXBlYXRYID09PSB0cnVlICkge1xyXG5cclxuXHRcdFx0cmVwZWF0ID0gJ3JlcGVhdC14JztcclxuXHJcblx0XHR9IGVsc2UgaWYgKCByZXBlYXRZID09PSB0cnVlICkge1xyXG5cclxuXHRcdFx0cmVwZWF0ID0gJ3JlcGVhdC15JztcclxuXHJcblx0XHR9XHJcblxyXG5cdFx0dmFyIHBhdHRlcm4gPSBfY29udGV4dC5jcmVhdGVQYXR0ZXJuKCBjYW52YXMsIHJlcGVhdCApO1xyXG5cclxuXHRcdGlmICggdGV4dHVyZS5vblVwZGF0ZSApIHRleHR1cmUub25VcGRhdGUoIHRleHR1cmUgKTtcclxuXHJcblx0XHRyZXR1cm4ge1xyXG5cdFx0XHRjYW52YXM6IHBhdHRlcm4sXHJcblx0XHRcdHZlcnNpb246IHRleHR1cmUudmVyc2lvblxyXG5cdFx0fTtcclxuXHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBwYXR0ZXJuUGF0aCggeDAsIHkwLCB4MSwgeTEsIHgyLCB5MiwgdTAsIHYwLCB1MSwgdjEsIHUyLCB2MiwgdGV4dHVyZSApIHtcclxuXHJcblx0XHR2YXIgcGF0dGVybiA9IF9wYXR0ZXJuc1sgdGV4dHVyZS5pZCBdO1xyXG5cclxuXHRcdGlmICggcGF0dGVybiA9PT0gdW5kZWZpbmVkIHx8IHBhdHRlcm4udmVyc2lvbiAhPT0gdGV4dHVyZS52ZXJzaW9uICkge1xyXG5cclxuXHRcdFx0cGF0dGVybiA9IHRleHR1cmVUb1BhdHRlcm4oIHRleHR1cmUgKTtcclxuXHRcdFx0X3BhdHRlcm5zWyB0ZXh0dXJlLmlkIF0gPSBwYXR0ZXJuO1xyXG5cclxuXHRcdH1cclxuXHJcblx0XHRpZiAoIHBhdHRlcm4uY2FudmFzICE9PSB1bmRlZmluZWQgKSB7XHJcblxyXG5cdFx0XHRzZXRGaWxsU3R5bGUoIHBhdHRlcm4uY2FudmFzICk7XHJcblxyXG5cdFx0fSBlbHNlIHtcclxuXHJcblx0XHRcdHNldEZpbGxTdHlsZSggJ3JnYmEoIDAsIDAsIDAsIDEpJyApO1xyXG5cdFx0XHRfY29udGV4dC5maWxsKCk7XHJcblx0XHRcdHJldHVybjtcclxuXHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gaHR0cDovL2V4dHJlbWVseXNhdGlzZmFjdG9yeXRvdGFsaXRhcmlhbmlzbS5jb20vYmxvZy8/cD0yMTIwXHJcblxyXG5cdFx0dmFyIGEsIGIsIGMsIGQsIGUsIGYsIGRldCwgaWRldCxcclxuXHRcdG9mZnNldFggPSB0ZXh0dXJlLm9mZnNldC54IC8gdGV4dHVyZS5yZXBlYXQueCxcclxuXHRcdG9mZnNldFkgPSB0ZXh0dXJlLm9mZnNldC55IC8gdGV4dHVyZS5yZXBlYXQueSxcclxuXHRcdHdpZHRoID0gdGV4dHVyZS5pbWFnZS53aWR0aCAqIHRleHR1cmUucmVwZWF0LngsXHJcblx0XHRoZWlnaHQgPSB0ZXh0dXJlLmltYWdlLmhlaWdodCAqIHRleHR1cmUucmVwZWF0Lnk7XHJcblxyXG5cdFx0dTAgPSAoIHUwICsgb2Zmc2V0WCApICogd2lkdGg7XHJcblx0XHR2MCA9ICggdjAgKyBvZmZzZXRZICkgKiBoZWlnaHQ7XHJcblxyXG5cdFx0dTEgPSAoIHUxICsgb2Zmc2V0WCApICogd2lkdGg7XHJcblx0XHR2MSA9ICggdjEgKyBvZmZzZXRZICkgKiBoZWlnaHQ7XHJcblxyXG5cdFx0dTIgPSAoIHUyICsgb2Zmc2V0WCApICogd2lkdGg7XHJcblx0XHR2MiA9ICggdjIgKyBvZmZzZXRZICkgKiBoZWlnaHQ7XHJcblxyXG5cdFx0eDEgLT0geDA7IHkxIC09IHkwO1xyXG5cdFx0eDIgLT0geDA7IHkyIC09IHkwO1xyXG5cclxuXHRcdHUxIC09IHUwOyB2MSAtPSB2MDtcclxuXHRcdHUyIC09IHUwOyB2MiAtPSB2MDtcclxuXHJcblx0XHRkZXQgPSB1MSAqIHYyIC0gdTIgKiB2MTtcclxuXHJcblx0XHRpZiAoIGRldCA9PT0gMCApIHJldHVybjtcclxuXHJcblx0XHRpZGV0ID0gMSAvIGRldDtcclxuXHJcblx0XHRhID0gKCB2MiAqIHgxIC0gdjEgKiB4MiApICogaWRldDtcclxuXHRcdGIgPSAoIHYyICogeTEgLSB2MSAqIHkyICkgKiBpZGV0O1xyXG5cdFx0YyA9ICggdTEgKiB4MiAtIHUyICogeDEgKSAqIGlkZXQ7XHJcblx0XHRkID0gKCB1MSAqIHkyIC0gdTIgKiB5MSApICogaWRldDtcclxuXHJcblx0XHRlID0geDAgLSBhICogdTAgLSBjICogdjA7XHJcblx0XHRmID0geTAgLSBiICogdTAgLSBkICogdjA7XHJcblxyXG5cdFx0X2NvbnRleHQuc2F2ZSgpO1xyXG5cdFx0X2NvbnRleHQudHJhbnNmb3JtKCBhLCBiLCBjLCBkLCBlLCBmICk7XHJcblx0XHRfY29udGV4dC5maWxsKCk7XHJcblx0XHRfY29udGV4dC5yZXN0b3JlKCk7XHJcblxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gY2xpcEltYWdlKCB4MCwgeTAsIHgxLCB5MSwgeDIsIHkyLCB1MCwgdjAsIHUxLCB2MSwgdTIsIHYyLCBpbWFnZSApIHtcclxuXHJcblx0XHQvLyBodHRwOi8vZXh0cmVtZWx5c2F0aXNmYWN0b3J5dG90YWxpdGFyaWFuaXNtLmNvbS9ibG9nLz9wPTIxMjBcclxuXHJcblx0XHR2YXIgYSwgYiwgYywgZCwgZSwgZiwgZGV0LCBpZGV0LFxyXG5cdFx0d2lkdGggPSBpbWFnZS53aWR0aCAtIDEsXHJcblx0XHRoZWlnaHQgPSBpbWFnZS5oZWlnaHQgLSAxO1xyXG5cclxuXHRcdHUwICo9IHdpZHRoOyB2MCAqPSBoZWlnaHQ7XHJcblx0XHR1MSAqPSB3aWR0aDsgdjEgKj0gaGVpZ2h0O1xyXG5cdFx0dTIgKj0gd2lkdGg7IHYyICo9IGhlaWdodDtcclxuXHJcblx0XHR4MSAtPSB4MDsgeTEgLT0geTA7XHJcblx0XHR4MiAtPSB4MDsgeTIgLT0geTA7XHJcblxyXG5cdFx0dTEgLT0gdTA7IHYxIC09IHYwO1xyXG5cdFx0dTIgLT0gdTA7IHYyIC09IHYwO1xyXG5cclxuXHRcdGRldCA9IHUxICogdjIgLSB1MiAqIHYxO1xyXG5cclxuXHRcdGlkZXQgPSAxIC8gZGV0O1xyXG5cclxuXHRcdGEgPSAoIHYyICogeDEgLSB2MSAqIHgyICkgKiBpZGV0O1xyXG5cdFx0YiA9ICggdjIgKiB5MSAtIHYxICogeTIgKSAqIGlkZXQ7XHJcblx0XHRjID0gKCB1MSAqIHgyIC0gdTIgKiB4MSApICogaWRldDtcclxuXHRcdGQgPSAoIHUxICogeTIgLSB1MiAqIHkxICkgKiBpZGV0O1xyXG5cclxuXHRcdGUgPSB4MCAtIGEgKiB1MCAtIGMgKiB2MDtcclxuXHRcdGYgPSB5MCAtIGIgKiB1MCAtIGQgKiB2MDtcclxuXHJcblx0XHRfY29udGV4dC5zYXZlKCk7XHJcblx0XHRfY29udGV4dC50cmFuc2Zvcm0oIGEsIGIsIGMsIGQsIGUsIGYgKTtcclxuXHRcdF9jb250ZXh0LmNsaXAoKTtcclxuXHRcdF9jb250ZXh0LmRyYXdJbWFnZSggaW1hZ2UsIDAsIDAgKTtcclxuXHRcdF9jb250ZXh0LnJlc3RvcmUoKTtcclxuXHJcblx0fVxyXG5cclxuXHQvLyBIaWRlIGFudGktYWxpYXMgZ2Fwc1xyXG5cclxuXHRmdW5jdGlvbiBleHBhbmQoIHYxLCB2MiwgcGl4ZWxzICkge1xyXG5cclxuXHRcdHZhciB4ID0gdjIueCAtIHYxLngsIHkgPSB2Mi55IC0gdjEueSxcclxuXHRcdGRldCA9IHggKiB4ICsgeSAqIHksIGlkZXQ7XHJcblxyXG5cdFx0aWYgKCBkZXQgPT09IDAgKSByZXR1cm47XHJcblxyXG5cdFx0aWRldCA9IHBpeGVscyAvIE1hdGguc3FydCggZGV0ICk7XHJcblxyXG5cdFx0eCAqPSBpZGV0OyB5ICo9IGlkZXQ7XHJcblxyXG5cdFx0djIueCArPSB4OyB2Mi55ICs9IHk7XHJcblx0XHR2MS54IC09IHg7IHYxLnkgLT0geTtcclxuXHJcblx0fVxyXG5cclxuXHQvLyBDb250ZXh0IGNhY2hlZCBtZXRob2RzLlxyXG5cclxuXHRmdW5jdGlvbiBzZXRPcGFjaXR5KCB2YWx1ZSApIHtcclxuXHJcblx0XHRpZiAoIF9jb250ZXh0R2xvYmFsQWxwaGEgIT09IHZhbHVlICkge1xyXG5cclxuXHRcdFx0X2NvbnRleHQuZ2xvYmFsQWxwaGEgPSB2YWx1ZTtcclxuXHRcdFx0X2NvbnRleHRHbG9iYWxBbHBoYSA9IHZhbHVlO1xyXG5cclxuXHRcdH1cclxuXHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBzZXRCbGVuZGluZyggdmFsdWUgKSB7XHJcblxyXG5cdFx0aWYgKCBfY29udGV4dEdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiAhPT0gdmFsdWUgKSB7XHJcblxyXG5cdFx0XHRpZiAoIHZhbHVlID09PSBUSFJFRS5Ob3JtYWxCbGVuZGluZyApIHtcclxuXHJcblx0XHRcdFx0X2NvbnRleHQuZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gJ3NvdXJjZS1vdmVyJztcclxuXHJcblx0XHRcdH0gZWxzZSBpZiAoIHZhbHVlID09PSBUSFJFRS5BZGRpdGl2ZUJsZW5kaW5nICkge1xyXG5cclxuXHRcdFx0XHRfY29udGV4dC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb24gPSAnbGlnaHRlcic7XHJcblxyXG5cdFx0XHR9IGVsc2UgaWYgKCB2YWx1ZSA9PT0gVEhSRUUuU3VidHJhY3RpdmVCbGVuZGluZyApIHtcclxuXHJcblx0XHRcdFx0X2NvbnRleHQuZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gJ2Rhcmtlcic7XHJcblxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRfY29udGV4dEdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9IHZhbHVlO1xyXG5cclxuXHRcdH1cclxuXHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBzZXRMaW5lV2lkdGgoIHZhbHVlICkge1xyXG5cclxuXHRcdGlmICggX2NvbnRleHRMaW5lV2lkdGggIT09IHZhbHVlICkge1xyXG5cclxuXHRcdFx0X2NvbnRleHQubGluZVdpZHRoID0gdmFsdWU7XHJcblx0XHRcdF9jb250ZXh0TGluZVdpZHRoID0gdmFsdWU7XHJcblxyXG5cdFx0fVxyXG5cclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHNldExpbmVDYXAoIHZhbHVlICkge1xyXG5cclxuXHRcdC8vIFwiYnV0dFwiLCBcInJvdW5kXCIsIFwic3F1YXJlXCJcclxuXHJcblx0XHRpZiAoIF9jb250ZXh0TGluZUNhcCAhPT0gdmFsdWUgKSB7XHJcblxyXG5cdFx0XHRfY29udGV4dC5saW5lQ2FwID0gdmFsdWU7XHJcblx0XHRcdF9jb250ZXh0TGluZUNhcCA9IHZhbHVlO1xyXG5cclxuXHRcdH1cclxuXHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBzZXRMaW5lSm9pbiggdmFsdWUgKSB7XHJcblxyXG5cdFx0Ly8gXCJyb3VuZFwiLCBcImJldmVsXCIsIFwibWl0ZXJcIlxyXG5cclxuXHRcdGlmICggX2NvbnRleHRMaW5lSm9pbiAhPT0gdmFsdWUgKSB7XHJcblxyXG5cdFx0XHRfY29udGV4dC5saW5lSm9pbiA9IHZhbHVlO1xyXG5cdFx0XHRfY29udGV4dExpbmVKb2luID0gdmFsdWU7XHJcblxyXG5cdFx0fVxyXG5cclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHNldFN0cm9rZVN0eWxlKCB2YWx1ZSApIHtcclxuXHJcblx0XHRpZiAoIF9jb250ZXh0U3Ryb2tlU3R5bGUgIT09IHZhbHVlICkge1xyXG5cclxuXHRcdFx0X2NvbnRleHQuc3Ryb2tlU3R5bGUgPSB2YWx1ZTtcclxuXHRcdFx0X2NvbnRleHRTdHJva2VTdHlsZSA9IHZhbHVlO1xyXG5cclxuXHRcdH1cclxuXHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBzZXRGaWxsU3R5bGUoIHZhbHVlICkge1xyXG5cclxuXHRcdGlmICggX2NvbnRleHRGaWxsU3R5bGUgIT09IHZhbHVlICkge1xyXG5cclxuXHRcdFx0X2NvbnRleHQuZmlsbFN0eWxlID0gdmFsdWU7XHJcblx0XHRcdF9jb250ZXh0RmlsbFN0eWxlID0gdmFsdWU7XHJcblxyXG5cdFx0fVxyXG5cclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHNldExpbmVEYXNoKCB2YWx1ZSApIHtcclxuXHJcblx0XHRpZiAoIF9jb250ZXh0TGluZURhc2gubGVuZ3RoICE9PSB2YWx1ZS5sZW5ndGggKSB7XHJcblxyXG5cdFx0XHRfY29udGV4dC5zZXRMaW5lRGFzaCggdmFsdWUgKTtcclxuXHRcdFx0X2NvbnRleHRMaW5lRGFzaCA9IHZhbHVlO1xyXG5cclxuXHRcdH1cclxuXHJcblx0fVxyXG5cclxufTtcclxuIl19