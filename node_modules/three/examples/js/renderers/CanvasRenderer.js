'use strict';

/**
 * @author mrdoob / http://mrdoob.com/
 */

THREE.SpriteCanvasMaterial = function (parameters) {

		THREE.Material.call(this);

		this.type = 'SpriteCanvasMaterial';

		this.color = new THREE.Color(0xffffff);
		this.program = function (context, color) {};

		this.setValues(parameters);
};

THREE.SpriteCanvasMaterial.prototype = Object.create(THREE.Material.prototype);
THREE.SpriteCanvasMaterial.prototype.constructor = THREE.SpriteCanvasMaterial;

THREE.SpriteCanvasMaterial.prototype.clone = function () {

		var material = new THREE.SpriteCanvasMaterial();

		material.copy(this);
		material.color.copy(this.color);
		material.program = this.program;

		return material;
};

//

THREE.CanvasRenderer = function (parameters) {

		console.log('THREE.CanvasRenderer', THREE.REVISION);

		parameters = parameters || {};

		var _this = this,
		    _renderData,
		    _elements,
		    _lights,
		    _projector = new THREE.Projector(),
		    _canvas = parameters.canvas !== undefined ? parameters.canvas : document.createElement('canvas'),
		    _canvasWidth = _canvas.width,
		    _canvasHeight = _canvas.height,
		    _canvasWidthHalf = Math.floor(_canvasWidth / 2),
		    _canvasHeightHalf = Math.floor(_canvasHeight / 2),
		    _viewportX = 0,
		    _viewportY = 0,
		    _viewportWidth = _canvasWidth,
		    _viewportHeight = _canvasHeight,
		    pixelRatio = 1,
		    _context = _canvas.getContext('2d', {
				alpha: parameters.alpha === true
		}),
		    _clearColor = new THREE.Color(0x000000),
		    _clearAlpha = parameters.alpha === true ? 0 : 1,
		    _contextGlobalAlpha = 1,
		    _contextGlobalCompositeOperation = 0,
		    _contextStrokeStyle = null,
		    _contextFillStyle = null,
		    _contextLineWidth = null,
		    _contextLineCap = null,
		    _contextLineJoin = null,
		    _contextLineDash = [],
		    _camera,
		    _v1,
		    _v2,
		    _v3,
		    _v4,
		    _v5 = new THREE.RenderableVertex(),
		    _v6 = new THREE.RenderableVertex(),
		    _v1x,
		    _v1y,
		    _v2x,
		    _v2y,
		    _v3x,
		    _v3y,
		    _v4x,
		    _v4y,
		    _v5x,
		    _v5y,
		    _v6x,
		    _v6y,
		    _color = new THREE.Color(),
		    _color1 = new THREE.Color(),
		    _color2 = new THREE.Color(),
		    _color3 = new THREE.Color(),
		    _color4 = new THREE.Color(),
		    _diffuseColor = new THREE.Color(),
		    _emissiveColor = new THREE.Color(),
		    _lightColor = new THREE.Color(),
		    _patterns = {},
		    _image,
		    _uvs,
		    _uv1x,
		    _uv1y,
		    _uv2x,
		    _uv2y,
		    _uv3x,
		    _uv3y,
		    _clipBox = new THREE.Box2(),
		    _clearBox = new THREE.Box2(),
		    _elemBox = new THREE.Box2(),
		    _ambientLight = new THREE.Color(),
		    _directionalLights = new THREE.Color(),
		    _pointLights = new THREE.Color(),
		    _vector3 = new THREE.Vector3(),
		    // Needed for PointLight
		_centroid = new THREE.Vector3(),
		    _normal = new THREE.Vector3(),
		    _normalViewMatrix = new THREE.Matrix3();

		// dash+gap fallbacks for Firefox and everything else

		if (_context.setLineDash === undefined) {

				_context.setLineDash = function () {};
		}

		this.domElement = _canvas;

		this.autoClear = true;
		this.sortObjects = true;
		this.sortElements = true;

		this.info = {

				render: {

						vertices: 0,
						faces: 0

				}

		};

		// WebGLRenderer compatibility

		this.supportsVertexTextures = function () {};
		this.setFaceCulling = function () {};

		// API

		this.getContext = function () {

				return _context;
		};

		this.getContextAttributes = function () {

				return _context.getContextAttributes();
		};

		this.getPixelRatio = function () {

				return pixelRatio;
		};

		this.setPixelRatio = function (value) {

				if (value !== undefined) pixelRatio = value;
		};

		this.setSize = function (width, height, updateStyle) {

				_canvasWidth = width * pixelRatio;
				_canvasHeight = height * pixelRatio;

				_canvas.width = _canvasWidth;
				_canvas.height = _canvasHeight;

				_canvasWidthHalf = Math.floor(_canvasWidth / 2);
				_canvasHeightHalf = Math.floor(_canvasHeight / 2);

				if (updateStyle !== false) {

						_canvas.style.width = width + 'px';
						_canvas.style.height = height + 'px';
				}

				_clipBox.min.set(-_canvasWidthHalf, -_canvasHeightHalf);
				_clipBox.max.set(_canvasWidthHalf, _canvasHeightHalf);

				_clearBox.min.set(-_canvasWidthHalf, -_canvasHeightHalf);
				_clearBox.max.set(_canvasWidthHalf, _canvasHeightHalf);

				_contextGlobalAlpha = 1;
				_contextGlobalCompositeOperation = 0;
				_contextStrokeStyle = null;
				_contextFillStyle = null;
				_contextLineWidth = null;
				_contextLineCap = null;
				_contextLineJoin = null;

				this.setViewport(0, 0, width, height);
		};

		this.setViewport = function (x, y, width, height) {

				_viewportX = x * pixelRatio;
				_viewportY = y * pixelRatio;

				_viewportWidth = width * pixelRatio;
				_viewportHeight = height * pixelRatio;
		};

		this.setScissor = function () {};
		this.enableScissorTest = function () {};

		this.setClearColor = function (color, alpha) {

				_clearColor.set(color);
				_clearAlpha = alpha !== undefined ? alpha : 1;

				_clearBox.min.set(-_canvasWidthHalf, -_canvasHeightHalf);
				_clearBox.max.set(_canvasWidthHalf, _canvasHeightHalf);
		};

		this.setClearColorHex = function (hex, alpha) {

				console.warn('THREE.CanvasRenderer: .setClearColorHex() is being removed. Use .setClearColor() instead.');
				this.setClearColor(hex, alpha);
		};

		this.getClearColor = function () {

				return _clearColor;
		};

		this.getClearAlpha = function () {

				return _clearAlpha;
		};

		this.getMaxAnisotropy = function () {

				return 0;
		};

		this.clear = function () {

				if (_clearBox.empty() === false) {

						_clearBox.intersect(_clipBox);
						_clearBox.expandByScalar(2);

						_clearBox.min.x = _clearBox.min.x + _canvasWidthHalf;
						_clearBox.min.y = -_clearBox.min.y + _canvasHeightHalf; // higher y value !
						_clearBox.max.x = _clearBox.max.x + _canvasWidthHalf;
						_clearBox.max.y = -_clearBox.max.y + _canvasHeightHalf; // lower y value !

						if (_clearAlpha < 1) {

								_context.clearRect(_clearBox.min.x | 0, _clearBox.max.y | 0, _clearBox.max.x - _clearBox.min.x | 0, _clearBox.min.y - _clearBox.max.y | 0);
						}

						if (_clearAlpha > 0) {

								setBlending(THREE.NormalBlending);
								setOpacity(1);

								setFillStyle('rgba(' + Math.floor(_clearColor.r * 255) + ',' + Math.floor(_clearColor.g * 255) + ',' + Math.floor(_clearColor.b * 255) + ',' + _clearAlpha + ')');

								_context.fillRect(_clearBox.min.x | 0, _clearBox.max.y | 0, _clearBox.max.x - _clearBox.min.x | 0, _clearBox.min.y - _clearBox.max.y | 0);
						}

						_clearBox.makeEmpty();
				}
		};

		// compatibility

		this.clearColor = function () {};
		this.clearDepth = function () {};
		this.clearStencil = function () {};

		this.render = function (scene, camera) {

				if (camera instanceof THREE.Camera === false) {

						console.error('THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.');
						return;
				}

				if (this.autoClear === true) this.clear();

				_this.info.render.vertices = 0;
				_this.info.render.faces = 0;

				_context.setTransform(_viewportWidth / _canvasWidth, 0, 0, -_viewportHeight / _canvasHeight, _viewportX, _canvasHeight - _viewportY);
				_context.translate(_canvasWidthHalf, _canvasHeightHalf);

				_renderData = _projector.projectScene(scene, camera, this.sortObjects, this.sortElements);
				_elements = _renderData.elements;
				_lights = _renderData.lights;
				_camera = camera;

				_normalViewMatrix.getNormalMatrix(camera.matrixWorldInverse);

				/* DEBUG
    setFillStyle( 'rgba( 0, 255, 255, 0.5 )' );
    _context.fillRect( _clipBox.min.x, _clipBox.min.y, _clipBox.max.x - _clipBox.min.x, _clipBox.max.y - _clipBox.min.y );
    */

				calculateLights();

				for (var e = 0, el = _elements.length; e < el; e++) {

						var element = _elements[e];

						var material = element.material;

						if (material === undefined || material.opacity === 0) continue;

						_elemBox.makeEmpty();

						if (element instanceof THREE.RenderableSprite) {

								_v1 = element;
								_v1.x *= _canvasWidthHalf;_v1.y *= _canvasHeightHalf;

								renderSprite(_v1, element, material);
						} else if (element instanceof THREE.RenderableLine) {

								_v1 = element.v1;_v2 = element.v2;

								_v1.positionScreen.x *= _canvasWidthHalf;_v1.positionScreen.y *= _canvasHeightHalf;
								_v2.positionScreen.x *= _canvasWidthHalf;_v2.positionScreen.y *= _canvasHeightHalf;

								_elemBox.setFromPoints([_v1.positionScreen, _v2.positionScreen]);

								if (_clipBox.isIntersectionBox(_elemBox) === true) {

										renderLine(_v1, _v2, element, material);
								}
						} else if (element instanceof THREE.RenderableFace) {

								_v1 = element.v1;_v2 = element.v2;_v3 = element.v3;

								if (_v1.positionScreen.z < -1 || _v1.positionScreen.z > 1) continue;
								if (_v2.positionScreen.z < -1 || _v2.positionScreen.z > 1) continue;
								if (_v3.positionScreen.z < -1 || _v3.positionScreen.z > 1) continue;

								_v1.positionScreen.x *= _canvasWidthHalf;_v1.positionScreen.y *= _canvasHeightHalf;
								_v2.positionScreen.x *= _canvasWidthHalf;_v2.positionScreen.y *= _canvasHeightHalf;
								_v3.positionScreen.x *= _canvasWidthHalf;_v3.positionScreen.y *= _canvasHeightHalf;

								if (material.overdraw > 0) {

										expand(_v1.positionScreen, _v2.positionScreen, material.overdraw);
										expand(_v2.positionScreen, _v3.positionScreen, material.overdraw);
										expand(_v3.positionScreen, _v1.positionScreen, material.overdraw);
								}

								_elemBox.setFromPoints([_v1.positionScreen, _v2.positionScreen, _v3.positionScreen]);

								if (_clipBox.isIntersectionBox(_elemBox) === true) {

										renderFace3(_v1, _v2, _v3, 0, 1, 2, element, material);
								}
						}

						/* DEBUG
      setLineWidth( 1 );
      setStrokeStyle( 'rgba( 0, 255, 0, 0.5 )' );
      _context.strokeRect( _elemBox.min.x, _elemBox.min.y, _elemBox.max.x - _elemBox.min.x, _elemBox.max.y - _elemBox.min.y );
      */

						_clearBox.union(_elemBox);
				}

				/* DEBUG
    setLineWidth( 1 );
    setStrokeStyle( 'rgba( 255, 0, 0, 0.5 )' );
    _context.strokeRect( _clearBox.min.x, _clearBox.min.y, _clearBox.max.x - _clearBox.min.x, _clearBox.max.y - _clearBox.min.y );
    */

				_context.setTransform(1, 0, 0, 1, 0, 0);
		};

		//

		function calculateLights() {

				_ambientLight.setRGB(0, 0, 0);
				_directionalLights.setRGB(0, 0, 0);
				_pointLights.setRGB(0, 0, 0);

				for (var l = 0, ll = _lights.length; l < ll; l++) {

						var light = _lights[l];
						var lightColor = light.color;

						if (light instanceof THREE.AmbientLight) {

								_ambientLight.add(lightColor);
						} else if (light instanceof THREE.DirectionalLight) {

								// for sprites

								_directionalLights.add(lightColor);
						} else if (light instanceof THREE.PointLight) {

								// for sprites

								_pointLights.add(lightColor);
						}
				}
		}

		function calculateLight(position, normal, color) {

				for (var l = 0, ll = _lights.length; l < ll; l++) {

						var light = _lights[l];

						_lightColor.copy(light.color);

						if (light instanceof THREE.DirectionalLight) {

								var lightPosition = _vector3.setFromMatrixPosition(light.matrixWorld).normalize();

								var amount = normal.dot(lightPosition);

								if (amount <= 0) continue;

								amount *= light.intensity;

								color.add(_lightColor.multiplyScalar(amount));
						} else if (light instanceof THREE.PointLight) {

								var lightPosition = _vector3.setFromMatrixPosition(light.matrixWorld);

								var amount = normal.dot(_vector3.subVectors(lightPosition, position).normalize());

								if (amount <= 0) continue;

								amount *= light.distance == 0 ? 1 : 1 - Math.min(position.distanceTo(lightPosition) / light.distance, 1);

								if (amount == 0) continue;

								amount *= light.intensity;

								color.add(_lightColor.multiplyScalar(amount));
						}
				}
		}

		function renderSprite(v1, element, material) {

				setOpacity(material.opacity);
				setBlending(material.blending);

				var scaleX = element.scale.x * _canvasWidthHalf;
				var scaleY = element.scale.y * _canvasHeightHalf;

				var dist = 0.5 * Math.sqrt(scaleX * scaleX + scaleY * scaleY); // allow for rotated sprite
				_elemBox.min.set(v1.x - dist, v1.y - dist);
				_elemBox.max.set(v1.x + dist, v1.y + dist);

				if (material instanceof THREE.SpriteMaterial) {

						var texture = material.map;

						if (texture !== null) {

								var pattern = _patterns[texture.id];

								if (pattern === undefined || pattern.version !== texture.version) {

										pattern = textureToPattern(texture);
										_patterns[texture.id] = pattern;
								}

								if (pattern.canvas !== undefined) {

										setFillStyle(pattern.canvas);

										var bitmap = texture.image;

										var ox = bitmap.width * texture.offset.x;
										var oy = bitmap.height * texture.offset.y;

										var sx = bitmap.width * texture.repeat.x;
										var sy = bitmap.height * texture.repeat.y;

										var cx = scaleX / sx;
										var cy = scaleY / sy;

										_context.save();
										_context.translate(v1.x, v1.y);
										if (material.rotation !== 0) _context.rotate(material.rotation);
										_context.translate(-scaleX / 2, -scaleY / 2);
										_context.scale(cx, cy);
										_context.translate(-ox, -oy);
										_context.fillRect(ox, oy, sx, sy);
										_context.restore();
								}
						} else {

								// no texture

								setFillStyle(material.color.getStyle());

								_context.save();
								_context.translate(v1.x, v1.y);
								if (material.rotation !== 0) _context.rotate(material.rotation);
								_context.scale(scaleX, -scaleY);
								_context.fillRect(-0.5, -0.5, 1, 1);
								_context.restore();
						}
				} else if (material instanceof THREE.SpriteCanvasMaterial) {

						setStrokeStyle(material.color.getStyle());
						setFillStyle(material.color.getStyle());

						_context.save();
						_context.translate(v1.x, v1.y);
						if (material.rotation !== 0) _context.rotate(material.rotation);
						_context.scale(scaleX, scaleY);

						material.program(_context);

						_context.restore();
				}

				/* DEBUG
    setStrokeStyle( 'rgb(255,255,0)' );
    _context.beginPath();
    _context.moveTo( v1.x - 10, v1.y );
    _context.lineTo( v1.x + 10, v1.y );
    _context.moveTo( v1.x, v1.y - 10 );
    _context.lineTo( v1.x, v1.y + 10 );
    _context.stroke();
    */
		}

		function renderLine(v1, v2, element, material) {

				setOpacity(material.opacity);
				setBlending(material.blending);

				_context.beginPath();
				_context.moveTo(v1.positionScreen.x, v1.positionScreen.y);
				_context.lineTo(v2.positionScreen.x, v2.positionScreen.y);

				if (material instanceof THREE.LineBasicMaterial) {

						setLineWidth(material.linewidth);
						setLineCap(material.linecap);
						setLineJoin(material.linejoin);

						if (material.vertexColors !== THREE.VertexColors) {

								setStrokeStyle(material.color.getStyle());
						} else {

								var colorStyle1 = element.vertexColors[0].getStyle();
								var colorStyle2 = element.vertexColors[1].getStyle();

								if (colorStyle1 === colorStyle2) {

										setStrokeStyle(colorStyle1);
								} else {

										try {

												var grad = _context.createLinearGradient(v1.positionScreen.x, v1.positionScreen.y, v2.positionScreen.x, v2.positionScreen.y);
												grad.addColorStop(0, colorStyle1);
												grad.addColorStop(1, colorStyle2);
										} catch (exception) {

												grad = colorStyle1;
										}

										setStrokeStyle(grad);
								}
						}

						_context.stroke();
						_elemBox.expandByScalar(material.linewidth * 2);
				} else if (material instanceof THREE.LineDashedMaterial) {

						setLineWidth(material.linewidth);
						setLineCap(material.linecap);
						setLineJoin(material.linejoin);
						setStrokeStyle(material.color.getStyle());
						setLineDash([material.dashSize, material.gapSize]);

						_context.stroke();

						_elemBox.expandByScalar(material.linewidth * 2);

						setLineDash([]);
				}
		}

		function renderFace3(v1, v2, v3, uv1, uv2, uv3, element, material) {

				_this.info.render.vertices += 3;
				_this.info.render.faces++;

				setOpacity(material.opacity);
				setBlending(material.blending);

				_v1x = v1.positionScreen.x;_v1y = v1.positionScreen.y;
				_v2x = v2.positionScreen.x;_v2y = v2.positionScreen.y;
				_v3x = v3.positionScreen.x;_v3y = v3.positionScreen.y;

				drawTriangle(_v1x, _v1y, _v2x, _v2y, _v3x, _v3y);

				if ((material instanceof THREE.MeshLambertMaterial || material instanceof THREE.MeshPhongMaterial) && material.map === null) {

						_diffuseColor.copy(material.color);
						_emissiveColor.copy(material.emissive);

						if (material.vertexColors === THREE.FaceColors) {

								_diffuseColor.multiply(element.color);
						}

						_color.copy(_ambientLight);

						_centroid.copy(v1.positionWorld).add(v2.positionWorld).add(v3.positionWorld).divideScalar(3);

						calculateLight(_centroid, element.normalModel, _color);

						_color.multiply(_diffuseColor).add(_emissiveColor);

						material.wireframe === true ? strokePath(_color, material.wireframeLinewidth, material.wireframeLinecap, material.wireframeLinejoin) : fillPath(_color);
				} else if (material instanceof THREE.MeshBasicMaterial || material instanceof THREE.MeshLambertMaterial || material instanceof THREE.MeshPhongMaterial) {

						if (material.map !== null) {

								var mapping = material.map.mapping;

								if (mapping === THREE.UVMapping) {

										_uvs = element.uvs;
										patternPath(_v1x, _v1y, _v2x, _v2y, _v3x, _v3y, _uvs[uv1].x, _uvs[uv1].y, _uvs[uv2].x, _uvs[uv2].y, _uvs[uv3].x, _uvs[uv3].y, material.map);
								}
						} else if (material.envMap !== null) {

								if (material.envMap.mapping === THREE.SphericalReflectionMapping) {

										_normal.copy(element.vertexNormalsModel[uv1]).applyMatrix3(_normalViewMatrix);
										_uv1x = 0.5 * _normal.x + 0.5;
										_uv1y = 0.5 * _normal.y + 0.5;

										_normal.copy(element.vertexNormalsModel[uv2]).applyMatrix3(_normalViewMatrix);
										_uv2x = 0.5 * _normal.x + 0.5;
										_uv2y = 0.5 * _normal.y + 0.5;

										_normal.copy(element.vertexNormalsModel[uv3]).applyMatrix3(_normalViewMatrix);
										_uv3x = 0.5 * _normal.x + 0.5;
										_uv3y = 0.5 * _normal.y + 0.5;

										patternPath(_v1x, _v1y, _v2x, _v2y, _v3x, _v3y, _uv1x, _uv1y, _uv2x, _uv2y, _uv3x, _uv3y, material.envMap);
								}
						} else {

								_color.copy(material.color);

								if (material.vertexColors === THREE.FaceColors) {

										_color.multiply(element.color);
								}

								material.wireframe === true ? strokePath(_color, material.wireframeLinewidth, material.wireframeLinecap, material.wireframeLinejoin) : fillPath(_color);
						}
				} else if (material instanceof THREE.MeshNormalMaterial) {

						_normal.copy(element.normalModel).applyMatrix3(_normalViewMatrix);

						_color.setRGB(_normal.x, _normal.y, _normal.z).multiplyScalar(0.5).addScalar(0.5);

						material.wireframe === true ? strokePath(_color, material.wireframeLinewidth, material.wireframeLinecap, material.wireframeLinejoin) : fillPath(_color);
				} else {

						_color.setRGB(1, 1, 1);

						material.wireframe === true ? strokePath(_color, material.wireframeLinewidth, material.wireframeLinecap, material.wireframeLinejoin) : fillPath(_color);
				}
		}

		//

		function drawTriangle(x0, y0, x1, y1, x2, y2) {

				_context.beginPath();
				_context.moveTo(x0, y0);
				_context.lineTo(x1, y1);
				_context.lineTo(x2, y2);
				_context.closePath();
		}

		function strokePath(color, linewidth, linecap, linejoin) {

				setLineWidth(linewidth);
				setLineCap(linecap);
				setLineJoin(linejoin);
				setStrokeStyle(color.getStyle());

				_context.stroke();

				_elemBox.expandByScalar(linewidth * 2);
		}

		function fillPath(color) {

				setFillStyle(color.getStyle());
				_context.fill();
		}

		function textureToPattern(texture) {

				if (texture.version === 0 || texture instanceof THREE.CompressedTexture || texture instanceof THREE.DataTexture) {

						return {
								canvas: undefined,
								version: texture.version
						};
				}

				var image = texture.image;

				var canvas = document.createElement('canvas');
				canvas.width = image.width;
				canvas.height = image.height;

				var context = canvas.getContext('2d');
				context.setTransform(1, 0, 0, -1, 0, image.height);
				context.drawImage(image, 0, 0);

				var repeatX = texture.wrapS === THREE.RepeatWrapping;
				var repeatY = texture.wrapT === THREE.RepeatWrapping;

				var repeat = 'no-repeat';

				if (repeatX === true && repeatY === true) {

						repeat = 'repeat';
				} else if (repeatX === true) {

						repeat = 'repeat-x';
				} else if (repeatY === true) {

						repeat = 'repeat-y';
				}

				return {
						canvas: _context.createPattern(canvas, repeat),
						version: texture.version
				};
		}

		function patternPath(x0, y0, x1, y1, x2, y2, u0, v0, u1, v1, u2, v2, texture) {

				var pattern = _patterns[texture.id];

				if (pattern === undefined || pattern.version !== texture.version) {

						pattern = textureToPattern(texture);
						_patterns[texture.id] = pattern;
				}

				if (pattern.canvas !== undefined) {

						setFillStyle(pattern.canvas);
				} else {

						setFillStyle('rgba( 0, 0, 0, 1)');
						_context.fill();
						return;
				}

				// http://extremelysatisfactorytotalitarianism.com/blog/?p=2120

				var a,
				    b,
				    c,
				    d,
				    e,
				    f,
				    det,
				    idet,
				    offsetX = texture.offset.x / texture.repeat.x,
				    offsetY = texture.offset.y / texture.repeat.y,
				    width = texture.image.width * texture.repeat.x,
				    height = texture.image.height * texture.repeat.y;

				u0 = (u0 + offsetX) * width;
				v0 = (v0 + offsetY) * height;

				u1 = (u1 + offsetX) * width;
				v1 = (v1 + offsetY) * height;

				u2 = (u2 + offsetX) * width;
				v2 = (v2 + offsetY) * height;

				x1 -= x0;y1 -= y0;
				x2 -= x0;y2 -= y0;

				u1 -= u0;v1 -= v0;
				u2 -= u0;v2 -= v0;

				det = u1 * v2 - u2 * v1;

				if (det === 0) return;

				idet = 1 / det;

				a = (v2 * x1 - v1 * x2) * idet;
				b = (v2 * y1 - v1 * y2) * idet;
				c = (u1 * x2 - u2 * x1) * idet;
				d = (u1 * y2 - u2 * y1) * idet;

				e = x0 - a * u0 - c * v0;
				f = y0 - b * u0 - d * v0;

				_context.save();
				_context.transform(a, b, c, d, e, f);
				_context.fill();
				_context.restore();
		}

		function clipImage(x0, y0, x1, y1, x2, y2, u0, v0, u1, v1, u2, v2, image) {

				// http://extremelysatisfactorytotalitarianism.com/blog/?p=2120

				var a,
				    b,
				    c,
				    d,
				    e,
				    f,
				    det,
				    idet,
				    width = image.width - 1,
				    height = image.height - 1;

				u0 *= width;v0 *= height;
				u1 *= width;v1 *= height;
				u2 *= width;v2 *= height;

				x1 -= x0;y1 -= y0;
				x2 -= x0;y2 -= y0;

				u1 -= u0;v1 -= v0;
				u2 -= u0;v2 -= v0;

				det = u1 * v2 - u2 * v1;

				idet = 1 / det;

				a = (v2 * x1 - v1 * x2) * idet;
				b = (v2 * y1 - v1 * y2) * idet;
				c = (u1 * x2 - u2 * x1) * idet;
				d = (u1 * y2 - u2 * y1) * idet;

				e = x0 - a * u0 - c * v0;
				f = y0 - b * u0 - d * v0;

				_context.save();
				_context.transform(a, b, c, d, e, f);
				_context.clip();
				_context.drawImage(image, 0, 0);
				_context.restore();
		}

		// Hide anti-alias gaps

		function expand(v1, v2, pixels) {

				var x = v2.x - v1.x,
				    y = v2.y - v1.y,
				    det = x * x + y * y,
				    idet;

				if (det === 0) return;

				idet = pixels / Math.sqrt(det);

				x *= idet;y *= idet;

				v2.x += x;v2.y += y;
				v1.x -= x;v1.y -= y;
		}

		// Context cached methods.

		function setOpacity(value) {

				if (_contextGlobalAlpha !== value) {

						_context.globalAlpha = value;
						_contextGlobalAlpha = value;
				}
		}

		function setBlending(value) {

				if (_contextGlobalCompositeOperation !== value) {

						if (value === THREE.NormalBlending) {

								_context.globalCompositeOperation = 'source-over';
						} else if (value === THREE.AdditiveBlending) {

								_context.globalCompositeOperation = 'lighter';
						} else if (value === THREE.SubtractiveBlending) {

								_context.globalCompositeOperation = 'darker';
						}

						_contextGlobalCompositeOperation = value;
				}
		}

		function setLineWidth(value) {

				if (_contextLineWidth !== value) {

						_context.lineWidth = value;
						_contextLineWidth = value;
				}
		}

		function setLineCap(value) {

				// "butt", "round", "square"

				if (_contextLineCap !== value) {

						_context.lineCap = value;
						_contextLineCap = value;
				}
		}

		function setLineJoin(value) {

				// "round", "bevel", "miter"

				if (_contextLineJoin !== value) {

						_context.lineJoin = value;
						_contextLineJoin = value;
				}
		}

		function setStrokeStyle(value) {

				if (_contextStrokeStyle !== value) {

						_context.strokeStyle = value;
						_contextStrokeStyle = value;
				}
		}

		function setFillStyle(value) {

				if (_contextFillStyle !== value) {

						_context.fillStyle = value;
						_contextFillStyle = value;
				}
		}

		function setLineDash(value) {

				if (_contextLineDash.length !== value.length) {

						_context.setLineDash(value);
						_contextLineDash = value;
				}
		}
};
//# sourceMappingURL=data:application/json;base64,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QUV4QjtHQUVEOztBQUVELFdBQVMsV0FBVyxDQUFFLEtBQUssRUFBRzs7OztBQUk3QixRQUFLLGdCQUFnQixLQUFLLEtBQUssRUFBRzs7QUFFakMsY0FBUSxDQUFDLFFBQVEsR0FBRyxLQUFLLENBQUM7QUFDMUIsc0JBQWdCLEdBQUcsS0FBSyxDQUFDO0tBRXpCO0dBRUQ7O0FBRUQsV0FBUyxjQUFjLENBQUUsS0FBSyxFQUFHOztBQUVoQyxRQUFLLG1CQUFtQixLQUFLLEtBQUssRUFBRzs7QUFFcEMsY0FBUSxDQUFDLFdBQVcsR0FBRyxLQUFLLENBQUM7QUFDN0IseUJBQW1CLEdBQUcsS0FBSyxDQUFDO0tBRTVCO0dBRUQ7O0FBRUQsV0FBUyxZQUFZLENBQUUsS0FBSyxFQUFHOztBQUU5QixRQUFLLGlCQUFpQixLQUFLLEtBQUssRUFBRzs7QUFFbEMsY0FBUSxDQUFDLFNBQVMsR0FBRyxLQUFLLENBQUM7QUFDM0IsdUJBQWlCLEdBQUcsS0FBSyxDQUFDO0tBRTFCO0dBRUQ7O0FBRUQsV0FBUyxXQUFXLENBQUUsS0FBSyxFQUFHOztBQUU3QixRQUFLLGdCQUFnQixDQUFDLE1BQU0sS0FBSyxLQUFLLENBQUMsTUFBTSxFQUFHOztBQUUvQyxjQUFRLENBQUMsV0FBVyxDQUFFLEtBQUssQ0FBRSxDQUFDO0FBQzlCLHNCQUFnQixHQUFHLEtBQUssQ0FBQztLQUV6QjtHQUVEO0NBRUQsQ0FBQyIsImZpbGUiOiJDYW52YXNSZW5kZXJlci5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBAYXV0aG9yIG1yZG9vYiAvIGh0dHA6Ly9tcmRvb2IuY29tL1xyXG4gKi9cclxuXHJcblRIUkVFLlNwcml0ZUNhbnZhc01hdGVyaWFsID0gZnVuY3Rpb24gKCBwYXJhbWV0ZXJzICkge1xyXG5cclxuXHRUSFJFRS5NYXRlcmlhbC5jYWxsKCB0aGlzICk7XHJcblxyXG5cdHRoaXMudHlwZSA9ICdTcHJpdGVDYW52YXNNYXRlcmlhbCc7XHJcblxyXG5cdHRoaXMuY29sb3IgPSBuZXcgVEhSRUUuQ29sb3IoIDB4ZmZmZmZmICk7XHJcblx0dGhpcy5wcm9ncmFtID0gZnVuY3Rpb24gKCBjb250ZXh0LCBjb2xvciApIHt9O1xyXG5cclxuXHR0aGlzLnNldFZhbHVlcyggcGFyYW1ldGVycyApO1xyXG5cclxufTtcclxuXHJcblRIUkVFLlNwcml0ZUNhbnZhc01hdGVyaWFsLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoIFRIUkVFLk1hdGVyaWFsLnByb3RvdHlwZSApO1xyXG5USFJFRS5TcHJpdGVDYW52YXNNYXRlcmlhbC5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBUSFJFRS5TcHJpdGVDYW52YXNNYXRlcmlhbDtcclxuXHJcblRIUkVFLlNwcml0ZUNhbnZhc01hdGVyaWFsLnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uICgpIHtcclxuXHJcblx0dmFyIG1hdGVyaWFsID0gbmV3IFRIUkVFLlNwcml0ZUNhbnZhc01hdGVyaWFsKCk7XHJcblxyXG5cdG1hdGVyaWFsLmNvcHkoIHRoaXMgKTtcclxuXHRtYXRlcmlhbC5jb2xvci5jb3B5KCB0aGlzLmNvbG9yICk7XHJcblx0bWF0ZXJpYWwucHJvZ3JhbSA9IHRoaXMucHJvZ3JhbTtcclxuXHJcblx0cmV0dXJuIG1hdGVyaWFsO1xyXG5cclxufTtcclxuXHJcbi8vXHJcblxyXG5USFJFRS5DYW52YXNSZW5kZXJlciA9IGZ1bmN0aW9uICggcGFyYW1ldGVycyApIHtcclxuXHJcblx0Y29uc29sZS5sb2coICdUSFJFRS5DYW52YXNSZW5kZXJlcicsIFRIUkVFLlJFVklTSU9OICk7XHJcblxyXG5cdHBhcmFtZXRlcnMgPSBwYXJhbWV0ZXJzIHx8IHt9O1xyXG5cclxuXHR2YXIgX3RoaXMgPSB0aGlzLFxyXG5cdF9yZW5kZXJEYXRhLCBfZWxlbWVudHMsIF9saWdodHMsXHJcblx0X3Byb2plY3RvciA9IG5ldyBUSFJFRS5Qcm9qZWN0b3IoKSxcclxuXHJcblx0X2NhbnZhcyA9IHBhcmFtZXRlcnMuY2FudmFzICE9PSB1bmRlZmluZWRcclxuXHRcdFx0ID8gcGFyYW1ldGVycy5jYW52YXNcclxuXHRcdFx0IDogZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2NhbnZhcycgKSxcclxuXHJcblx0X2NhbnZhc1dpZHRoID0gX2NhbnZhcy53aWR0aCxcclxuXHRfY2FudmFzSGVpZ2h0ID0gX2NhbnZhcy5oZWlnaHQsXHJcblx0X2NhbnZhc1dpZHRoSGFsZiA9IE1hdGguZmxvb3IoIF9jYW52YXNXaWR0aCAvIDIgKSxcclxuXHRfY2FudmFzSGVpZ2h0SGFsZiA9IE1hdGguZmxvb3IoIF9jYW52YXNIZWlnaHQgLyAyICksXHJcblxyXG5cdF92aWV3cG9ydFggPSAwLFxyXG5cdF92aWV3cG9ydFkgPSAwLFxyXG5cdF92aWV3cG9ydFdpZHRoID0gX2NhbnZhc1dpZHRoLFxyXG5cdF92aWV3cG9ydEhlaWdodCA9IF9jYW52YXNIZWlnaHQsXHJcblxyXG5cdHBpeGVsUmF0aW8gPSAxLFxyXG5cclxuXHRfY29udGV4dCA9IF9jYW52YXMuZ2V0Q29udGV4dCggJzJkJywge1xyXG5cdFx0YWxwaGE6IHBhcmFtZXRlcnMuYWxwaGEgPT09IHRydWVcclxuXHR9ICksXHJcblxyXG5cdF9jbGVhckNvbG9yID0gbmV3IFRIUkVFLkNvbG9yKCAweDAwMDAwMCApLFxyXG5cdF9jbGVhckFscGhhID0gcGFyYW1ldGVycy5hbHBoYSA9PT0gdHJ1ZSA/IDAgOiAxLFxyXG5cclxuXHRfY29udGV4dEdsb2JhbEFscGhhID0gMSxcclxuXHRfY29udGV4dEdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9IDAsXHJcblx0X2NvbnRleHRTdHJva2VTdHlsZSA9IG51bGwsXHJcblx0X2NvbnRleHRGaWxsU3R5bGUgPSBudWxsLFxyXG5cdF9jb250ZXh0TGluZVdpZHRoID0gbnVsbCxcclxuXHRfY29udGV4dExpbmVDYXAgPSBudWxsLFxyXG5cdF9jb250ZXh0TGluZUpvaW4gPSBudWxsLFxyXG5cdF9jb250ZXh0TGluZURhc2ggPSBbXSxcclxuXHJcblx0X2NhbWVyYSxcclxuXHJcblx0X3YxLCBfdjIsIF92MywgX3Y0LFxyXG5cdF92NSA9IG5ldyBUSFJFRS5SZW5kZXJhYmxlVmVydGV4KCksXHJcblx0X3Y2ID0gbmV3IFRIUkVFLlJlbmRlcmFibGVWZXJ0ZXgoKSxcclxuXHJcblx0X3YxeCwgX3YxeSwgX3YyeCwgX3YyeSwgX3YzeCwgX3YzeSxcclxuXHRfdjR4LCBfdjR5LCBfdjV4LCBfdjV5LCBfdjZ4LCBfdjZ5LFxyXG5cclxuXHRfY29sb3IgPSBuZXcgVEhSRUUuQ29sb3IoKSxcclxuXHRfY29sb3IxID0gbmV3IFRIUkVFLkNvbG9yKCksXHJcblx0X2NvbG9yMiA9IG5ldyBUSFJFRS5Db2xvcigpLFxyXG5cdF9jb2xvcjMgPSBuZXcgVEhSRUUuQ29sb3IoKSxcclxuXHRfY29sb3I0ID0gbmV3IFRIUkVFLkNvbG9yKCksXHJcblxyXG5cdF9kaWZmdXNlQ29sb3IgPSBuZXcgVEhSRUUuQ29sb3IoKSxcclxuXHRfZW1pc3NpdmVDb2xvciA9IG5ldyBUSFJFRS5Db2xvcigpLFxyXG5cclxuXHRfbGlnaHRDb2xvciA9IG5ldyBUSFJFRS5Db2xvcigpLFxyXG5cclxuXHRfcGF0dGVybnMgPSB7fSxcclxuXHJcblx0X2ltYWdlLCBfdXZzLFxyXG5cdF91djF4LCBfdXYxeSwgX3V2MngsIF91djJ5LCBfdXYzeCwgX3V2M3ksXHJcblxyXG5cdF9jbGlwQm94ID0gbmV3IFRIUkVFLkJveDIoKSxcclxuXHRfY2xlYXJCb3ggPSBuZXcgVEhSRUUuQm94MigpLFxyXG5cdF9lbGVtQm94ID0gbmV3IFRIUkVFLkJveDIoKSxcclxuXHJcblx0X2FtYmllbnRMaWdodCA9IG5ldyBUSFJFRS5Db2xvcigpLFxyXG5cdF9kaXJlY3Rpb25hbExpZ2h0cyA9IG5ldyBUSFJFRS5Db2xvcigpLFxyXG5cdF9wb2ludExpZ2h0cyA9IG5ldyBUSFJFRS5Db2xvcigpLFxyXG5cclxuXHRfdmVjdG9yMyA9IG5ldyBUSFJFRS5WZWN0b3IzKCksIC8vIE5lZWRlZCBmb3IgUG9pbnRMaWdodFxyXG5cdF9jZW50cm9pZCA9IG5ldyBUSFJFRS5WZWN0b3IzKCksXHJcblx0X25vcm1hbCA9IG5ldyBUSFJFRS5WZWN0b3IzKCksXHJcblx0X25vcm1hbFZpZXdNYXRyaXggPSBuZXcgVEhSRUUuTWF0cml4MygpO1xyXG5cclxuXHQvLyBkYXNoK2dhcCBmYWxsYmFja3MgZm9yIEZpcmVmb3ggYW5kIGV2ZXJ5dGhpbmcgZWxzZVxyXG5cclxuXHRpZiAoIF9jb250ZXh0LnNldExpbmVEYXNoID09PSB1bmRlZmluZWQgKSB7XHJcblxyXG5cdFx0X2NvbnRleHQuc2V0TGluZURhc2ggPSBmdW5jdGlvbiAoKSB7fVxyXG5cclxuXHR9XHJcblxyXG5cdHRoaXMuZG9tRWxlbWVudCA9IF9jYW52YXM7XHJcblxyXG5cdHRoaXMuYXV0b0NsZWFyID0gdHJ1ZTtcclxuXHR0aGlzLnNvcnRPYmplY3RzID0gdHJ1ZTtcclxuXHR0aGlzLnNvcnRFbGVtZW50cyA9IHRydWU7XHJcblxyXG5cdHRoaXMuaW5mbyA9IHtcclxuXHJcblx0XHRyZW5kZXI6IHtcclxuXHJcblx0XHRcdHZlcnRpY2VzOiAwLFxyXG5cdFx0XHRmYWNlczogMFxyXG5cclxuXHRcdH1cclxuXHJcblx0fTtcclxuXHJcblx0Ly8gV2ViR0xSZW5kZXJlciBjb21wYXRpYmlsaXR5XHJcblxyXG5cdHRoaXMuc3VwcG9ydHNWZXJ0ZXhUZXh0dXJlcyA9IGZ1bmN0aW9uICgpIHt9O1xyXG5cdHRoaXMuc2V0RmFjZUN1bGxpbmcgPSBmdW5jdGlvbiAoKSB7fTtcclxuXHJcblx0Ly8gQVBJXHJcblxyXG5cdHRoaXMuZ2V0Q29udGV4dCA9IGZ1bmN0aW9uICgpIHtcclxuXHJcblx0XHRyZXR1cm4gX2NvbnRleHQ7XHJcblxyXG5cdH07XHJcblxyXG5cdHRoaXMuZ2V0Q29udGV4dEF0dHJpYnV0ZXMgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG5cdFx0cmV0dXJuIF9jb250ZXh0LmdldENvbnRleHRBdHRyaWJ1dGVzKCk7XHJcblxyXG5cdH07XHJcblxyXG5cdHRoaXMuZ2V0UGl4ZWxSYXRpbyA9IGZ1bmN0aW9uICgpIHtcclxuXHJcblx0XHRyZXR1cm4gcGl4ZWxSYXRpbztcclxuXHJcblx0fTtcclxuXHJcblx0dGhpcy5zZXRQaXhlbFJhdGlvID0gZnVuY3Rpb24gKCB2YWx1ZSApIHtcclxuXHJcblx0XHRpZiAoIHZhbHVlICE9PSB1bmRlZmluZWQgKSBwaXhlbFJhdGlvID0gdmFsdWU7XHJcblxyXG5cdH07XHJcblxyXG5cdHRoaXMuc2V0U2l6ZSA9IGZ1bmN0aW9uICggd2lkdGgsIGhlaWdodCwgdXBkYXRlU3R5bGUgKSB7XHJcblxyXG5cdFx0X2NhbnZhc1dpZHRoID0gd2lkdGggKiBwaXhlbFJhdGlvO1xyXG5cdFx0X2NhbnZhc0hlaWdodCA9IGhlaWdodCAqIHBpeGVsUmF0aW87XHJcblxyXG5cdFx0X2NhbnZhcy53aWR0aCA9IF9jYW52YXNXaWR0aDtcclxuXHRcdF9jYW52YXMuaGVpZ2h0ID0gX2NhbnZhc0hlaWdodDtcclxuXHJcblx0XHRfY2FudmFzV2lkdGhIYWxmID0gTWF0aC5mbG9vciggX2NhbnZhc1dpZHRoIC8gMiApO1xyXG5cdFx0X2NhbnZhc0hlaWdodEhhbGYgPSBNYXRoLmZsb29yKCBfY2FudmFzSGVpZ2h0IC8gMiApO1xyXG5cclxuXHRcdGlmICggdXBkYXRlU3R5bGUgIT09IGZhbHNlICkge1xyXG5cclxuXHRcdFx0X2NhbnZhcy5zdHlsZS53aWR0aCA9IHdpZHRoICsgJ3B4JztcclxuXHRcdFx0X2NhbnZhcy5zdHlsZS5oZWlnaHQgPSBoZWlnaHQgKyAncHgnO1xyXG5cclxuXHRcdH1cclxuXHJcblx0XHRfY2xpcEJveC5taW4uc2V0KCAtIF9jYW52YXNXaWR0aEhhbGYsIC0gX2NhbnZhc0hlaWdodEhhbGYgKTtcclxuXHRcdF9jbGlwQm94Lm1heC5zZXQoICAgX2NhbnZhc1dpZHRoSGFsZiwgICBfY2FudmFzSGVpZ2h0SGFsZiApO1xyXG5cclxuXHRcdF9jbGVhckJveC5taW4uc2V0KCAtIF9jYW52YXNXaWR0aEhhbGYsIC0gX2NhbnZhc0hlaWdodEhhbGYgKTtcclxuXHRcdF9jbGVhckJveC5tYXguc2V0KCAgIF9jYW52YXNXaWR0aEhhbGYsICAgX2NhbnZhc0hlaWdodEhhbGYgKTtcclxuXHJcblx0XHRfY29udGV4dEdsb2JhbEFscGhhID0gMTtcclxuXHRcdF9jb250ZXh0R2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gMDtcclxuXHRcdF9jb250ZXh0U3Ryb2tlU3R5bGUgPSBudWxsO1xyXG5cdFx0X2NvbnRleHRGaWxsU3R5bGUgPSBudWxsO1xyXG5cdFx0X2NvbnRleHRMaW5lV2lkdGggPSBudWxsO1xyXG5cdFx0X2NvbnRleHRMaW5lQ2FwID0gbnVsbDtcclxuXHRcdF9jb250ZXh0TGluZUpvaW4gPSBudWxsO1xyXG5cclxuXHRcdHRoaXMuc2V0Vmlld3BvcnQoIDAsIDAsIHdpZHRoLCBoZWlnaHQgKTtcclxuXHJcblx0fTtcclxuXHJcblx0dGhpcy5zZXRWaWV3cG9ydCA9IGZ1bmN0aW9uICggeCwgeSwgd2lkdGgsIGhlaWdodCApIHtcclxuXHJcblx0XHRfdmlld3BvcnRYID0geCAqIHBpeGVsUmF0aW87XHJcblx0XHRfdmlld3BvcnRZID0geSAqIHBpeGVsUmF0aW87XHJcblxyXG5cdFx0X3ZpZXdwb3J0V2lkdGggPSB3aWR0aCAqIHBpeGVsUmF0aW87XHJcblx0XHRfdmlld3BvcnRIZWlnaHQgPSBoZWlnaHQgKiBwaXhlbFJhdGlvO1xyXG5cclxuXHR9O1xyXG5cclxuXHR0aGlzLnNldFNjaXNzb3IgPSBmdW5jdGlvbiAoKSB7fTtcclxuXHR0aGlzLmVuYWJsZVNjaXNzb3JUZXN0ID0gZnVuY3Rpb24gKCkge307XHJcblxyXG5cdHRoaXMuc2V0Q2xlYXJDb2xvciA9IGZ1bmN0aW9uICggY29sb3IsIGFscGhhICkge1xyXG5cclxuXHRcdF9jbGVhckNvbG9yLnNldCggY29sb3IgKTtcclxuXHRcdF9jbGVhckFscGhhID0gYWxwaGEgIT09IHVuZGVmaW5lZCA/IGFscGhhIDogMTtcclxuXHJcblx0XHRfY2xlYXJCb3gubWluLnNldCggLSBfY2FudmFzV2lkdGhIYWxmLCAtIF9jYW52YXNIZWlnaHRIYWxmICk7XHJcblx0XHRfY2xlYXJCb3gubWF4LnNldCggICBfY2FudmFzV2lkdGhIYWxmLCAgIF9jYW52YXNIZWlnaHRIYWxmICk7XHJcblxyXG5cdH07XHJcblxyXG5cdHRoaXMuc2V0Q2xlYXJDb2xvckhleCA9IGZ1bmN0aW9uICggaGV4LCBhbHBoYSApIHtcclxuXHJcblx0XHRjb25zb2xlLndhcm4oICdUSFJFRS5DYW52YXNSZW5kZXJlcjogLnNldENsZWFyQ29sb3JIZXgoKSBpcyBiZWluZyByZW1vdmVkLiBVc2UgLnNldENsZWFyQ29sb3IoKSBpbnN0ZWFkLicgKTtcclxuXHRcdHRoaXMuc2V0Q2xlYXJDb2xvciggaGV4LCBhbHBoYSApO1xyXG5cclxuXHR9O1xyXG5cclxuXHR0aGlzLmdldENsZWFyQ29sb3IgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG5cdFx0cmV0dXJuIF9jbGVhckNvbG9yO1xyXG5cclxuXHR9O1xyXG5cclxuXHR0aGlzLmdldENsZWFyQWxwaGEgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG5cdFx0cmV0dXJuIF9jbGVhckFscGhhO1xyXG5cclxuXHR9O1xyXG5cclxuXHR0aGlzLmdldE1heEFuaXNvdHJvcHkgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG5cdFx0cmV0dXJuIDA7XHJcblxyXG5cdH07XHJcblxyXG5cdHRoaXMuY2xlYXIgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG5cdFx0aWYgKCBfY2xlYXJCb3guZW1wdHkoKSA9PT0gZmFsc2UgKSB7XHJcblxyXG5cdFx0XHRfY2xlYXJCb3guaW50ZXJzZWN0KCBfY2xpcEJveCApO1xyXG5cdFx0XHRfY2xlYXJCb3guZXhwYW5kQnlTY2FsYXIoIDIgKTtcclxuXHJcblx0XHRcdF9jbGVhckJveC5taW4ueCA9IF9jbGVhckJveC5taW4ueCArIF9jYW52YXNXaWR0aEhhbGY7XHJcblx0XHRcdF9jbGVhckJveC5taW4ueSA9ICAtIF9jbGVhckJveC5taW4ueSArIF9jYW52YXNIZWlnaHRIYWxmO1x0XHQvLyBoaWdoZXIgeSB2YWx1ZSAhXHJcblx0XHRcdF9jbGVhckJveC5tYXgueCA9IF9jbGVhckJveC5tYXgueCArIF9jYW52YXNXaWR0aEhhbGY7XHJcblx0XHRcdF9jbGVhckJveC5tYXgueSA9ICAtIF9jbGVhckJveC5tYXgueSArIF9jYW52YXNIZWlnaHRIYWxmO1x0XHQvLyBsb3dlciB5IHZhbHVlICFcclxuXHJcblx0XHRcdGlmICggX2NsZWFyQWxwaGEgPCAxICkge1xyXG5cclxuXHRcdFx0XHRfY29udGV4dC5jbGVhclJlY3QoXHJcblx0XHRcdFx0XHRfY2xlYXJCb3gubWluLnggfCAwLFxyXG5cdFx0XHRcdFx0X2NsZWFyQm94Lm1heC55IHwgMCxcclxuXHRcdFx0XHRcdCggX2NsZWFyQm94Lm1heC54IC0gX2NsZWFyQm94Lm1pbi54ICkgfCAwLFxyXG5cdFx0XHRcdFx0KCBfY2xlYXJCb3gubWluLnkgLSBfY2xlYXJCb3gubWF4LnkgKSB8IDBcclxuXHRcdFx0XHQpO1xyXG5cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKCBfY2xlYXJBbHBoYSA+IDAgKSB7XHJcblxyXG5cdFx0XHRcdHNldEJsZW5kaW5nKCBUSFJFRS5Ob3JtYWxCbGVuZGluZyApO1xyXG5cdFx0XHRcdHNldE9wYWNpdHkoIDEgKTtcclxuXHJcblx0XHRcdFx0c2V0RmlsbFN0eWxlKCAncmdiYSgnICsgTWF0aC5mbG9vciggX2NsZWFyQ29sb3IuciAqIDI1NSApICsgJywnICsgTWF0aC5mbG9vciggX2NsZWFyQ29sb3IuZyAqIDI1NSApICsgJywnICsgTWF0aC5mbG9vciggX2NsZWFyQ29sb3IuYiAqIDI1NSApICsgJywnICsgX2NsZWFyQWxwaGEgKyAnKScgKTtcclxuXHJcblx0XHRcdFx0X2NvbnRleHQuZmlsbFJlY3QoXHJcblx0XHRcdFx0XHRfY2xlYXJCb3gubWluLnggfCAwLFxyXG5cdFx0XHRcdFx0X2NsZWFyQm94Lm1heC55IHwgMCxcclxuXHRcdFx0XHRcdCggX2NsZWFyQm94Lm1heC54IC0gX2NsZWFyQm94Lm1pbi54ICkgfCAwLFxyXG5cdFx0XHRcdFx0KCBfY2xlYXJCb3gubWluLnkgLSBfY2xlYXJCb3gubWF4LnkgKSB8IDBcclxuXHRcdFx0XHQpO1xyXG5cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0X2NsZWFyQm94Lm1ha2VFbXB0eSgpO1xyXG5cclxuXHRcdH1cclxuXHJcblx0fTtcclxuXHJcblx0Ly8gY29tcGF0aWJpbGl0eVxyXG5cclxuXHR0aGlzLmNsZWFyQ29sb3IgPSBmdW5jdGlvbiAoKSB7fTtcclxuXHR0aGlzLmNsZWFyRGVwdGggPSBmdW5jdGlvbiAoKSB7fTtcclxuXHR0aGlzLmNsZWFyU3RlbmNpbCA9IGZ1bmN0aW9uICgpIHt9O1xyXG5cclxuXHR0aGlzLnJlbmRlciA9IGZ1bmN0aW9uICggc2NlbmUsIGNhbWVyYSApIHtcclxuXHJcblx0XHRpZiAoIGNhbWVyYSBpbnN0YW5jZW9mIFRIUkVFLkNhbWVyYSA9PT0gZmFsc2UgKSB7XHJcblxyXG5cdFx0XHRjb25zb2xlLmVycm9yKCAnVEhSRUUuQ2FudmFzUmVuZGVyZXIucmVuZGVyOiBjYW1lcmEgaXMgbm90IGFuIGluc3RhbmNlIG9mIFRIUkVFLkNhbWVyYS4nICk7XHJcblx0XHRcdHJldHVybjtcclxuXHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKCB0aGlzLmF1dG9DbGVhciA9PT0gdHJ1ZSApIHRoaXMuY2xlYXIoKTtcclxuXHJcblx0XHRfdGhpcy5pbmZvLnJlbmRlci52ZXJ0aWNlcyA9IDA7XHJcblx0XHRfdGhpcy5pbmZvLnJlbmRlci5mYWNlcyA9IDA7XHJcblxyXG5cdFx0X2NvbnRleHQuc2V0VHJhbnNmb3JtKCBfdmlld3BvcnRXaWR0aCAvIF9jYW52YXNXaWR0aCwgMCwgMCwgLSBfdmlld3BvcnRIZWlnaHQgLyBfY2FudmFzSGVpZ2h0LCBfdmlld3BvcnRYLCBfY2FudmFzSGVpZ2h0IC0gX3ZpZXdwb3J0WSApO1xyXG5cdFx0X2NvbnRleHQudHJhbnNsYXRlKCBfY2FudmFzV2lkdGhIYWxmLCBfY2FudmFzSGVpZ2h0SGFsZiApO1xyXG5cclxuXHRcdF9yZW5kZXJEYXRhID0gX3Byb2plY3Rvci5wcm9qZWN0U2NlbmUoIHNjZW5lLCBjYW1lcmEsIHRoaXMuc29ydE9iamVjdHMsIHRoaXMuc29ydEVsZW1lbnRzICk7XHJcblx0XHRfZWxlbWVudHMgPSBfcmVuZGVyRGF0YS5lbGVtZW50cztcclxuXHRcdF9saWdodHMgPSBfcmVuZGVyRGF0YS5saWdodHM7XHJcblx0XHRfY2FtZXJhID0gY2FtZXJhO1xyXG5cclxuXHRcdF9ub3JtYWxWaWV3TWF0cml4LmdldE5vcm1hbE1hdHJpeCggY2FtZXJhLm1hdHJpeFdvcmxkSW52ZXJzZSApO1xyXG5cclxuXHRcdC8qIERFQlVHXHJcblx0XHRzZXRGaWxsU3R5bGUoICdyZ2JhKCAwLCAyNTUsIDI1NSwgMC41ICknICk7XHJcblx0XHRfY29udGV4dC5maWxsUmVjdCggX2NsaXBCb3gubWluLngsIF9jbGlwQm94Lm1pbi55LCBfY2xpcEJveC5tYXgueCAtIF9jbGlwQm94Lm1pbi54LCBfY2xpcEJveC5tYXgueSAtIF9jbGlwQm94Lm1pbi55ICk7XHJcblx0XHQqL1xyXG5cclxuXHRcdGNhbGN1bGF0ZUxpZ2h0cygpO1xyXG5cclxuXHRcdGZvciAoIHZhciBlID0gMCwgZWwgPSBfZWxlbWVudHMubGVuZ3RoOyBlIDwgZWw7IGUgKysgKSB7XHJcblxyXG5cdFx0XHR2YXIgZWxlbWVudCA9IF9lbGVtZW50c1sgZSBdO1xyXG5cclxuXHRcdFx0dmFyIG1hdGVyaWFsID0gZWxlbWVudC5tYXRlcmlhbDtcclxuXHJcblx0XHRcdGlmICggbWF0ZXJpYWwgPT09IHVuZGVmaW5lZCB8fCBtYXRlcmlhbC5vcGFjaXR5ID09PSAwICkgY29udGludWU7XHJcblxyXG5cdFx0XHRfZWxlbUJveC5tYWtlRW1wdHkoKTtcclxuXHJcblx0XHRcdGlmICggZWxlbWVudCBpbnN0YW5jZW9mIFRIUkVFLlJlbmRlcmFibGVTcHJpdGUgKSB7XHJcblxyXG5cdFx0XHRcdF92MSA9IGVsZW1lbnQ7XHJcblx0XHRcdFx0X3YxLnggKj0gX2NhbnZhc1dpZHRoSGFsZjsgX3YxLnkgKj0gX2NhbnZhc0hlaWdodEhhbGY7XHJcblxyXG5cdFx0XHRcdHJlbmRlclNwcml0ZSggX3YxLCBlbGVtZW50LCBtYXRlcmlhbCApO1xyXG5cclxuXHRcdFx0fSBlbHNlIGlmICggZWxlbWVudCBpbnN0YW5jZW9mIFRIUkVFLlJlbmRlcmFibGVMaW5lICkge1xyXG5cclxuXHRcdFx0XHRfdjEgPSBlbGVtZW50LnYxOyBfdjIgPSBlbGVtZW50LnYyO1xyXG5cclxuXHRcdFx0XHRfdjEucG9zaXRpb25TY3JlZW4ueCAqPSBfY2FudmFzV2lkdGhIYWxmOyBfdjEucG9zaXRpb25TY3JlZW4ueSAqPSBfY2FudmFzSGVpZ2h0SGFsZjtcclxuXHRcdFx0XHRfdjIucG9zaXRpb25TY3JlZW4ueCAqPSBfY2FudmFzV2lkdGhIYWxmOyBfdjIucG9zaXRpb25TY3JlZW4ueSAqPSBfY2FudmFzSGVpZ2h0SGFsZjtcclxuXHJcblx0XHRcdFx0X2VsZW1Cb3guc2V0RnJvbVBvaW50cyggW1xyXG5cdFx0XHRcdFx0X3YxLnBvc2l0aW9uU2NyZWVuLFxyXG5cdFx0XHRcdFx0X3YyLnBvc2l0aW9uU2NyZWVuXHJcblx0XHRcdFx0XSApO1xyXG5cclxuXHRcdFx0XHRpZiAoIF9jbGlwQm94LmlzSW50ZXJzZWN0aW9uQm94KCBfZWxlbUJveCApID09PSB0cnVlICkge1xyXG5cclxuXHRcdFx0XHRcdHJlbmRlckxpbmUoIF92MSwgX3YyLCBlbGVtZW50LCBtYXRlcmlhbCApO1xyXG5cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHR9IGVsc2UgaWYgKCBlbGVtZW50IGluc3RhbmNlb2YgVEhSRUUuUmVuZGVyYWJsZUZhY2UgKSB7XHJcblxyXG5cdFx0XHRcdF92MSA9IGVsZW1lbnQudjE7IF92MiA9IGVsZW1lbnQudjI7IF92MyA9IGVsZW1lbnQudjM7XHJcblxyXG5cdFx0XHRcdGlmICggX3YxLnBvc2l0aW9uU2NyZWVuLnogPCAtIDEgfHwgX3YxLnBvc2l0aW9uU2NyZWVuLnogPiAxICkgY29udGludWU7XHJcblx0XHRcdFx0aWYgKCBfdjIucG9zaXRpb25TY3JlZW4ueiA8IC0gMSB8fCBfdjIucG9zaXRpb25TY3JlZW4ueiA+IDEgKSBjb250aW51ZTtcclxuXHRcdFx0XHRpZiAoIF92My5wb3NpdGlvblNjcmVlbi56IDwgLSAxIHx8IF92My5wb3NpdGlvblNjcmVlbi56ID4gMSApIGNvbnRpbnVlO1xyXG5cclxuXHRcdFx0XHRfdjEucG9zaXRpb25TY3JlZW4ueCAqPSBfY2FudmFzV2lkdGhIYWxmOyBfdjEucG9zaXRpb25TY3JlZW4ueSAqPSBfY2FudmFzSGVpZ2h0SGFsZjtcclxuXHRcdFx0XHRfdjIucG9zaXRpb25TY3JlZW4ueCAqPSBfY2FudmFzV2lkdGhIYWxmOyBfdjIucG9zaXRpb25TY3JlZW4ueSAqPSBfY2FudmFzSGVpZ2h0SGFsZjtcclxuXHRcdFx0XHRfdjMucG9zaXRpb25TY3JlZW4ueCAqPSBfY2FudmFzV2lkdGhIYWxmOyBfdjMucG9zaXRpb25TY3JlZW4ueSAqPSBfY2FudmFzSGVpZ2h0SGFsZjtcclxuXHJcblx0XHRcdFx0aWYgKCBtYXRlcmlhbC5vdmVyZHJhdyA+IDAgKSB7XHJcblxyXG5cdFx0XHRcdFx0ZXhwYW5kKCBfdjEucG9zaXRpb25TY3JlZW4sIF92Mi5wb3NpdGlvblNjcmVlbiwgbWF0ZXJpYWwub3ZlcmRyYXcgKTtcclxuXHRcdFx0XHRcdGV4cGFuZCggX3YyLnBvc2l0aW9uU2NyZWVuLCBfdjMucG9zaXRpb25TY3JlZW4sIG1hdGVyaWFsLm92ZXJkcmF3ICk7XHJcblx0XHRcdFx0XHRleHBhbmQoIF92My5wb3NpdGlvblNjcmVlbiwgX3YxLnBvc2l0aW9uU2NyZWVuLCBtYXRlcmlhbC5vdmVyZHJhdyApO1xyXG5cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdF9lbGVtQm94LnNldEZyb21Qb2ludHMoIFtcclxuXHRcdFx0XHRcdF92MS5wb3NpdGlvblNjcmVlbixcclxuXHRcdFx0XHRcdF92Mi5wb3NpdGlvblNjcmVlbixcclxuXHRcdFx0XHRcdF92My5wb3NpdGlvblNjcmVlblxyXG5cdFx0XHRcdF0gKTtcclxuXHJcblx0XHRcdFx0aWYgKCBfY2xpcEJveC5pc0ludGVyc2VjdGlvbkJveCggX2VsZW1Cb3ggKSA9PT0gdHJ1ZSApIHtcclxuXHJcblx0XHRcdFx0XHRyZW5kZXJGYWNlMyggX3YxLCBfdjIsIF92MywgMCwgMSwgMiwgZWxlbWVudCwgbWF0ZXJpYWwgKTtcclxuXHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0LyogREVCVUdcclxuXHRcdFx0c2V0TGluZVdpZHRoKCAxICk7XHJcblx0XHRcdHNldFN0cm9rZVN0eWxlKCAncmdiYSggMCwgMjU1LCAwLCAwLjUgKScgKTtcclxuXHRcdFx0X2NvbnRleHQuc3Ryb2tlUmVjdCggX2VsZW1Cb3gubWluLngsIF9lbGVtQm94Lm1pbi55LCBfZWxlbUJveC5tYXgueCAtIF9lbGVtQm94Lm1pbi54LCBfZWxlbUJveC5tYXgueSAtIF9lbGVtQm94Lm1pbi55ICk7XHJcblx0XHRcdCovXHJcblxyXG5cdFx0XHRfY2xlYXJCb3gudW5pb24oIF9lbGVtQm94ICk7XHJcblxyXG5cdFx0fVxyXG5cclxuXHRcdC8qIERFQlVHXHJcblx0XHRzZXRMaW5lV2lkdGgoIDEgKTtcclxuXHRcdHNldFN0cm9rZVN0eWxlKCAncmdiYSggMjU1LCAwLCAwLCAwLjUgKScgKTtcclxuXHRcdF9jb250ZXh0LnN0cm9rZVJlY3QoIF9jbGVhckJveC5taW4ueCwgX2NsZWFyQm94Lm1pbi55LCBfY2xlYXJCb3gubWF4LnggLSBfY2xlYXJCb3gubWluLngsIF9jbGVhckJveC5tYXgueSAtIF9jbGVhckJveC5taW4ueSApO1xyXG5cdFx0Ki9cclxuXHJcblx0XHRfY29udGV4dC5zZXRUcmFuc2Zvcm0oIDEsIDAsIDAsIDEsIDAsIDAgKTtcclxuXHJcblx0fTtcclxuXHJcblx0Ly9cclxuXHJcblx0ZnVuY3Rpb24gY2FsY3VsYXRlTGlnaHRzKCkge1xyXG5cclxuXHRcdF9hbWJpZW50TGlnaHQuc2V0UkdCKCAwLCAwLCAwICk7XHJcblx0XHRfZGlyZWN0aW9uYWxMaWdodHMuc2V0UkdCKCAwLCAwLCAwICk7XHJcblx0XHRfcG9pbnRMaWdodHMuc2V0UkdCKCAwLCAwLCAwICk7XHJcblxyXG5cdFx0Zm9yICggdmFyIGwgPSAwLCBsbCA9IF9saWdodHMubGVuZ3RoOyBsIDwgbGw7IGwgKysgKSB7XHJcblxyXG5cdFx0XHR2YXIgbGlnaHQgPSBfbGlnaHRzWyBsIF07XHJcblx0XHRcdHZhciBsaWdodENvbG9yID0gbGlnaHQuY29sb3I7XHJcblxyXG5cdFx0XHRpZiAoIGxpZ2h0IGluc3RhbmNlb2YgVEhSRUUuQW1iaWVudExpZ2h0ICkge1xyXG5cclxuXHRcdFx0XHRfYW1iaWVudExpZ2h0LmFkZCggbGlnaHRDb2xvciApO1xyXG5cclxuXHRcdFx0fSBlbHNlIGlmICggbGlnaHQgaW5zdGFuY2VvZiBUSFJFRS5EaXJlY3Rpb25hbExpZ2h0ICkge1xyXG5cclxuXHRcdFx0XHQvLyBmb3Igc3ByaXRlc1xyXG5cclxuXHRcdFx0XHRfZGlyZWN0aW9uYWxMaWdodHMuYWRkKCBsaWdodENvbG9yICk7XHJcblxyXG5cdFx0XHR9IGVsc2UgaWYgKCBsaWdodCBpbnN0YW5jZW9mIFRIUkVFLlBvaW50TGlnaHQgKSB7XHJcblxyXG5cdFx0XHRcdC8vIGZvciBzcHJpdGVzXHJcblxyXG5cdFx0XHRcdF9wb2ludExpZ2h0cy5hZGQoIGxpZ2h0Q29sb3IgKTtcclxuXHJcblx0XHRcdH1cclxuXHJcblx0XHR9XHJcblxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gY2FsY3VsYXRlTGlnaHQoIHBvc2l0aW9uLCBub3JtYWwsIGNvbG9yICkge1xyXG5cclxuXHRcdGZvciAoIHZhciBsID0gMCwgbGwgPSBfbGlnaHRzLmxlbmd0aDsgbCA8IGxsOyBsICsrICkge1xyXG5cclxuXHRcdFx0dmFyIGxpZ2h0ID0gX2xpZ2h0c1sgbCBdO1xyXG5cclxuXHRcdFx0X2xpZ2h0Q29sb3IuY29weSggbGlnaHQuY29sb3IgKTtcclxuXHJcblx0XHRcdGlmICggbGlnaHQgaW5zdGFuY2VvZiBUSFJFRS5EaXJlY3Rpb25hbExpZ2h0ICkge1xyXG5cclxuXHRcdFx0XHR2YXIgbGlnaHRQb3NpdGlvbiA9IF92ZWN0b3IzLnNldEZyb21NYXRyaXhQb3NpdGlvbiggbGlnaHQubWF0cml4V29ybGQgKS5ub3JtYWxpemUoKTtcclxuXHJcblx0XHRcdFx0dmFyIGFtb3VudCA9IG5vcm1hbC5kb3QoIGxpZ2h0UG9zaXRpb24gKTtcclxuXHJcblx0XHRcdFx0aWYgKCBhbW91bnQgPD0gMCApIGNvbnRpbnVlO1xyXG5cclxuXHRcdFx0XHRhbW91bnQgKj0gbGlnaHQuaW50ZW5zaXR5O1xyXG5cclxuXHRcdFx0XHRjb2xvci5hZGQoIF9saWdodENvbG9yLm11bHRpcGx5U2NhbGFyKCBhbW91bnQgKSApO1xyXG5cclxuXHRcdFx0fSBlbHNlIGlmICggbGlnaHQgaW5zdGFuY2VvZiBUSFJFRS5Qb2ludExpZ2h0ICkge1xyXG5cclxuXHRcdFx0XHR2YXIgbGlnaHRQb3NpdGlvbiA9IF92ZWN0b3IzLnNldEZyb21NYXRyaXhQb3NpdGlvbiggbGlnaHQubWF0cml4V29ybGQgKTtcclxuXHJcblx0XHRcdFx0dmFyIGFtb3VudCA9IG5vcm1hbC5kb3QoIF92ZWN0b3IzLnN1YlZlY3RvcnMoIGxpZ2h0UG9zaXRpb24sIHBvc2l0aW9uICkubm9ybWFsaXplKCkgKTtcclxuXHJcblx0XHRcdFx0aWYgKCBhbW91bnQgPD0gMCApIGNvbnRpbnVlO1xyXG5cclxuXHRcdFx0XHRhbW91bnQgKj0gbGlnaHQuZGlzdGFuY2UgPT0gMCA/IDEgOiAxIC0gTWF0aC5taW4oIHBvc2l0aW9uLmRpc3RhbmNlVG8oIGxpZ2h0UG9zaXRpb24gKSAvIGxpZ2h0LmRpc3RhbmNlLCAxICk7XHJcblxyXG5cdFx0XHRcdGlmICggYW1vdW50ID09IDAgKSBjb250aW51ZTtcclxuXHJcblx0XHRcdFx0YW1vdW50ICo9IGxpZ2h0LmludGVuc2l0eTtcclxuXHJcblx0XHRcdFx0Y29sb3IuYWRkKCBfbGlnaHRDb2xvci5tdWx0aXBseVNjYWxhciggYW1vdW50ICkgKTtcclxuXHJcblx0XHRcdH1cclxuXHJcblx0XHR9XHJcblxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gcmVuZGVyU3ByaXRlKCB2MSwgZWxlbWVudCwgbWF0ZXJpYWwgKSB7XHJcblxyXG5cdFx0c2V0T3BhY2l0eSggbWF0ZXJpYWwub3BhY2l0eSApO1xyXG5cdFx0c2V0QmxlbmRpbmcoIG1hdGVyaWFsLmJsZW5kaW5nICk7XHJcblxyXG5cdFx0dmFyIHNjYWxlWCA9IGVsZW1lbnQuc2NhbGUueCAqIF9jYW52YXNXaWR0aEhhbGY7XHJcblx0XHR2YXIgc2NhbGVZID0gZWxlbWVudC5zY2FsZS55ICogX2NhbnZhc0hlaWdodEhhbGY7XHJcblxyXG5cdFx0dmFyIGRpc3QgPSAwLjUgKiBNYXRoLnNxcnQoIHNjYWxlWCAqIHNjYWxlWCArIHNjYWxlWSAqIHNjYWxlWSApOyAvLyBhbGxvdyBmb3Igcm90YXRlZCBzcHJpdGVcclxuXHRcdF9lbGVtQm94Lm1pbi5zZXQoIHYxLnggLSBkaXN0LCB2MS55IC0gZGlzdCApO1xyXG5cdFx0X2VsZW1Cb3gubWF4LnNldCggdjEueCArIGRpc3QsIHYxLnkgKyBkaXN0ICk7XHJcblxyXG5cdFx0aWYgKCBtYXRlcmlhbCBpbnN0YW5jZW9mIFRIUkVFLlNwcml0ZU1hdGVyaWFsICkge1xyXG5cclxuXHRcdFx0dmFyIHRleHR1cmUgPSBtYXRlcmlhbC5tYXA7XHJcblxyXG5cdFx0XHRpZiAoIHRleHR1cmUgIT09IG51bGwgKSB7XHJcblxyXG5cdFx0XHRcdHZhciBwYXR0ZXJuID0gX3BhdHRlcm5zWyB0ZXh0dXJlLmlkIF07XHJcblxyXG5cdFx0XHRcdGlmICggcGF0dGVybiA9PT0gdW5kZWZpbmVkIHx8IHBhdHRlcm4udmVyc2lvbiAhPT0gdGV4dHVyZS52ZXJzaW9uICkge1xyXG5cclxuXHRcdFx0XHRcdHBhdHRlcm4gPSB0ZXh0dXJlVG9QYXR0ZXJuKCB0ZXh0dXJlICk7XHJcblx0XHRcdFx0XHRfcGF0dGVybnNbIHRleHR1cmUuaWQgXSA9IHBhdHRlcm47XHJcblxyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0aWYgKCBwYXR0ZXJuLmNhbnZhcyAhPT0gdW5kZWZpbmVkICkge1xyXG5cclxuXHRcdFx0XHRcdHNldEZpbGxTdHlsZSggcGF0dGVybi5jYW52YXMgKTtcclxuXHJcblx0XHRcdFx0XHR2YXIgYml0bWFwID0gdGV4dHVyZS5pbWFnZTtcclxuXHJcblx0XHRcdFx0XHR2YXIgb3ggPSBiaXRtYXAud2lkdGggKiB0ZXh0dXJlLm9mZnNldC54O1xyXG5cdFx0XHRcdFx0dmFyIG95ID0gYml0bWFwLmhlaWdodCAqIHRleHR1cmUub2Zmc2V0Lnk7XHJcblxyXG5cdFx0XHRcdFx0dmFyIHN4ID0gYml0bWFwLndpZHRoICogdGV4dHVyZS5yZXBlYXQueDtcclxuXHRcdFx0XHRcdHZhciBzeSA9IGJpdG1hcC5oZWlnaHQgKiB0ZXh0dXJlLnJlcGVhdC55O1xyXG5cclxuXHRcdFx0XHRcdHZhciBjeCA9IHNjYWxlWCAvIHN4O1xyXG5cdFx0XHRcdFx0dmFyIGN5ID0gc2NhbGVZIC8gc3k7XHJcblxyXG5cdFx0XHRcdFx0X2NvbnRleHQuc2F2ZSgpO1xyXG5cdFx0XHRcdFx0X2NvbnRleHQudHJhbnNsYXRlKCB2MS54LCB2MS55ICk7XHJcblx0XHRcdFx0XHRpZiAoIG1hdGVyaWFsLnJvdGF0aW9uICE9PSAwICkgX2NvbnRleHQucm90YXRlKCBtYXRlcmlhbC5yb3RhdGlvbiApO1xyXG5cdFx0XHRcdFx0X2NvbnRleHQudHJhbnNsYXRlKCAtIHNjYWxlWCAvIDIsIC0gc2NhbGVZIC8gMiApO1xyXG5cdFx0XHRcdFx0X2NvbnRleHQuc2NhbGUoIGN4LCBjeSApO1xyXG5cdFx0XHRcdFx0X2NvbnRleHQudHJhbnNsYXRlKCAtIG94LCAtIG95ICk7XHJcblx0XHRcdFx0XHRfY29udGV4dC5maWxsUmVjdCggb3gsIG95LCBzeCwgc3kgKTtcclxuXHRcdFx0XHRcdF9jb250ZXh0LnJlc3RvcmUoKTtcclxuXHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0fSBlbHNlIHtcclxuXHJcblx0XHRcdFx0Ly8gbm8gdGV4dHVyZVxyXG5cclxuXHRcdFx0XHRzZXRGaWxsU3R5bGUoIG1hdGVyaWFsLmNvbG9yLmdldFN0eWxlKCkgKTtcclxuXHJcblx0XHRcdFx0X2NvbnRleHQuc2F2ZSgpO1xyXG5cdFx0XHRcdF9jb250ZXh0LnRyYW5zbGF0ZSggdjEueCwgdjEueSApO1xyXG5cdFx0XHRcdGlmICggbWF0ZXJpYWwucm90YXRpb24gIT09IDAgKSBfY29udGV4dC5yb3RhdGUoIG1hdGVyaWFsLnJvdGF0aW9uICk7XHJcblx0XHRcdFx0X2NvbnRleHQuc2NhbGUoIHNjYWxlWCwgLSBzY2FsZVkgKTtcclxuXHRcdFx0XHRfY29udGV4dC5maWxsUmVjdCggLSAwLjUsIC0gMC41LCAxLCAxICk7XHJcblx0XHRcdFx0X2NvbnRleHQucmVzdG9yZSgpO1xyXG5cclxuXHRcdFx0fVxyXG5cclxuXHRcdH0gZWxzZSBpZiAoIG1hdGVyaWFsIGluc3RhbmNlb2YgVEhSRUUuU3ByaXRlQ2FudmFzTWF0ZXJpYWwgKSB7XHJcblxyXG5cdFx0XHRzZXRTdHJva2VTdHlsZSggbWF0ZXJpYWwuY29sb3IuZ2V0U3R5bGUoKSApO1xyXG5cdFx0XHRzZXRGaWxsU3R5bGUoIG1hdGVyaWFsLmNvbG9yLmdldFN0eWxlKCkgKTtcclxuXHJcblx0XHRcdF9jb250ZXh0LnNhdmUoKTtcclxuXHRcdFx0X2NvbnRleHQudHJhbnNsYXRlKCB2MS54LCB2MS55ICk7XHJcblx0XHRcdGlmICggbWF0ZXJpYWwucm90YXRpb24gIT09IDAgKSBfY29udGV4dC5yb3RhdGUoIG1hdGVyaWFsLnJvdGF0aW9uICk7XHJcblx0XHRcdF9jb250ZXh0LnNjYWxlKCBzY2FsZVgsIHNjYWxlWSApO1xyXG5cclxuXHRcdFx0bWF0ZXJpYWwucHJvZ3JhbSggX2NvbnRleHQgKTtcclxuXHJcblx0XHRcdF9jb250ZXh0LnJlc3RvcmUoKTtcclxuXHJcblx0XHR9XHJcblxyXG5cdFx0LyogREVCVUdcclxuXHRcdHNldFN0cm9rZVN0eWxlKCAncmdiKDI1NSwyNTUsMCknICk7XHJcblx0XHRfY29udGV4dC5iZWdpblBhdGgoKTtcclxuXHRcdF9jb250ZXh0Lm1vdmVUbyggdjEueCAtIDEwLCB2MS55ICk7XHJcblx0XHRfY29udGV4dC5saW5lVG8oIHYxLnggKyAxMCwgdjEueSApO1xyXG5cdFx0X2NvbnRleHQubW92ZVRvKCB2MS54LCB2MS55IC0gMTAgKTtcclxuXHRcdF9jb250ZXh0LmxpbmVUbyggdjEueCwgdjEueSArIDEwICk7XHJcblx0XHRfY29udGV4dC5zdHJva2UoKTtcclxuXHRcdCovXHJcblxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gcmVuZGVyTGluZSggdjEsIHYyLCBlbGVtZW50LCBtYXRlcmlhbCApIHtcclxuXHJcblx0XHRzZXRPcGFjaXR5KCBtYXRlcmlhbC5vcGFjaXR5ICk7XHJcblx0XHRzZXRCbGVuZGluZyggbWF0ZXJpYWwuYmxlbmRpbmcgKTtcclxuXHJcblx0XHRfY29udGV4dC5iZWdpblBhdGgoKTtcclxuXHRcdF9jb250ZXh0Lm1vdmVUbyggdjEucG9zaXRpb25TY3JlZW4ueCwgdjEucG9zaXRpb25TY3JlZW4ueSApO1xyXG5cdFx0X2NvbnRleHQubGluZVRvKCB2Mi5wb3NpdGlvblNjcmVlbi54LCB2Mi5wb3NpdGlvblNjcmVlbi55ICk7XHJcblxyXG5cdFx0aWYgKCBtYXRlcmlhbCBpbnN0YW5jZW9mIFRIUkVFLkxpbmVCYXNpY01hdGVyaWFsICkge1xyXG5cclxuXHRcdFx0c2V0TGluZVdpZHRoKCBtYXRlcmlhbC5saW5ld2lkdGggKTtcclxuXHRcdFx0c2V0TGluZUNhcCggbWF0ZXJpYWwubGluZWNhcCApO1xyXG5cdFx0XHRzZXRMaW5lSm9pbiggbWF0ZXJpYWwubGluZWpvaW4gKTtcclxuXHJcblx0XHRcdGlmICggbWF0ZXJpYWwudmVydGV4Q29sb3JzICE9PSBUSFJFRS5WZXJ0ZXhDb2xvcnMgKSB7XHJcblxyXG5cdFx0XHRcdHNldFN0cm9rZVN0eWxlKCBtYXRlcmlhbC5jb2xvci5nZXRTdHlsZSgpICk7XHJcblxyXG5cdFx0XHR9IGVsc2Uge1xyXG5cclxuXHRcdFx0XHR2YXIgY29sb3JTdHlsZTEgPSBlbGVtZW50LnZlcnRleENvbG9yc1sgMCBdLmdldFN0eWxlKCk7XHJcblx0XHRcdFx0dmFyIGNvbG9yU3R5bGUyID0gZWxlbWVudC52ZXJ0ZXhDb2xvcnNbIDEgXS5nZXRTdHlsZSgpO1xyXG5cclxuXHRcdFx0XHRpZiAoIGNvbG9yU3R5bGUxID09PSBjb2xvclN0eWxlMiApIHtcclxuXHJcblx0XHRcdFx0XHRzZXRTdHJva2VTdHlsZSggY29sb3JTdHlsZTEgKTtcclxuXHJcblx0XHRcdFx0fSBlbHNlIHtcclxuXHJcblx0XHRcdFx0XHR0cnkge1xyXG5cclxuXHRcdFx0XHRcdFx0dmFyIGdyYWQgPSBfY29udGV4dC5jcmVhdGVMaW5lYXJHcmFkaWVudChcclxuXHRcdFx0XHRcdFx0XHR2MS5wb3NpdGlvblNjcmVlbi54LFxyXG5cdFx0XHRcdFx0XHRcdHYxLnBvc2l0aW9uU2NyZWVuLnksXHJcblx0XHRcdFx0XHRcdFx0djIucG9zaXRpb25TY3JlZW4ueCxcclxuXHRcdFx0XHRcdFx0XHR2Mi5wb3NpdGlvblNjcmVlbi55XHJcblx0XHRcdFx0XHRcdCk7XHJcblx0XHRcdFx0XHRcdGdyYWQuYWRkQ29sb3JTdG9wKCAwLCBjb2xvclN0eWxlMSApO1xyXG5cdFx0XHRcdFx0XHRncmFkLmFkZENvbG9yU3RvcCggMSwgY29sb3JTdHlsZTIgKTtcclxuXHJcblx0XHRcdFx0XHR9IGNhdGNoICggZXhjZXB0aW9uICkge1xyXG5cclxuXHRcdFx0XHRcdFx0Z3JhZCA9IGNvbG9yU3R5bGUxO1xyXG5cclxuXHRcdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0XHRzZXRTdHJva2VTdHlsZSggZ3JhZCApO1xyXG5cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRfY29udGV4dC5zdHJva2UoKTtcclxuXHRcdFx0X2VsZW1Cb3guZXhwYW5kQnlTY2FsYXIoIG1hdGVyaWFsLmxpbmV3aWR0aCAqIDIgKTtcclxuXHJcblx0XHR9IGVsc2UgaWYgKCBtYXRlcmlhbCBpbnN0YW5jZW9mIFRIUkVFLkxpbmVEYXNoZWRNYXRlcmlhbCApIHtcclxuXHJcblx0XHRcdHNldExpbmVXaWR0aCggbWF0ZXJpYWwubGluZXdpZHRoICk7XHJcblx0XHRcdHNldExpbmVDYXAoIG1hdGVyaWFsLmxpbmVjYXAgKTtcclxuXHRcdFx0c2V0TGluZUpvaW4oIG1hdGVyaWFsLmxpbmVqb2luICk7XHJcblx0XHRcdHNldFN0cm9rZVN0eWxlKCBtYXRlcmlhbC5jb2xvci5nZXRTdHlsZSgpICk7XHJcblx0XHRcdHNldExpbmVEYXNoKCBbIG1hdGVyaWFsLmRhc2hTaXplLCBtYXRlcmlhbC5nYXBTaXplIF0gKTtcclxuXHJcblx0XHRcdF9jb250ZXh0LnN0cm9rZSgpO1xyXG5cclxuXHRcdFx0X2VsZW1Cb3guZXhwYW5kQnlTY2FsYXIoIG1hdGVyaWFsLmxpbmV3aWR0aCAqIDIgKTtcclxuXHJcblx0XHRcdHNldExpbmVEYXNoKCBbXSApO1xyXG5cclxuXHRcdH1cclxuXHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiByZW5kZXJGYWNlMyggdjEsIHYyLCB2MywgdXYxLCB1djIsIHV2MywgZWxlbWVudCwgbWF0ZXJpYWwgKSB7XHJcblxyXG5cdFx0X3RoaXMuaW5mby5yZW5kZXIudmVydGljZXMgKz0gMztcclxuXHRcdF90aGlzLmluZm8ucmVuZGVyLmZhY2VzICsrO1xyXG5cclxuXHRcdHNldE9wYWNpdHkoIG1hdGVyaWFsLm9wYWNpdHkgKTtcclxuXHRcdHNldEJsZW5kaW5nKCBtYXRlcmlhbC5ibGVuZGluZyApO1xyXG5cclxuXHRcdF92MXggPSB2MS5wb3NpdGlvblNjcmVlbi54OyBfdjF5ID0gdjEucG9zaXRpb25TY3JlZW4ueTtcclxuXHRcdF92MnggPSB2Mi5wb3NpdGlvblNjcmVlbi54OyBfdjJ5ID0gdjIucG9zaXRpb25TY3JlZW4ueTtcclxuXHRcdF92M3ggPSB2My5wb3NpdGlvblNjcmVlbi54OyBfdjN5ID0gdjMucG9zaXRpb25TY3JlZW4ueTtcclxuXHJcblx0XHRkcmF3VHJpYW5nbGUoIF92MXgsIF92MXksIF92MngsIF92MnksIF92M3gsIF92M3kgKTtcclxuXHJcblx0XHRpZiAoICggbWF0ZXJpYWwgaW5zdGFuY2VvZiBUSFJFRS5NZXNoTGFtYmVydE1hdGVyaWFsIHx8IG1hdGVyaWFsIGluc3RhbmNlb2YgVEhSRUUuTWVzaFBob25nTWF0ZXJpYWwgKSAmJiBtYXRlcmlhbC5tYXAgPT09IG51bGwgKSB7XHJcblxyXG5cdFx0XHRfZGlmZnVzZUNvbG9yLmNvcHkoIG1hdGVyaWFsLmNvbG9yICk7XHJcblx0XHRcdF9lbWlzc2l2ZUNvbG9yLmNvcHkoIG1hdGVyaWFsLmVtaXNzaXZlICk7XHJcblxyXG5cdFx0XHRpZiAoIG1hdGVyaWFsLnZlcnRleENvbG9ycyA9PT0gVEhSRUUuRmFjZUNvbG9ycyApIHtcclxuXHJcblx0XHRcdFx0X2RpZmZ1c2VDb2xvci5tdWx0aXBseSggZWxlbWVudC5jb2xvciApO1xyXG5cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0X2NvbG9yLmNvcHkoIF9hbWJpZW50TGlnaHQgKTtcclxuXHJcblx0XHRcdF9jZW50cm9pZC5jb3B5KCB2MS5wb3NpdGlvbldvcmxkICkuYWRkKCB2Mi5wb3NpdGlvbldvcmxkICkuYWRkKCB2My5wb3NpdGlvbldvcmxkICkuZGl2aWRlU2NhbGFyKCAzICk7XHJcblxyXG5cdFx0XHRjYWxjdWxhdGVMaWdodCggX2NlbnRyb2lkLCBlbGVtZW50Lm5vcm1hbE1vZGVsLCBfY29sb3IgKTtcclxuXHJcblx0XHRcdF9jb2xvci5tdWx0aXBseSggX2RpZmZ1c2VDb2xvciApLmFkZCggX2VtaXNzaXZlQ29sb3IgKTtcclxuXHJcblx0XHRcdG1hdGVyaWFsLndpcmVmcmFtZSA9PT0gdHJ1ZVxyXG5cdFx0XHRcdCA/IHN0cm9rZVBhdGgoIF9jb2xvciwgbWF0ZXJpYWwud2lyZWZyYW1lTGluZXdpZHRoLCBtYXRlcmlhbC53aXJlZnJhbWVMaW5lY2FwLCBtYXRlcmlhbC53aXJlZnJhbWVMaW5lam9pbiApXHJcblx0XHRcdFx0IDogZmlsbFBhdGgoIF9jb2xvciApO1xyXG5cclxuXHRcdH0gZWxzZSBpZiAoIG1hdGVyaWFsIGluc3RhbmNlb2YgVEhSRUUuTWVzaEJhc2ljTWF0ZXJpYWwgfHxcclxuXHRcdFx0XHQgICAgbWF0ZXJpYWwgaW5zdGFuY2VvZiBUSFJFRS5NZXNoTGFtYmVydE1hdGVyaWFsIHx8XHJcblx0XHRcdFx0ICAgIG1hdGVyaWFsIGluc3RhbmNlb2YgVEhSRUUuTWVzaFBob25nTWF0ZXJpYWwgKSB7XHJcblxyXG5cdFx0XHRpZiAoIG1hdGVyaWFsLm1hcCAhPT0gbnVsbCApIHtcclxuXHJcblx0XHRcdFx0dmFyIG1hcHBpbmcgPSBtYXRlcmlhbC5tYXAubWFwcGluZztcclxuXHJcblx0XHRcdFx0aWYgKCBtYXBwaW5nID09PSBUSFJFRS5VVk1hcHBpbmcgKSB7XHJcblxyXG5cdFx0XHRcdFx0X3V2cyA9IGVsZW1lbnQudXZzO1xyXG5cdFx0XHRcdFx0cGF0dGVyblBhdGgoIF92MXgsIF92MXksIF92MngsIF92MnksIF92M3gsIF92M3ksIF91dnNbIHV2MSBdLngsIF91dnNbIHV2MSBdLnksIF91dnNbIHV2MiBdLngsIF91dnNbIHV2MiBdLnksIF91dnNbIHV2MyBdLngsIF91dnNbIHV2MyBdLnksIG1hdGVyaWFsLm1hcCApO1xyXG5cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHR9IGVsc2UgaWYgKCBtYXRlcmlhbC5lbnZNYXAgIT09IG51bGwgKSB7XHJcblxyXG5cdFx0XHRcdGlmICggbWF0ZXJpYWwuZW52TWFwLm1hcHBpbmcgPT09IFRIUkVFLlNwaGVyaWNhbFJlZmxlY3Rpb25NYXBwaW5nICkge1xyXG5cclxuXHRcdFx0XHRcdF9ub3JtYWwuY29weSggZWxlbWVudC52ZXJ0ZXhOb3JtYWxzTW9kZWxbIHV2MSBdICkuYXBwbHlNYXRyaXgzKCBfbm9ybWFsVmlld01hdHJpeCApO1xyXG5cdFx0XHRcdFx0X3V2MXggPSAwLjUgKiBfbm9ybWFsLnggKyAwLjU7XHJcblx0XHRcdFx0XHRfdXYxeSA9IDAuNSAqIF9ub3JtYWwueSArIDAuNTtcclxuXHJcblx0XHRcdFx0XHRfbm9ybWFsLmNvcHkoIGVsZW1lbnQudmVydGV4Tm9ybWFsc01vZGVsWyB1djIgXSApLmFwcGx5TWF0cml4MyggX25vcm1hbFZpZXdNYXRyaXggKTtcclxuXHRcdFx0XHRcdF91djJ4ID0gMC41ICogX25vcm1hbC54ICsgMC41O1xyXG5cdFx0XHRcdFx0X3V2MnkgPSAwLjUgKiBfbm9ybWFsLnkgKyAwLjU7XHJcblxyXG5cdFx0XHRcdFx0X25vcm1hbC5jb3B5KCBlbGVtZW50LnZlcnRleE5vcm1hbHNNb2RlbFsgdXYzIF0gKS5hcHBseU1hdHJpeDMoIF9ub3JtYWxWaWV3TWF0cml4ICk7XHJcblx0XHRcdFx0XHRfdXYzeCA9IDAuNSAqIF9ub3JtYWwueCArIDAuNTtcclxuXHRcdFx0XHRcdF91djN5ID0gMC41ICogX25vcm1hbC55ICsgMC41O1xyXG5cclxuXHRcdFx0XHRcdHBhdHRlcm5QYXRoKCBfdjF4LCBfdjF5LCBfdjJ4LCBfdjJ5LCBfdjN4LCBfdjN5LCBfdXYxeCwgX3V2MXksIF91djJ4LCBfdXYyeSwgX3V2M3gsIF91djN5LCBtYXRlcmlhbC5lbnZNYXAgKTtcclxuXHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0fSBlbHNlIHtcclxuXHJcblx0XHRcdFx0X2NvbG9yLmNvcHkoIG1hdGVyaWFsLmNvbG9yICk7XHJcblxyXG5cdFx0XHRcdGlmICggbWF0ZXJpYWwudmVydGV4Q29sb3JzID09PSBUSFJFRS5GYWNlQ29sb3JzICkge1xyXG5cclxuXHRcdFx0XHRcdF9jb2xvci5tdWx0aXBseSggZWxlbWVudC5jb2xvciApO1xyXG5cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdG1hdGVyaWFsLndpcmVmcmFtZSA9PT0gdHJ1ZVxyXG5cdFx0XHRcdFx0ID8gc3Ryb2tlUGF0aCggX2NvbG9yLCBtYXRlcmlhbC53aXJlZnJhbWVMaW5ld2lkdGgsIG1hdGVyaWFsLndpcmVmcmFtZUxpbmVjYXAsIG1hdGVyaWFsLndpcmVmcmFtZUxpbmVqb2luIClcclxuXHRcdFx0XHRcdCA6IGZpbGxQYXRoKCBfY29sb3IgKTtcclxuXHJcblx0XHRcdH1cclxuXHJcblx0XHR9IGVsc2UgaWYgKCBtYXRlcmlhbCBpbnN0YW5jZW9mIFRIUkVFLk1lc2hOb3JtYWxNYXRlcmlhbCApIHtcclxuXHJcblx0XHRcdF9ub3JtYWwuY29weSggZWxlbWVudC5ub3JtYWxNb2RlbCApLmFwcGx5TWF0cml4MyggX25vcm1hbFZpZXdNYXRyaXggKTtcclxuXHJcblx0XHRcdF9jb2xvci5zZXRSR0IoIF9ub3JtYWwueCwgX25vcm1hbC55LCBfbm9ybWFsLnogKS5tdWx0aXBseVNjYWxhciggMC41ICkuYWRkU2NhbGFyKCAwLjUgKTtcclxuXHJcblx0XHRcdG1hdGVyaWFsLndpcmVmcmFtZSA9PT0gdHJ1ZVxyXG5cdFx0XHRcdCA/IHN0cm9rZVBhdGgoIF9jb2xvciwgbWF0ZXJpYWwud2lyZWZyYW1lTGluZXdpZHRoLCBtYXRlcmlhbC53aXJlZnJhbWVMaW5lY2FwLCBtYXRlcmlhbC53aXJlZnJhbWVMaW5lam9pbiApXHJcblx0XHRcdFx0IDogZmlsbFBhdGgoIF9jb2xvciApO1xyXG5cclxuXHRcdH0gZWxzZSB7XHJcblxyXG5cdFx0XHRfY29sb3Iuc2V0UkdCKCAxLCAxLCAxICk7XHJcblxyXG5cdFx0XHRtYXRlcmlhbC53aXJlZnJhbWUgPT09IHRydWVcclxuXHRcdFx0XHQgPyBzdHJva2VQYXRoKCBfY29sb3IsIG1hdGVyaWFsLndpcmVmcmFtZUxpbmV3aWR0aCwgbWF0ZXJpYWwud2lyZWZyYW1lTGluZWNhcCwgbWF0ZXJpYWwud2lyZWZyYW1lTGluZWpvaW4gKVxyXG5cdFx0XHRcdCA6IGZpbGxQYXRoKCBfY29sb3IgKTtcclxuXHJcblx0XHR9XHJcblxyXG5cdH1cclxuXHJcblx0Ly9cclxuXHJcblx0ZnVuY3Rpb24gZHJhd1RyaWFuZ2xlKCB4MCwgeTAsIHgxLCB5MSwgeDIsIHkyICkge1xyXG5cclxuXHRcdF9jb250ZXh0LmJlZ2luUGF0aCgpO1xyXG5cdFx0X2NvbnRleHQubW92ZVRvKCB4MCwgeTAgKTtcclxuXHRcdF9jb250ZXh0LmxpbmVUbyggeDEsIHkxICk7XHJcblx0XHRfY29udGV4dC5saW5lVG8oIHgyLCB5MiApO1xyXG5cdFx0X2NvbnRleHQuY2xvc2VQYXRoKCk7XHJcblxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gc3Ryb2tlUGF0aCggY29sb3IsIGxpbmV3aWR0aCwgbGluZWNhcCwgbGluZWpvaW4gKSB7XHJcblxyXG5cdFx0c2V0TGluZVdpZHRoKCBsaW5ld2lkdGggKTtcclxuXHRcdHNldExpbmVDYXAoIGxpbmVjYXAgKTtcclxuXHRcdHNldExpbmVKb2luKCBsaW5lam9pbiApO1xyXG5cdFx0c2V0U3Ryb2tlU3R5bGUoIGNvbG9yLmdldFN0eWxlKCkgKTtcclxuXHJcblx0XHRfY29udGV4dC5zdHJva2UoKTtcclxuXHJcblx0XHRfZWxlbUJveC5leHBhbmRCeVNjYWxhciggbGluZXdpZHRoICogMiApO1xyXG5cclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIGZpbGxQYXRoKCBjb2xvciApIHtcclxuXHJcblx0XHRzZXRGaWxsU3R5bGUoIGNvbG9yLmdldFN0eWxlKCkgKTtcclxuXHRcdF9jb250ZXh0LmZpbGwoKTtcclxuXHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiB0ZXh0dXJlVG9QYXR0ZXJuKCB0ZXh0dXJlICkge1xyXG5cclxuXHRcdGlmICggdGV4dHVyZS52ZXJzaW9uID09PSAwIHx8XHJcblx0XHRcdHRleHR1cmUgaW5zdGFuY2VvZiBUSFJFRS5Db21wcmVzc2VkVGV4dHVyZSB8fFxyXG5cdFx0XHR0ZXh0dXJlIGluc3RhbmNlb2YgVEhSRUUuRGF0YVRleHR1cmUgKSB7XHJcblxyXG5cdFx0XHRyZXR1cm4ge1xyXG5cdFx0XHRcdFx0Y2FudmFzOiB1bmRlZmluZWQsXHJcblx0XHRcdFx0XHR2ZXJzaW9uOiB0ZXh0dXJlLnZlcnNpb25cclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0fVxyXG5cclxuXHRcdHZhciBpbWFnZSA9IHRleHR1cmUuaW1hZ2U7XHJcblxyXG5cdFx0dmFyIGNhbnZhcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICdjYW52YXMnICk7XHJcblx0XHRjYW52YXMud2lkdGggPSBpbWFnZS53aWR0aDtcclxuXHRcdGNhbnZhcy5oZWlnaHQgPSBpbWFnZS5oZWlnaHQ7XHJcblxyXG5cdFx0dmFyIGNvbnRleHQgPSBjYW52YXMuZ2V0Q29udGV4dCggJzJkJyApO1xyXG5cdFx0Y29udGV4dC5zZXRUcmFuc2Zvcm0oIDEsIDAsIDAsIC0gMSwgMCwgaW1hZ2UuaGVpZ2h0ICk7XHJcblx0XHRjb250ZXh0LmRyYXdJbWFnZSggaW1hZ2UsIDAsIDAgKTtcclxuXHJcblx0XHR2YXIgcmVwZWF0WCA9IHRleHR1cmUud3JhcFMgPT09IFRIUkVFLlJlcGVhdFdyYXBwaW5nO1xyXG5cdFx0dmFyIHJlcGVhdFkgPSB0ZXh0dXJlLndyYXBUID09PSBUSFJFRS5SZXBlYXRXcmFwcGluZztcclxuXHJcblx0XHR2YXIgcmVwZWF0ID0gJ25vLXJlcGVhdCc7XHJcblxyXG5cdFx0aWYgKCByZXBlYXRYID09PSB0cnVlICYmIHJlcGVhdFkgPT09IHRydWUgKSB7XHJcblxyXG5cdFx0XHRyZXBlYXQgPSAncmVwZWF0JztcclxuXHJcblx0XHR9IGVsc2UgaWYgKCByZXBlYXRYID09PSB0cnVlICkge1xyXG5cclxuXHRcdFx0cmVwZWF0ID0gJ3JlcGVhdC14JztcclxuXHJcblx0XHR9IGVsc2UgaWYgKCByZXBlYXRZID09PSB0cnVlICkge1xyXG5cclxuXHRcdFx0cmVwZWF0ID0gJ3JlcGVhdC15JztcclxuXHJcblx0XHR9XHJcblxyXG5cdFx0cmV0dXJuIHtcclxuXHRcdFx0Y2FudmFzOiBfY29udGV4dC5jcmVhdGVQYXR0ZXJuKCBjYW52YXMsIHJlcGVhdCApLFxyXG5cdFx0XHR2ZXJzaW9uOiB0ZXh0dXJlLnZlcnNpb25cclxuXHRcdH1cclxuXHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBwYXR0ZXJuUGF0aCggeDAsIHkwLCB4MSwgeTEsIHgyLCB5MiwgdTAsIHYwLCB1MSwgdjEsIHUyLCB2MiwgdGV4dHVyZSApIHtcclxuXHJcblx0XHR2YXIgcGF0dGVybiA9IF9wYXR0ZXJuc1sgdGV4dHVyZS5pZCBdO1xyXG5cclxuXHRcdGlmICggcGF0dGVybiA9PT0gdW5kZWZpbmVkIHx8IHBhdHRlcm4udmVyc2lvbiAhPT0gdGV4dHVyZS52ZXJzaW9uICkge1xyXG5cclxuXHRcdFx0cGF0dGVybiA9IHRleHR1cmVUb1BhdHRlcm4oIHRleHR1cmUgKTtcclxuXHRcdFx0X3BhdHRlcm5zWyB0ZXh0dXJlLmlkIF0gPSBwYXR0ZXJuO1xyXG5cclxuXHRcdH1cclxuXHJcblx0XHRpZiAoIHBhdHRlcm4uY2FudmFzICE9PSB1bmRlZmluZWQgKSB7XHJcblxyXG5cdFx0XHRzZXRGaWxsU3R5bGUoIHBhdHRlcm4uY2FudmFzICk7XHJcblxyXG5cdFx0fSBlbHNlIHtcclxuXHJcblx0XHRcdHNldEZpbGxTdHlsZSggJ3JnYmEoIDAsIDAsIDAsIDEpJyApO1xyXG5cdFx0XHRfY29udGV4dC5maWxsKCk7XHJcblx0XHRcdHJldHVybjtcclxuXHJcblx0XHR9XHJcblxyXG5cdFx0Ly8gaHR0cDovL2V4dHJlbWVseXNhdGlzZmFjdG9yeXRvdGFsaXRhcmlhbmlzbS5jb20vYmxvZy8/cD0yMTIwXHJcblxyXG5cdFx0dmFyIGEsIGIsIGMsIGQsIGUsIGYsIGRldCwgaWRldCxcclxuXHRcdG9mZnNldFggPSB0ZXh0dXJlLm9mZnNldC54IC8gdGV4dHVyZS5yZXBlYXQueCxcclxuXHRcdG9mZnNldFkgPSB0ZXh0dXJlLm9mZnNldC55IC8gdGV4dHVyZS5yZXBlYXQueSxcclxuXHRcdHdpZHRoID0gdGV4dHVyZS5pbWFnZS53aWR0aCAqIHRleHR1cmUucmVwZWF0LngsXHJcblx0XHRoZWlnaHQgPSB0ZXh0dXJlLmltYWdlLmhlaWdodCAqIHRleHR1cmUucmVwZWF0Lnk7XHJcblxyXG5cdFx0dTAgPSAoIHUwICsgb2Zmc2V0WCApICogd2lkdGg7XHJcblx0XHR2MCA9ICggdjAgKyBvZmZzZXRZICkgKiBoZWlnaHQ7XHJcblxyXG5cdFx0dTEgPSAoIHUxICsgb2Zmc2V0WCApICogd2lkdGg7XHJcblx0XHR2MSA9ICggdjEgKyBvZmZzZXRZICkgKiBoZWlnaHQ7XHJcblxyXG5cdFx0dTIgPSAoIHUyICsgb2Zmc2V0WCApICogd2lkdGg7XHJcblx0XHR2MiA9ICggdjIgKyBvZmZzZXRZICkgKiBoZWlnaHQ7XHJcblxyXG5cdFx0eDEgLT0geDA7IHkxIC09IHkwO1xyXG5cdFx0eDIgLT0geDA7IHkyIC09IHkwO1xyXG5cclxuXHRcdHUxIC09IHUwOyB2MSAtPSB2MDtcclxuXHRcdHUyIC09IHUwOyB2MiAtPSB2MDtcclxuXHJcblx0XHRkZXQgPSB1MSAqIHYyIC0gdTIgKiB2MTtcclxuXHJcblx0XHRpZiAoIGRldCA9PT0gMCApIHJldHVybjtcclxuXHJcblx0XHRpZGV0ID0gMSAvIGRldDtcclxuXHJcblx0XHRhID0gKCB2MiAqIHgxIC0gdjEgKiB4MiApICogaWRldDtcclxuXHRcdGIgPSAoIHYyICogeTEgLSB2MSAqIHkyICkgKiBpZGV0O1xyXG5cdFx0YyA9ICggdTEgKiB4MiAtIHUyICogeDEgKSAqIGlkZXQ7XHJcblx0XHRkID0gKCB1MSAqIHkyIC0gdTIgKiB5MSApICogaWRldDtcclxuXHJcblx0XHRlID0geDAgLSBhICogdTAgLSBjICogdjA7XHJcblx0XHRmID0geTAgLSBiICogdTAgLSBkICogdjA7XHJcblxyXG5cdFx0X2NvbnRleHQuc2F2ZSgpO1xyXG5cdFx0X2NvbnRleHQudHJhbnNmb3JtKCBhLCBiLCBjLCBkLCBlLCBmICk7XHJcblx0XHRfY29udGV4dC5maWxsKCk7XHJcblx0XHRfY29udGV4dC5yZXN0b3JlKCk7XHJcblxyXG5cdH1cclxuXHJcblx0ZnVuY3Rpb24gY2xpcEltYWdlKCB4MCwgeTAsIHgxLCB5MSwgeDIsIHkyLCB1MCwgdjAsIHUxLCB2MSwgdTIsIHYyLCBpbWFnZSApIHtcclxuXHJcblx0XHQvLyBodHRwOi8vZXh0cmVtZWx5c2F0aXNmYWN0b3J5dG90YWxpdGFyaWFuaXNtLmNvbS9ibG9nLz9wPTIxMjBcclxuXHJcblx0XHR2YXIgYSwgYiwgYywgZCwgZSwgZiwgZGV0LCBpZGV0LFxyXG5cdFx0d2lkdGggPSBpbWFnZS53aWR0aCAtIDEsXHJcblx0XHRoZWlnaHQgPSBpbWFnZS5oZWlnaHQgLSAxO1xyXG5cclxuXHRcdHUwICo9IHdpZHRoOyB2MCAqPSBoZWlnaHQ7XHJcblx0XHR1MSAqPSB3aWR0aDsgdjEgKj0gaGVpZ2h0O1xyXG5cdFx0dTIgKj0gd2lkdGg7IHYyICo9IGhlaWdodDtcclxuXHJcblx0XHR4MSAtPSB4MDsgeTEgLT0geTA7XHJcblx0XHR4MiAtPSB4MDsgeTIgLT0geTA7XHJcblxyXG5cdFx0dTEgLT0gdTA7IHYxIC09IHYwO1xyXG5cdFx0dTIgLT0gdTA7IHYyIC09IHYwO1xyXG5cclxuXHRcdGRldCA9IHUxICogdjIgLSB1MiAqIHYxO1xyXG5cclxuXHRcdGlkZXQgPSAxIC8gZGV0O1xyXG5cclxuXHRcdGEgPSAoIHYyICogeDEgLSB2MSAqIHgyICkgKiBpZGV0O1xyXG5cdFx0YiA9ICggdjIgKiB5MSAtIHYxICogeTIgKSAqIGlkZXQ7XHJcblx0XHRjID0gKCB1MSAqIHgyIC0gdTIgKiB4MSApICogaWRldDtcclxuXHRcdGQgPSAoIHUxICogeTIgLSB1MiAqIHkxICkgKiBpZGV0O1xyXG5cclxuXHRcdGUgPSB4MCAtIGEgKiB1MCAtIGMgKiB2MDtcclxuXHRcdGYgPSB5MCAtIGIgKiB1MCAtIGQgKiB2MDtcclxuXHJcblx0XHRfY29udGV4dC5zYXZlKCk7XHJcblx0XHRfY29udGV4dC50cmFuc2Zvcm0oIGEsIGIsIGMsIGQsIGUsIGYgKTtcclxuXHRcdF9jb250ZXh0LmNsaXAoKTtcclxuXHRcdF9jb250ZXh0LmRyYXdJbWFnZSggaW1hZ2UsIDAsIDAgKTtcclxuXHRcdF9jb250ZXh0LnJlc3RvcmUoKTtcclxuXHJcblx0fVxyXG5cclxuXHQvLyBIaWRlIGFudGktYWxpYXMgZ2Fwc1xyXG5cclxuXHRmdW5jdGlvbiBleHBhbmQoIHYxLCB2MiwgcGl4ZWxzICkge1xyXG5cclxuXHRcdHZhciB4ID0gdjIueCAtIHYxLngsIHkgPSB2Mi55IC0gdjEueSxcclxuXHRcdGRldCA9IHggKiB4ICsgeSAqIHksIGlkZXQ7XHJcblxyXG5cdFx0aWYgKCBkZXQgPT09IDAgKSByZXR1cm47XHJcblxyXG5cdFx0aWRldCA9IHBpeGVscyAvIE1hdGguc3FydCggZGV0ICk7XHJcblxyXG5cdFx0eCAqPSBpZGV0OyB5ICo9IGlkZXQ7XHJcblxyXG5cdFx0djIueCArPSB4OyB2Mi55ICs9IHk7XHJcblx0XHR2MS54IC09IHg7IHYxLnkgLT0geTtcclxuXHJcblx0fVxyXG5cclxuXHQvLyBDb250ZXh0IGNhY2hlZCBtZXRob2RzLlxyXG5cclxuXHRmdW5jdGlvbiBzZXRPcGFjaXR5KCB2YWx1ZSApIHtcclxuXHJcblx0XHRpZiAoIF9jb250ZXh0R2xvYmFsQWxwaGEgIT09IHZhbHVlICkge1xyXG5cclxuXHRcdFx0X2NvbnRleHQuZ2xvYmFsQWxwaGEgPSB2YWx1ZTtcclxuXHRcdFx0X2NvbnRleHRHbG9iYWxBbHBoYSA9IHZhbHVlO1xyXG5cclxuXHRcdH1cclxuXHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBzZXRCbGVuZGluZyggdmFsdWUgKSB7XHJcblxyXG5cdFx0aWYgKCBfY29udGV4dEdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiAhPT0gdmFsdWUgKSB7XHJcblxyXG5cdFx0XHRpZiAoIHZhbHVlID09PSBUSFJFRS5Ob3JtYWxCbGVuZGluZyApIHtcclxuXHJcblx0XHRcdFx0X2NvbnRleHQuZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gJ3NvdXJjZS1vdmVyJztcclxuXHJcblx0XHRcdH0gZWxzZSBpZiAoIHZhbHVlID09PSBUSFJFRS5BZGRpdGl2ZUJsZW5kaW5nICkge1xyXG5cclxuXHRcdFx0XHRfY29udGV4dC5nbG9iYWxDb21wb3NpdGVPcGVyYXRpb24gPSAnbGlnaHRlcic7XHJcblxyXG5cdFx0XHR9IGVsc2UgaWYgKCB2YWx1ZSA9PT0gVEhSRUUuU3VidHJhY3RpdmVCbGVuZGluZyApIHtcclxuXHJcblx0XHRcdFx0X2NvbnRleHQuZ2xvYmFsQ29tcG9zaXRlT3BlcmF0aW9uID0gJ2Rhcmtlcic7XHJcblxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHRfY29udGV4dEdsb2JhbENvbXBvc2l0ZU9wZXJhdGlvbiA9IHZhbHVlO1xyXG5cclxuXHRcdH1cclxuXHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBzZXRMaW5lV2lkdGgoIHZhbHVlICkge1xyXG5cclxuXHRcdGlmICggX2NvbnRleHRMaW5lV2lkdGggIT09IHZhbHVlICkge1xyXG5cclxuXHRcdFx0X2NvbnRleHQubGluZVdpZHRoID0gdmFsdWU7XHJcblx0XHRcdF9jb250ZXh0TGluZVdpZHRoID0gdmFsdWU7XHJcblxyXG5cdFx0fVxyXG5cclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHNldExpbmVDYXAoIHZhbHVlICkge1xyXG5cclxuXHRcdC8vIFwiYnV0dFwiLCBcInJvdW5kXCIsIFwic3F1YXJlXCJcclxuXHJcblx0XHRpZiAoIF9jb250ZXh0TGluZUNhcCAhPT0gdmFsdWUgKSB7XHJcblxyXG5cdFx0XHRfY29udGV4dC5saW5lQ2FwID0gdmFsdWU7XHJcblx0XHRcdF9jb250ZXh0TGluZUNhcCA9IHZhbHVlO1xyXG5cclxuXHRcdH1cclxuXHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBzZXRMaW5lSm9pbiggdmFsdWUgKSB7XHJcblxyXG5cdFx0Ly8gXCJyb3VuZFwiLCBcImJldmVsXCIsIFwibWl0ZXJcIlxyXG5cclxuXHRcdGlmICggX2NvbnRleHRMaW5lSm9pbiAhPT0gdmFsdWUgKSB7XHJcblxyXG5cdFx0XHRfY29udGV4dC5saW5lSm9pbiA9IHZhbHVlO1xyXG5cdFx0XHRfY29udGV4dExpbmVKb2luID0gdmFsdWU7XHJcblxyXG5cdFx0fVxyXG5cclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHNldFN0cm9rZVN0eWxlKCB2YWx1ZSApIHtcclxuXHJcblx0XHRpZiAoIF9jb250ZXh0U3Ryb2tlU3R5bGUgIT09IHZhbHVlICkge1xyXG5cclxuXHRcdFx0X2NvbnRleHQuc3Ryb2tlU3R5bGUgPSB2YWx1ZTtcclxuXHRcdFx0X2NvbnRleHRTdHJva2VTdHlsZSA9IHZhbHVlO1xyXG5cclxuXHRcdH1cclxuXHJcblx0fVxyXG5cclxuXHRmdW5jdGlvbiBzZXRGaWxsU3R5bGUoIHZhbHVlICkge1xyXG5cclxuXHRcdGlmICggX2NvbnRleHRGaWxsU3R5bGUgIT09IHZhbHVlICkge1xyXG5cclxuXHRcdFx0X2NvbnRleHQuZmlsbFN0eWxlID0gdmFsdWU7XHJcblx0XHRcdF9jb250ZXh0RmlsbFN0eWxlID0gdmFsdWU7XHJcblxyXG5cdFx0fVxyXG5cclxuXHR9XHJcblxyXG5cdGZ1bmN0aW9uIHNldExpbmVEYXNoKCB2YWx1ZSApIHtcclxuXHJcblx0XHRpZiAoIF9jb250ZXh0TGluZURhc2gubGVuZ3RoICE9PSB2YWx1ZS5sZW5ndGggKSB7XHJcblxyXG5cdFx0XHRfY29udGV4dC5zZXRMaW5lRGFzaCggdmFsdWUgKTtcclxuXHRcdFx0X2NvbnRleHRMaW5lRGFzaCA9IHZhbHVlO1xyXG5cclxuXHRcdH1cclxuXHJcblx0fVxyXG5cclxufTtcclxuIl19